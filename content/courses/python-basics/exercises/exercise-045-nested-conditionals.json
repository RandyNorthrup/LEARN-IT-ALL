{
  "id": "exercise-045-nested-conditionals",
  "lessonId": "lesson-030-nested-conditionals",
  "title": "Loan Approval System",
  "description": "Create a loan approval system that uses nested conditionals and ternary operators to determine loan eligibility based on multiple factors.\n\nYour program should:\n1. Evaluate loan applications with nested conditions\n2. Use guard clauses to avoid deep nesting\n3. Implement ternary operators for simple conditions\n4. Calculate loan terms based on credit score and income\n\nImplement these functions:\n- `approve_loan_nested(credit_score, income, debt_ratio, employment_years)`: Nested if version\n- `approve_loan_guards(credit_score, income, debt_ratio, employment_years)`: Guard clause version\n- `calculate_interest_rate(credit_score)`: Use ternary operator\n- `get_loan_term(loan_amount, income)`: Determine loan term with conditionals\n\nExample:\n```python\nresult = approve_loan_guards(720, 60000, 0.3, 3)\n# Returns: ('approved', 'Good application')\n\nrate = calculate_interest_rate(750)\n# Returns: 3.5\n```",
  "difficulty": "intermediate",
  "points": 20,
  "language": "python",
  "starterCode": "def approve_loan_nested(credit_score, income, debt_ratio, employment_years):\n    \"\"\"Approve loan using nested conditionals (harder to read).\"\"\"\n    # TODO: Implement nested conditionals:\n    # - If credit_score >= 700:\n    #   - If income >= 50000:\n    #     - If debt_ratio < 0.4:\n    #       - If employment_years >= 2:\n    #         Return ('approved', 'Excellent application')\n    #       - Else: Return ('rejected', 'Insufficient employment history')\n    #     - Else: Return ('rejected', 'Debt ratio too high')\n    #   - Else: Return ('rejected', 'Income too low')\n    # - Else: Return ('rejected', 'Credit score too low')\n    \n    pass\n\ndef approve_loan_guards(credit_score, income, debt_ratio, employment_years):\n    \"\"\"Approve loan using guard clauses (easier to read).\"\"\"\n    # TODO: Implement with early returns (guard clauses):\n    # Check each condition and return rejection immediately if fails\n    # If all conditions pass, return approval\n    \n    # Guard 1: Check credit score\n    \n    # Guard 2: Check income\n    \n    # Guard 3: Check debt ratio\n    \n    # Guard 4: Check employment years\n    \n    # All checks passed\n    \n    pass\n\ndef calculate_interest_rate(credit_score):\n    \"\"\"Calculate interest rate using ternary operator.\"\"\"\n    # TODO: Use ternary operator (conditional expression):\n    # credit_score >= 750: 3.5%\n    # credit_score >= 700: 4.0%\n    # credit_score >= 650: 5.0%\n    # Otherwise: 6.5%\n    # Format: value_if_true if condition else value_if_false\n    \n    pass\n\ndef get_loan_term(loan_amount, income):\n    \"\"\"Determine maximum loan term in years.\"\"\"\n    # TODO: Calculate loan-to-income ratio\n    ratio = loan_amount / income\n    \n    # TODO: Return term based on ratio:\n    # ratio <= 2: 15 years\n    # ratio <= 3: 20 years\n    # ratio <= 4: 25 years\n    # Otherwise: 30 years\n    \n    pass\n\ndef classify_application(credit_score, income):\n    \"\"\"Classify application using ternary operators.\"\"\"\n    # TODO: Use nested ternary operators:\n    # credit_score >= 750 and income >= 100000: 'premium'\n    # credit_score >= 700 and income >= 60000: 'standard'\n    # Otherwise: 'review required'\n    \n    pass\n\n# Test the functions\nprint(\"Loan Approval - Nested Conditionals:\")\nprint(\"=\"*60)\napplication1 = (720, 60000, 0.3, 3)\nresult = approve_loan_nested(*application1)\nprint(f\"Credit: {application1[0]}, Income: {application1[1]}, Debt: {application1[2]}, Years: {application1[3]}\")\nprint(f\"Result: {result}\\n\")\n\napplication2 = (680, 60000, 0.3, 3)\nresult = approve_loan_nested(*application2)\nprint(f\"Credit: {application2[0]}, Income: {application2[1]}, Debt: {application2[2]}, Years: {application2[3]}\")\nprint(f\"Result: {result}\\n\")\n\nprint(\"=\"*60)\nprint(\"Loan Approval - Guard Clauses:\")\nprint(\"=\"*60)\nresult = approve_loan_guards(*application1)\nprint(f\"Application 1: {result}\")\n\nresult = approve_loan_guards(*application2)\nprint(f\"Application 2: {result}\\n\")\n\nprint(\"=\"*60)\nprint(\"Interest Rate Calculation:\")\nprint(\"=\"*60)\ntest_scores = [780, 720, 680, 620]\nfor score in test_scores:\n    rate = calculate_interest_rate(score)\n    print(f\"Credit Score {score}: {rate}% interest rate\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Loan Term Calculation:\")\nprint(\"=\"*60)\ntest_loans = [\n    (100000, 80000),   # Ratio: 1.25\n    (150000, 60000),   # Ratio: 2.5\n    (200000, 60000),   # Ratio: 3.33\n    (300000, 60000),   # Ratio: 5.0\n]\n\nfor loan, income in test_loans:\n    term = get_loan_term(loan, income)\n    ratio = loan / income\n    print(f\"Loan: ${loan:,}, Income: ${income:,} (ratio: {ratio:.2f}) → {term} years\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Application Classification:\")\nprint(\"=\"*60)\ntest_apps = [\n    (780, 120000),\n    (720, 70000),\n    (650, 45000),\n]\n\nfor score, income in test_apps:\n    classification = classify_application(score, income)\n    print(f\"Credit: {score}, Income: ${income:,} → {classification}\")",
  "solution": "def approve_loan_nested(credit_score, income, debt_ratio, employment_years):\n    \"\"\"Approve loan using nested conditionals (harder to read).\"\"\"\n    if credit_score >= 700:\n        if income >= 50000:\n            if debt_ratio < 0.4:\n                if employment_years >= 2:\n                    return ('approved', 'Excellent application')\n                else:\n                    return ('rejected', 'Insufficient employment history')\n            else:\n                return ('rejected', 'Debt ratio too high')\n        else:\n            return ('rejected', 'Income too low')\n    else:\n        return ('rejected', 'Credit score too low')\n\ndef approve_loan_guards(credit_score, income, debt_ratio, employment_years):\n    \"\"\"Approve loan using guard clauses (easier to read).\"\"\"\n    if credit_score < 700:\n        return ('rejected', 'Credit score too low')\n    \n    if income < 50000:\n        return ('rejected', 'Income too low')\n    \n    if debt_ratio >= 0.4:\n        return ('rejected', 'Debt ratio too high')\n    \n    if employment_years < 2:\n        return ('rejected', 'Insufficient employment history')\n    \n    return ('approved', 'Excellent application')\n\ndef calculate_interest_rate(credit_score):\n    \"\"\"Calculate interest rate using ternary operator.\"\"\"\n    return 3.5 if credit_score >= 750 else 4.0 if credit_score >= 700 else 5.0 if credit_score >= 650 else 6.5\n\ndef get_loan_term(loan_amount, income):\n    \"\"\"Determine maximum loan term in years.\"\"\"\n    ratio = loan_amount / income\n    \n    if ratio <= 2:\n        return 15\n    elif ratio <= 3:\n        return 20\n    elif ratio <= 4:\n        return 25\n    else:\n        return 30\n\ndef classify_application(credit_score, income):\n    \"\"\"Classify application using ternary operators.\"\"\"\n    return 'premium' if (credit_score >= 750 and income >= 100000) else 'standard' if (credit_score >= 700 and income >= 60000) else 'review required'\n\n# Test the functions\nprint(\"Loan Approval - Nested Conditionals:\")\nprint(\"=\"*60)\napplication1 = (720, 60000, 0.3, 3)\nresult = approve_loan_nested(*application1)\nprint(f\"Credit: {application1[0]}, Income: {application1[1]}, Debt: {application1[2]}, Years: {application1[3]}\")\nprint(f\"Result: {result}\\n\")\n\napplication2 = (680, 60000, 0.3, 3)\nresult = approve_loan_nested(*application2)\nprint(f\"Credit: {application2[0]}, Income: {application2[1]}, Debt: {application2[2]}, Years: {application2[3]}\")\nprint(f\"Result: {result}\\n\")\n\nprint(\"=\"*60)\nprint(\"Loan Approval - Guard Clauses:\")\nprint(\"=\"*60)\nresult = approve_loan_guards(*application1)\nprint(f\"Application 1: {result}\")\n\nresult = approve_loan_guards(*application2)\nprint(f\"Application 2: {result}\\n\")\n\nprint(\"=\"*60)\nprint(\"Interest Rate Calculation:\")\nprint(\"=\"*60)\ntest_scores = [780, 720, 680, 620]\nfor score in test_scores:\n    rate = calculate_interest_rate(score)\n    print(f\"Credit Score {score}: {rate}% interest rate\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Loan Term Calculation:\")\nprint(\"=\"*60)\ntest_loans = [\n    (100000, 80000),\n    (150000, 60000),\n    (200000, 60000),\n    (300000, 60000),\n]\n\nfor loan, income in test_loans:\n    term = get_loan_term(loan, income)\n    ratio = loan / income\n    print(f\"Loan: ${loan:,}, Income: ${income:,} (ratio: {ratio:.2f}) → {term} years\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Application Classification:\")\nprint(\"=\"*60)\ntest_apps = [\n    (780, 120000),\n    (720, 70000),\n    (650, 45000),\n]\n\nfor score, income in test_apps:\n    classification = classify_application(score, income)\n    print(f\"Credit: {score}, Income: ${income:,} → {classification}\")",
  "hints": [
    "For nested conditionals, each if statement is inside the previous one's if block",
    "Guard clauses check for failure conditions first and return early: if condition_fails: return error",
    "Ternary operator syntax: value_if_true if condition else value_if_false",
    "Chain ternary operators: val1 if cond1 else val2 if cond2 else val3",
    "Guard clauses make code more readable by reducing nesting depth",
    "Both nested and guard versions produce the same result, but guards are cleaner"
  ],
  "testCases": [
    {
      "id": "tc1",
      "description": "Nested version approves good application",
      "input": "approve_loan_nested(720, 60000, 0.3, 3)",
      "expectedOutput": "('approved', 'Excellent application')",
      "isHidden": false
    },
    {
      "id": "tc2",
      "description": "Guard version rejects low credit score",
      "input": "approve_loan_guards(680, 60000, 0.3, 3)",
      "expectedOutput": "('rejected', 'Credit score too low')",
      "isHidden": false
    },
    {
      "id": "tc3",
      "description": "Interest rate for excellent credit",
      "input": "calculate_interest_rate(780)",
      "expectedOutput": "3.5",
      "isHidden": false
    },
    {
      "id": "tc4",
      "description": "Loan term for low ratio",
      "input": "get_loan_term(100000, 80000)",
      "expectedOutput": "15",
      "isHidden": true
    },
    {
      "id": "tc5",
      "description": "Premium classification for high scores",
      "input": "classify_application(780, 120000)",
      "expectedOutput": "'premium'",
      "isHidden": true
    },
    {
      "id": "tc6",
      "description": "Both versions produce same result",
      "input": "approve_loan_nested(720, 60000, 0.3, 3) == approve_loan_guards(720, 60000, 0.3, 3)",
      "expectedOutput": "True",
      "isHidden": true
    }
  ]
}