{
  "id": "exercise-107-dict-set-comprehensions",
  "lessonId": "lesson-097-dict-set-comprehensions",
  "title": "Advanced Comprehensions Lab",
  "description": "Master dictionary and set comprehensions for efficient data structures. Build complex data transformations in single expressions.\n\nYour program should:\n1. Create dictionaries with comprehensions\n2. Build sets using comprehensions\n3. Transform existing dictionaries\n4. Remove duplicates with set comprehensions\n5. Apply filters to dict/set comprehensions\n\nImplement these functions:\n- `create_square_dict(n)`: {1: 1, 2: 4, 3: 9, ..., n: n²}\n- `invert_dict(d)`: Swap keys and values\n- `unique_lengths(words)`: Set of word lengths\n- `filter_dict_by_value(d, threshold)`: Keep values > threshold\n- `char_positions(text)`: {char: [positions]}\n- `common_elements(list1, list2)`: Set of shared elements\n\nExample:\n```python\ncreate_square_dict(3)  # {1: 1, 2: 4, 3: 9}\n```",
  "difficulty": "intermediate",
  "points": 20,
  "language": "python",
  "starterCode": "def create_square_dict(n):\n    \"\"\"Create dictionary {1: 1, 2: 4, ..., n: n²}.\"\"\"\n    # TODO: Dict comprehension\n    # Return {i: i ** 2 for i in range(1, n + 1)}\n    \n    pass\n\ndef invert_dict(d):\n    \"\"\"Swap keys and values.\"\"\"\n    # TODO: Dict comprehension to invert\n    # Return {value: key for key, value in d.items()}\n    \n    pass\n\ndef unique_lengths(words):\n    \"\"\"Return set of unique word lengths.\"\"\"\n    # TODO: Set comprehension\n    # Return {len(word) for word in words}\n    \n    pass\n\ndef filter_dict_by_value(d, threshold):\n    \"\"\"Keep only key-value pairs where value > threshold.\"\"\"\n    # TODO: Dict comprehension with condition\n    # Return {k: v for k, v in d.items() if v > threshold}\n    \n    pass\n\ndef char_positions(text):\n    \"\"\"Map each char to list of positions where it appears.\"\"\"\n    # TODO: Build dict with comprehension + enumerate\n    # positions = {}\n    # For i, char in enumerate(text):\n    #   If char not in positions:\n    #     positions[char] = []\n    #   positions[char].append(i)\n    # Return positions\n    # Or use dict comprehension with sets first, then convert\n    \n    pass\n\ndef common_elements(list1, list2):\n    \"\"\"Return set of elements present in both lists.\"\"\"\n    # TODO: Set intersection\n    # Return set(list1) & set(list2)\n    # Or: return {x for x in list1 if x in list2}\n    \n    pass\n\n# Test functions\nprint(\"Square Dictionary:\")\nprint(\"=\"*60)\nfor n in [5, 3, 10]:\n    result = create_square_dict(n)\n    print(f\"n={n}: {result}\\n\")\n\nprint(\"=\"*60)\nprint(\"Invert Dictionary:\")\nprint(\"=\"*60)\ntest_dicts = [\n    {'a': 1, 'b': 2, 'c': 3},\n    {'name': 'Alice', 'age': 25},\n    {1: 'one', 2: 'two', 3: 'three'},\n]\n\nfor d in test_dicts:\n    inverted = invert_dict(d)\n    print(f\"Original: {d}\")\n    print(f\"Inverted: {inverted}\\n\")\n\nprint(\"=\"*60)\nprint(\"Unique Lengths:\")\nprint(\"=\"*60)\nword_lists = [\n    ['a', 'ab', 'abc', 'ab', 'a'],\n    ['hello', 'world', 'hi', 'hey'],\n    ['Python', 'is', 'awesome'],\n]\n\nfor words in word_lists:\n    lengths = unique_lengths(words)\n    print(f\"Words: {words}\")\n    print(f\"Unique lengths: {sorted(lengths)}\\n\")\n\nprint(\"=\"*60)\nprint(\"Filter Dictionary by Value:\")\nprint(\"=\"*60)\nscores = {'Alice': 85, 'Bob': 92, 'Charlie': 78, 'Diana': 95, 'Eve': 70}\nthresholds = [80, 90, 75]\n\nfor threshold in thresholds:\n    filtered = filter_dict_by_value(scores, threshold)\n    print(f\"Threshold: {threshold}\")\n    print(f\"Filtered: {filtered}\\n\")\n\nprint(\"=\"*60)\nprint(\"Character Positions:\")\nprint(\"=\"*60)\ntest_texts = ['hello', 'mississippi', 'aabbcc']\n\nfor text in test_texts:\n    positions = char_positions(text)\n    print(f\"Text: '{text}'\")\n    for char in sorted(positions.keys()):\n        print(f\"  '{char}': {positions[char]}\")\n    print()\n\nprint(\"=\"*60)\nprint(\"Common Elements (Set Intersection):\")\nprint(\"=\"*60)\ntest_pairs = [\n    ([1, 2, 3, 4], [3, 4, 5, 6]),\n    (['a', 'b', 'c'], ['b', 'c', 'd']),\n    ([1, 2, 3], [4, 5, 6]),\n]\n\nfor list1, list2 in test_pairs:\n    common = common_elements(list1, list2)\n    print(f\"List 1: {list1}\")\n    print(f\"List 2: {list2}\")\n    print(f\"Common: {sorted(common) if common else 'None'}\\n\")",
  "solution": "def create_square_dict(n):\n    \"\"\"Create dictionary {1: 1, 2: 4, ..., n: n²}.\"\"\"\n    return {i: i ** 2 for i in range(1, n + 1)}\n\ndef invert_dict(d):\n    \"\"\"Swap keys and values.\"\"\"\n    return {value: key for key, value in d.items()}\n\ndef unique_lengths(words):\n    \"\"\"Return set of unique word lengths.\"\"\"\n    return {len(word) for word in words}\n\ndef filter_dict_by_value(d, threshold):\n    \"\"\"Keep only key-value pairs where value > threshold.\"\"\"\n    return {k: v for k, v in d.items() if v > threshold}\n\ndef char_positions(text):\n    \"\"\"Map each char to list of positions where it appears.\"\"\"\n    positions = {}\n    for i, char in enumerate(text):\n        if char not in positions:\n            positions[char] = []\n        positions[char].append(i)\n    return positions\n\ndef common_elements(list1, list2):\n    \"\"\"Return set of elements present in both lists.\"\"\"\n    return set(list1) & set(list2)\n\n# Test code as provided",
  "hints": [
    "Dict comprehension: {key_expr: value_expr for item in iterable}",
    "Set comprehension: {expression for item in iterable}",
    "d.items() returns (key, value) tuples for iteration",
    "Set intersection with &: set1 & set2",
    "Filter dicts: {k: v for k, v in d.items() if condition}",
    "Sets automatically remove duplicates"
  ],
  "testCases": [
    {
      "id": "tc1",
      "description": "Create square dictionary",
      "input": "create_square_dict(3)",
      "expectedOutput": "{1: 1, 2: 4, 3: 9}",
      "isHidden": false
    },
    {
      "id": "tc2",
      "description": "Invert dictionary",
      "input": "invert_dict({'a': 1, 'b': 2})",
      "expectedOutput": "{1: 'a', 2: 'b'}",
      "isHidden": false
    },
    {
      "id": "tc3",
      "description": "Unique word lengths",
      "input": "unique_lengths(['a', 'ab', 'abc', 'ab'])",
      "expectedOutput": "{1, 2, 3}",
      "isHidden": false
    },
    {
      "id": "tc4",
      "description": "Filter dict by value",
      "input": "filter_dict_by_value({'a': 5, 'b': 10, 'c': 3}, 4)",
      "expectedOutput": "{'a': 5, 'b': 10}",
      "isHidden": true
    },
    {
      "id": "tc5",
      "description": "Char positions tracks all occurrences",
      "input": "'l' in char_positions('hello') and len(char_positions('hello')['l']) == 2",
      "expectedOutput": "True",
      "isHidden": true
    },
    {
      "id": "tc6",
      "description": "Common elements intersection",
      "input": "common_elements([1, 2, 3], [2, 3, 4])",
      "expectedOutput": "{2, 3}",
      "isHidden": true
    }
  ]
}