{
  "id": "exercise-149-set-performance-optimization",
  "lessonId": "lesson-139-set-performance-optimization",
  "title": "Set Performance and Optimization",
  "description": "Master set performance: O(1) operations, set vs list comparison, memory efficiency, and optimization techniques.",
  "difficulty": "advanced",
  "points": 25,
  "starterCode": "# Function 1: Fast membership testing with set\ndef filter_valid_ids(all_ids, valid_id_set):\n    \"\"\"Filter IDs using set for fast lookup.\n    \n    Args:\n        all_ids (list): List of all IDs\n        valid_id_set (set): Set of valid IDs\n    \n    Returns:\n        list: Filtered valid IDs\n    \"\"\"\n    # Your code here\n    pass\n\n# Function 2: Optimize repeated membership tests\ndef count_valid(items, valid_list):\n    \"\"\"Count valid items (optimize with set).\n    \n    Args:\n        items (list): Items to check\n        valid_list (list): Valid items list\n    \n    Returns:\n        int: Count of valid items\n    \"\"\"\n    # Your code here\n    pass\n\n# Function 3: Batch set creation\ndef create_set_batch(items):\n    \"\"\"Create set efficiently from iterable.\n    \n    Args:\n        items (iterable): Items to convert\n    \n    Returns:\n        set: Set of items\n    \"\"\"\n    # Your code here\n    pass\n\n# Function 4: Use set operations instead of loops\ndef find_common_efficient(list1, list2):\n    \"\"\"Find common elements efficiently.\n    \n    Args:\n        list1 (list): First list\n        list2 (list): Second list\n    \n    Returns:\n        set: Common elements\n    \"\"\"\n    # Your code here\n    pass\n\n# Function 5: Pre-compute set for repeated use\ndef create_validator(valid_items):\n    \"\"\"Create validator with pre-computed set.\n    \n    Args:\n        valid_items (list): Valid items\n    \n    Returns:\n        function: Validator function\n    \"\"\"\n    # Your code here\n    pass\n\n# Function 6: Optimize with set update\ndef collect_unique_bulk(items_list):\n    \"\"\"Collect unique items from multiple lists.\n    \n    Args:\n        items_list (list): List of lists\n    \n    Returns:\n        set: All unique items\n    \"\"\"\n    # Your code here\n    pass",
  "solution": "# Function 1: Fast membership testing with set\ndef filter_valid_ids(all_ids, valid_id_set):\n    \"\"\"Filter IDs using set for fast lookup.\n    \n    Args:\n        all_ids (list): List of all IDs\n        valid_id_set (set): Set of valid IDs\n    \n    Returns:\n        list: Filtered valid IDs\n    \"\"\"\n    return [id for id in all_ids if id in valid_id_set]\n\n# Function 2: Optimize repeated membership tests\ndef count_valid(items, valid_list):\n    \"\"\"Count valid items (optimize with set).\n    \n    Args:\n        items (list): Items to check\n        valid_list (list): Valid items list\n    \n    Returns:\n        int: Count of valid items\n    \"\"\"\n    valid_set = set(valid_list)  # Convert once\n    return sum(1 for item in items if item in valid_set)\n\n# Function 3: Batch set creation\ndef create_set_batch(items):\n    \"\"\"Create set efficiently from iterable.\n    \n    Args:\n        items (iterable): Items to convert\n    \n    Returns:\n        set: Set of items\n    \"\"\"\n    return set(items)  # Single operation, efficient\n\n# Function 4: Use set operations instead of loops\ndef find_common_efficient(list1, list2):\n    \"\"\"Find common elements efficiently.\n    \n    Args:\n        list1 (list): First list\n        list2 (list): Second list\n    \n    Returns:\n        set: Common elements\n    \"\"\"\n    return set(list1) & set(list2)\n\n# Function 5: Pre-compute set for repeated use\ndef create_validator(valid_items):\n    \"\"\"Create validator with pre-computed set.\n    \n    Args:\n        valid_items (list): Valid items\n    \n    Returns:\n        function: Validator function\n    \"\"\"\n    valid_set = set(valid_items)  # Pre-compute once\n    \n    def validate(item):\n        return item in valid_set  # O(1) lookup\n    \n    return validate\n\n# Function 6: Optimize with set update\ndef collect_unique_bulk(items_list):\n    \"\"\"Collect unique items from multiple lists.\n    \n    Args:\n        items_list (list): List of lists\n    \n    Returns:\n        set: All unique items\n    \"\"\"\n    result = set()\n    for items in items_list:\n        result.update(items)  # Bulk add\n    return result",
  "hints": [
    "List comprehension with 'in valid_id_set' - O(1) lookup per item",
    "Convert valid_list to set once outside loop, then use O(1) membership",
    "Use set(items) constructor for single efficient operation",
    "Convert both lists to sets, use & operator for intersection",
    "Pre-compute set once, return closure function that uses it",
    "Use result.update(items) to add multiple items efficiently in batch"
  ],
  "testCases": [
    {
      "id": "test1",
      "input": "filter_valid_ids([1, 2, 3, 4, 5], {2, 4, 6})",
      "expectedOutput": "[2, 4]",
      "isHidden": false,
      "description": "Filter valid IDs"
    },
    {
      "id": "test2",
      "input": "count_valid([1, 2, 3, 4, 5], [2, 4, 6, 8])",
      "expectedOutput": "2",
      "isHidden": false,
      "description": "Count valid"
    },
    {
      "id": "test3",
      "input": "create_set_batch([1, 2, 2, 3])",
      "expectedOutput": "{1, 2, 3}",
      "isHidden": false,
      "description": "Create set batch"
    },
    {
      "id": "test4",
      "input": "find_common_efficient([1, 2, 3], [2, 3, 4])",
      "expectedOutput": "{2, 3}",
      "isHidden": true,
      "description": "Find common efficient"
    },
    {
      "id": "test5",
      "input": "validator = create_validator([1, 2, 3]); validator(2)",
      "expectedOutput": "True",
      "isHidden": true,
      "description": "Create validator"
    },
    {
      "id": "test6",
      "input": "collect_unique_bulk([[1, 2], [2, 3], [3, 4]])",
      "expectedOutput": "{1, 2, 3, 4}",
      "isHidden": true,
      "description": "Collect unique bulk"
    }
  ],
  "language": "python"
}