{
  "id": "exercise-118-class-instance-scope",
  "lessonId": "lesson-108-class-instance-scope",
  "title": "Class Attributes vs Instance Attributes",
  "description": "Master the distinction between class and instance attributes. Understand attribute lookup order and avoid common pitfalls.\n\nYour program should:\n1. Distinguish class attributes (shared) vs instance attributes (unique)\n2. Understand attribute lookup order\n3. Avoid mutable class attribute trap\n4. Use class attributes appropriately\n5. Understand shadowing with instance attributes\n6. Know when to use each type\n\nImplement these classes:\n- `Counter`: Class attribute for total count\n- `Product`: Mix of class and instance attributes\n- `BadClass`: Demonstrate mutable class attribute trap\n- `GoodClass`: Correct pattern with instance attributes\n- `demonstrate_lookup()`: Show attribute lookup order\n- `class_vs_instance()`: Compare both types\n\nExample:\n```python\nc1 = Counter(); c2 = Counter()\nCounter.total_count  # Shared\n```",
  "difficulty": "advanced",
  "points": 25,
  "language": "python",
  "starterCode": "class Counter:\n    \"\"\"Demonstrate class attribute shared by all instances.\"\"\"\n    # TODO: Class attribute (shared)\n    # total_count = 0\n    \n    def __init__(self, name):\n        # TODO: Instance attribute (unique)\n        # self.name = name\n        # Counter.total_count += 1\n        pass\n\nclass Product:\n    \"\"\"Mix of class and instance attributes.\"\"\"\n    # TODO: Class attribute - shared default\n    # category = \"General\"\n    \n    def __init__(self, name, price):\n        # TODO: Instance attributes - unique to each\n        # self.name = name\n        # self.price = price\n        pass\n\nclass BadClass:\n    \"\"\"Demonstrate mutable class attribute trap.\"\"\"\n    # TODO: Mutable class attribute (DANGEROUS)\n    # items = []  # Shared by ALL instances!\n    \n    def add_item(self, item):\n        # TODO: Modifies shared list\n        # self.items.append(item)\n        pass\n\nclass GoodClass:\n    \"\"\"Correct pattern with instance attributes.\"\"\"\n    \n    def __init__(self):\n        # TODO: Instance attribute (each gets own list)\n        # self.items = []\n        pass\n    \n    def add_item(self, item):\n        # TODO: Modifies instance list\n        # self.items.append(item)\n        pass\n\ndef demonstrate_lookup():\n    \"\"\"Show attribute lookup order.\n    \n    Returns:\n        Dict showing lookup behavior.\n    \"\"\"\n    # TODO: Instance first, then class\n    # p1 = Product(\"Item1\", 10)\n    # p2 = Product(\"Item2\", 20)\n    # \n    # # Both use class attribute\n    # result = {'p1_category': p1.category, 'p2_category': p2.category}\n    # \n    # # Modify class attribute\n    # Product.category = \"Electronics\"\n    # result['after_class_change'] = p1.category\n    # \n    # # Create instance attribute (shadows class)\n    # p1.category = \"Food\"\n    # result['p1_after_shadow'] = p1.category\n    # result['p2_still_class'] = p2.category\n    # \n    # return result\n    pass\n\ndef class_vs_instance():\n    \"\"\"Compare class and instance attributes.\n    \n    Returns:\n        Dict explaining differences.\n    \"\"\"\n    # TODO: Explain both types\n    # return {\n    #     'class_attribute': 'Shared by all instances',\n    #     'instance_attribute': 'Unique to each instance',\n    #     'class_access': 'ClassName.attr or instance.attr',\n    #     'instance_access': 'instance.attr only',\n    #     'lookup_order': '1. Instance, 2. Class'\n    # }\n    pass\n\n# Test code\nprint(\"Class vs Instance Attributes:\")\nprint(\"=\"*60)\n\nprint(\"\\nClass Attribute (Shared):\")\nprint(\"-\"*60)\nprint(f\"Initial Counter.total_count: {Counter.total_count}\")\nc1 = Counter(\"First\")\nc2 = Counter(\"Second\")\nc3 = Counter(\"Third\")\nprint(f\"After 3 counters: {Counter.total_count}\")\nprint(f\"c1.total_count: {c1.total_count}\")\nprint(f\"c2.total_count: {c2.total_count}\")\nprint(f\"c3.total_count: {c3.total_count}\")\nprint(\"All instances see same class attribute\")\n\nprint(\"\\nInstance Attributes (Unique):\")\nprint(\"-\"*60)\nprint(f\"c1.name: {c1.name}\")\nprint(f\"c2.name: {c2.name}\")\nprint(f\"c3.name: {c3.name}\")\nprint(\"Each instance has unique name\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Attribute Lookup Order:\")\nprint(\"=\"*60)\nlookup = demonstrate_lookup()\nfor key, value in lookup.items():\n    print(f\"{key}: {value}\")\nprint(\"Lookup: 1. Instance dict, 2. Class dict\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"⚠️  MUTABLE CLASS ATTRIBUTE TRAP:\")\nprint(\"=\"*60)\nprint(\"BadClass (shared list):\")\nbad1 = BadClass()\nbad2 = BadClass()\nbad1.add_item(\"A\")\nbad2.add_item(\"B\")\nprint(f\"  bad1.items: {bad1.items}\")\nprint(f\"  bad2.items: {bad2.items}\")\nprint(\"  Both have ['A', 'B'] - SHARED LIST!\")\n\nprint(\"\\nGoodClass (instance list):\")\ngood1 = GoodClass()\ngood2 = GoodClass()\ngood1.add_item(\"A\")\ngood2.add_item(\"B\")\nprint(f\"  good1.items: {good1.items}\")\nprint(f\"  good2.items: {good2.items}\")\nprint(\"  Each has independent list - CORRECT!\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Class vs Instance Summary:\")\nprint(\"=\"*60)\ncomparison = class_vs_instance()\nfor key, value in comparison.items():\n    print(f\"{key}: {value}\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Key Concepts:\")\nprint(\"=\"*60)\nprint(\"Class Attributes:\")\nprint(\"  - Defined in class body\")\nprint(\"  - Shared by ALL instances\")\nprint(\"  - Access: ClassName.attr or instance.attr\")\nprint(\"  - Use for: Constants, defaults, counters\")\nprint(\"\\nInstance Attributes:\")\nprint(\"  - Defined in __init__ (self.attr)\")\nprint(\"  - Unique to each instance\")\nprint(\"  - Access: instance.attr only\")\nprint(\"  - Use for: Object state, unique data\")\nprint(\"\\nAttribute Lookup:\")\nprint(\"  1. Check instance.__dict__\")\nprint(\"  2. Check Class.__dict__\")\nprint(\"  3. Check parent classes\")\nprint(\"  First match wins\")\nprint(\"\\n⚠️  Mutable Class Attribute Trap:\")\nprint(\"  ❌ BAD: items = []  # Shared!\")\nprint(\"  ✅ GOOD: self.items = []  # Unique!\")\nprint(\"\\nWhen to Use:\")\nprint(\"  Class: Constants, defaults, shared state\")\nprint(\"  Instance: Object-specific data\")",
  "solution": "class Counter:\n    total_count = 0\n    \n    def __init__(self, name):\n        self.name = name\n        Counter.total_count += 1\n\nclass Product:\n    category = \"General\"\n    \n    def __init__(self, name, price):\n        self.name = name\n        self.price = price\n\nclass BadClass:\n    items = []\n    \n    def add_item(self, item):\n        self.items.append(item)\n\nclass GoodClass:\n    def __init__(self):\n        self.items = []\n    \n    def add_item(self, item):\n        self.items.append(item)\n\ndef demonstrate_lookup():\n    p1 = Product(\"Item1\", 10)\n    p2 = Product(\"Item2\", 20)\n    \n    result = {'p1_category': p1.category, 'p2_category': p2.category}\n    \n    Product.category = \"Electronics\"\n    result['after_class_change'] = p1.category\n    \n    p1.category = \"Food\"\n    result['p1_after_shadow'] = p1.category\n    result['p2_still_class'] = p2.category\n    \n    return result\n\ndef class_vs_instance():\n    return {\n        'class_attribute': 'Shared by all instances',\n        'instance_attribute': 'Unique to each instance',\n        'class_access': 'ClassName.attr or instance.attr',\n        'instance_access': 'instance.attr only',\n        'lookup_order': '1. Instance, 2. Class'\n    }\n\n# Test code as provided",
  "hints": [
    "Class attribute: Defined in class body, shared by all",
    "Instance attribute: Defined in __init__ with self.attr",
    "Lookup order: Instance dict first, then class dict",
    "Shadowing: Instance attribute hides class attribute",
    "Mutable trap: Never use mutable class attributes ([], {})",
    "Access class attribute: ClassName.attr or instance.attr"
  ],
  "testCases": [
    {
      "id": "tc1",
      "description": "Class attribute shared",
      "input": "c1 = Counter('a'); c2 = Counter('b'); c1.total_count == c2.total_count",
      "expectedOutput": "True",
      "isHidden": false
    },
    {
      "id": "tc2",
      "description": "Instance attribute unique",
      "input": "c1 = Counter('a'); c2 = Counter('b'); c1.name != c2.name",
      "expectedOutput": "True",
      "isHidden": false
    },
    {
      "id": "tc3",
      "description": "Mutable class trap",
      "input": "b1 = BadClass(); b2 = BadClass(); b1.add_item('x'); 'x' in b2.items",
      "expectedOutput": "True",
      "isHidden": false
    },
    {
      "id": "tc4",
      "description": "Good instance pattern",
      "input": "g1 = GoodClass(); g2 = GoodClass(); g1.add_item('x'); 'x' in g2.items",
      "expectedOutput": "False",
      "isHidden": true
    },
    {
      "id": "tc5",
      "description": "Attribute lookup",
      "input": "demonstrate_lookup()['p1_after_shadow']",
      "expectedOutput": "'Food'",
      "isHidden": true
    },
    {
      "id": "tc6",
      "description": "Class vs instance",
      "input": "'Shared' in class_vs_instance()['class_attribute']",
      "expectedOutput": "True",
      "isHidden": true
    }
  ]
}