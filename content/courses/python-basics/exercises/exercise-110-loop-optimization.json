{
  "id": "exercise-110-loop-optimization",
  "lessonId": "lesson-100-loop-optimization",
  "title": "Performance-Optimized Loop Patterns",
  "description": "Master loop optimization techniques for faster Python code. Learn to avoid common performance pitfalls.\n\nYour program should:\n1. Avoid repeated lookups\n2. Use local variables efficiently\n3. Minimize function calls in loops\n4. Choose optimal data structures\n5. Apply pythonic patterns\n\nImplement these functions:\n- `sum_optimized(numbers)`: Optimized summation\n- `find_duplicates_fast(items)`: Fast duplicate detection with set\n- `membership_test_optimized(search_list, target_list)`: Use set for membership\n- `avoid_repeated_append(n)`: Pre-allocate list\n- `batch_process(items, batch_size)`: Process in batches\n- `early_exit_search(data, predicate)`: Exit early when found\n\nExample:\n```python\n# Slow: repeated list.append()\n# Fast: pre-allocate or use comprehension\n```",
  "difficulty": "intermediate",
  "points": 20,
  "language": "python",
  "starterCode": "def sum_optimized(numbers):\n    \"\"\"Optimized summation avoiding repeated operations.\"\"\"\n    # TODO: Use built-in sum() or local accumulator\n    # return sum(numbers)  # Built-in is fastest\n    # OR:\n    # total = 0\n    # for num in numbers:\n    #   total += num\n    # return total\n    \n    pass\n\ndef find_duplicates_fast(items):\n    \"\"\"Find duplicates using set for O(n) time.\"\"\"\n    # TODO: Track seen items with set\n    # seen = set()\n    # duplicates = set()\n    # for item in items:\n    #   if item in seen:\n    #     duplicates.add(item)\n    #   else:\n    #     seen.add(item)\n    # return list(duplicates)\n    \n    pass\n\ndef membership_test_optimized(search_list, target_list):\n    \"\"\"Count how many items from search_list are in target_list.\n    Optimized: Convert target_list to set for O(1) lookup.\"\"\"\n    # TODO: Convert to set first\n    # target_set = set(target_list)\n    # count = 0\n    # for item in search_list:\n    #   if item in target_set:  # O(1) vs O(n)\n    #     count += 1\n    # return count\n    \n    pass\n\ndef avoid_repeated_append(n):\n    \"\"\"Build list without repeated append calls.\n    Use list comprehension or pre-allocation.\"\"\"\n    # TODO: Use comprehension (fastest)\n    # return [i**2 for i in range(n)]\n    # OR pre-allocate:\n    # result = [0] * n\n    # for i in range(n):\n    #   result[i] = i**2\n    # return result\n    \n    pass\n\ndef batch_process(items, batch_size):\n    \"\"\"Process items in batches for efficiency.\n    Return list of batches.\"\"\"\n    # TODO: Slice into batches\n    # batches = []\n    # for i in range(0, len(items), batch_size):\n    #   batch = items[i:i+batch_size]\n    #   batches.append(batch)\n    # return batches\n    \n    pass\n\ndef early_exit_search(data, predicate):\n    \"\"\"Search for first item matching predicate.\n    Exit early when found (don't check all items).\"\"\"\n    # TODO: Return immediately when found\n    # for item in data:\n    #   if predicate(item):\n    #     return item\n    # return None\n    \n    pass\n\n# Test functions\nprint(\"Optimized Summation:\")\nprint(\"=\"*60)\ntest_lists = [\n    [1, 2, 3, 4, 5],\n    [10, 20, 30],\n    list(range(1, 101)),\n]\n\nfor numbers in test_lists:\n    result = sum_optimized(numbers)\n    display = numbers if len(numbers) <= 10 else f\"range(1, {len(numbers)+1})\"\n    print(f\"sum_optimized({display}): {result}\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Fast Duplicate Detection:\")\nprint(\"=\"*60)\ntest_lists = [\n    [1, 2, 3, 2, 4, 3],\n    ['a', 'b', 'c', 'a'],\n    [1, 1, 1, 2, 2, 3],\n]\n\nfor items in test_lists:\n    duplicates = find_duplicates_fast(items)\n    print(f\"Duplicates in {items}: {sorted(duplicates)}\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Optimized Membership Testing:\")\nprint(\"=\"*60)\nsearch = [1, 2, 3, 10, 11]\ntarget = list(range(1, 100))\ncount = membership_test_optimized(search, target)\nprint(f\"Items from {search} found in range(1,100): {count}\")\n\nsearch = ['apple', 'banana', 'cherry', 'date']\ntarget = ['apple', 'cherry', 'elderberry']\ncount = membership_test_optimized(search, target)\nprint(f\"Fruits in target list: {count}\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Avoid Repeated Append:\")\nprint(\"=\"*60)\nfor n in [5, 10, 3]:\n    result = avoid_repeated_append(n)\n    print(f\"Squares of first {n} numbers: {result}\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Batch Processing:\")\nprint(\"=\"*60)\nitems = list(range(1, 11))\nbatch_size = 3\nbatches = batch_process(items, batch_size)\nprint(f\"Items: {items}\")\nprint(f\"Batch size: {batch_size}\")\nprint(f\"Batches: {batches}\")\n\nletters = list('abcdefghij')\nbatch_size = 4\nbatches = batch_process(letters, batch_size)\nprint(f\"\\nLetters: {letters}\")\nprint(f\"Batch size: {batch_size}\")\nprint(f\"Batches: {batches}\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Early Exit Search:\")\nprint(\"=\"*60)\nnumbers = [1, 3, 5, 10, 7, 15, 20]\nresult = early_exit_search(numbers, lambda x: x > 10)\nprint(f\"First number > 10 in {numbers}: {result}\")\n\nwords = ['apple', 'banana', 'cherry', 'date']\nresult = early_exit_search(words, lambda w: len(w) > 6)\nprint(f\"First word longer than 6 chars: {result}\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Performance Tips:\")\nprint(\"=\"*60)\nprint(\"1. Use built-in functions (sum, min, max) - they're optimized\")\nprint(\"2. Convert to set for membership tests: O(1) vs O(n)\")\nprint(\"3. Use list comprehensions over repeated append()\")\nprint(\"4. Exit loops early when result is found\")\nprint(\"5. Minimize function calls inside loops\")\nprint(\"6. Pre-allocate lists when size is known\")",
  "solution": "def sum_optimized(numbers):\n    \"\"\"Optimized summation avoiding repeated operations.\"\"\"\n    return sum(numbers)\n\ndef find_duplicates_fast(items):\n    \"\"\"Find duplicates using set for O(n) time.\"\"\"\n    seen = set()\n    duplicates = set()\n    for item in items:\n        if item in seen:\n            duplicates.add(item)\n        else:\n            seen.add(item)\n    return list(duplicates)\n\ndef membership_test_optimized(search_list, target_list):\n    \"\"\"Count how many items from search_list are in target_list.\n    Optimized: Convert target_list to set for O(1) lookup.\"\"\"\n    target_set = set(target_list)\n    count = 0\n    for item in search_list:\n        if item in target_set:\n            count += 1\n    return count\n\ndef avoid_repeated_append(n):\n    \"\"\"Build list without repeated append calls.\n    Use list comprehension or pre-allocation.\"\"\"\n    return [i**2 for i in range(n)]\n\ndef batch_process(items, batch_size):\n    \"\"\"Process items in batches for efficiency.\n    Return list of batches.\"\"\"\n    batches = []\n    for i in range(0, len(items), batch_size):\n        batch = items[i:i+batch_size]\n        batches.append(batch)\n    return batches\n\ndef early_exit_search(data, predicate):\n    \"\"\"Search for first item matching predicate.\n    Exit early when found (don't check all items).\"\"\"\n    for item in data:\n        if predicate(item):\n            return item\n    return None\n\n# Test code as provided",
  "hints": [
    "Use built-in functions like sum() - they're C-optimized",
    "Convert lists to sets for O(1) membership testing",
    "List comprehensions faster than repeated append",
    "Exit loops early with return or break when found",
    "Avoid function calls inside tight loops",
    "Pre-allocate lists: [0] * n when size known"
  ],
  "testCases": [
    {
      "id": "tc1",
      "description": "Optimized sum",
      "input": "sum_optimized([1, 2, 3, 4, 5])",
      "expectedOutput": "15",
      "isHidden": false
    },
    {
      "id": "tc2",
      "description": "Fast duplicate detection",
      "input": "sorted(find_duplicates_fast([1, 2, 3, 2, 4, 3]))",
      "expectedOutput": "[2, 3]",
      "isHidden": false
    },
    {
      "id": "tc3",
      "description": "Optimized membership test",
      "input": "membership_test_optimized([1, 5, 10], [1, 2, 3, 4, 5])",
      "expectedOutput": "2",
      "isHidden": false
    },
    {
      "id": "tc4",
      "description": "Avoid repeated append",
      "input": "avoid_repeated_append(5)",
      "expectedOutput": "[0, 1, 4, 9, 16]",
      "isHidden": true
    },
    {
      "id": "tc5",
      "description": "Batch processing",
      "input": "batch_process([1,2,3,4,5], 2)",
      "expectedOutput": "[[1, 2], [3, 4], [5]]",
      "isHidden": true
    },
    {
      "id": "tc6",
      "description": "Early exit search",
      "input": "early_exit_search([1, 3, 5, 10], lambda x: x > 5)",
      "expectedOutput": "10",
      "isHidden": true
    }
  ]
}