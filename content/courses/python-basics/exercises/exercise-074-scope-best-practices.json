{
  "id": "exercise-074-scope-best-practices",
  "lessonId": "lesson-060-scope-best-practices",
  "title": "Scope Management Best Practices",
  "description": "Learn professional scope management practices. Write clean, maintainable code with proper scope usage.\n\nYour program should:\n1. Minimize global variable usage\n2. Use function parameters instead of globals\n3. Avoid shadowing built-in names\n4. Encapsulate state in classes or closures\n5. Make global dependencies explicit\n6. Follow scope best practices\n\nImplement these functions:\n- `bad_global_usage()`: Demonstrate poor global usage (for learning)\n- `good_parameter_usage(config)`: Use parameters instead\n- `avoid_builtin_shadow()`: Don't shadow built-ins\n- `encapsulate_state()`: Use closure instead of global\n- `explicit_dependencies(base_url, endpoint)`: Clear parameters\n- `constants_are_ok()`: Show acceptable global constants\n\nExample:\n```python\ngood_parameter_usage({'url': 'api.com'})  # Clear dependency\n```",
  "difficulty": "intermediate",
  "points": 20,
  "language": "python",
  "starterCode": "# Global constant (acceptable)\nMAX_RETRIES = 3\nAPI_VERSION = \"v2\"\n\n# Global variable (to be avoided in good_* functions)\ncounter = 0\n\ndef bad_global_usage():\n    \"\"\"Demonstrate poor global usage (anti-pattern).\n    \n    Returns:\n        Modified counter value.\n    \"\"\"\n    # TODO: Show why globals are problematic\n    # global counter\n    # counter += 1\n    # return counter\n    # Note: Hard to test, hidden dependency\n    \n    pass\n\ndef good_parameter_usage(value, increment=1):\n    \"\"\"Use parameters instead of globals (best practice).\n    \n    Args:\n        value: Current value.\n        increment: Amount to add.\n    \n    Returns:\n        New value.\n    \"\"\"\n    # TODO: No global, clear dependencies\n    # return value + increment\n    \n    pass\n\ndef avoid_builtin_shadow():\n    \"\"\"Avoid shadowing built-in names.\n    \n    Returns:\n        Dictionary with results.\n    \"\"\"\n    # TODO: Use descriptive names, not 'list', 'dict', 'max'\n    # items = [1, 2, 3, 4, 5]  # Good: 'items' not 'list'\n    # data_dict = {'a': 1}     # Good: 'data_dict' not 'dict'\n    # maximum = max(items)      # Good: can still use max()\n    # return {'items': items, 'max': maximum}\n    \n    pass\n\ndef encapsulate_state():\n    \"\"\"Encapsulate state in closure instead of global.\n    \n    Returns:\n        Dict with increment/get functions.\n    \"\"\"\n    # TODO: Use closure to hide state\n    # count = 0\n    # \n    # def increment():\n    #     nonlocal count\n    #     count += 1\n    #     return count\n    # \n    # def get():\n    #     return count\n    # \n    # return {'increment': increment, 'get': get}\n    \n    pass\n\ndef explicit_dependencies(base_url, endpoint, timeout=30):\n    \"\"\"Make dependencies explicit via parameters.\n    \n    Args:\n        base_url: API base URL.\n        endpoint: API endpoint.\n        timeout: Request timeout.\n    \n    Returns:\n        Full URL string.\n    \"\"\"\n    # TODO: All inputs as parameters (no hidden globals)\n    # return f\"{base_url}/{endpoint}?timeout={timeout}\"\n    \n    pass\n\ndef constants_are_ok():\n    \"\"\"Using global constants is acceptable.\n    \n    Returns:\n        String using global constants.\n    \"\"\"\n    # TODO: Reading constants is fine\n    # return f\"API {API_VERSION}, max retries: {MAX_RETRIES}\"\n    \n    pass\n\n# Test functions\nprint(\"Scope Best Practices:\")\nprint(\"=\"*60)\n\nprint(\"\\n❌ BAD: Global Variable Usage\")\nprint(\"-\"*60)\nprint(f\"Initial counter: {counter}\")\nprint(f\"bad_global_usage(): {bad_global_usage()}\")\nprint(f\"bad_global_usage(): {bad_global_usage()}\")\nprint(f\"Counter now: {counter}\")\nprint(\"Problems: Hidden dependency, hard to test, side effects\")\n\nprint(\"\\n✅ GOOD: Parameter Usage\")\nprint(\"-\"*60)\nvalue = 0\nvalue = good_parameter_usage(value, 1)\nprint(f\"good_parameter_usage(0, 1): {value}\")\nvalue = good_parameter_usage(value, 1)\nprint(f\"good_parameter_usage({value-1}, 1): {value}\")\nprint(\"Benefits: Explicit, testable, no side effects\")\n\nprint(\"\\n✅ GOOD: Avoid Shadowing Built-ins\")\nprint(\"-\"*60)\nresult = avoid_builtin_shadow()\nprint(f\"Used 'items' not 'list': {result['items']}\")\nprint(f\"Used 'maximum' for result: {result['max']}\")\nprint(\"Built-in max() still available: max([1,2,3]) =\", max([1,2,3]))\nprint(\"Don't use: list, dict, str, int, max, min, sum, len, etc.\")\n\nprint(\"\\n✅ GOOD: Encapsulated State\")\nprint(\"-\"*60)\nstate = encapsulate_state()\nprint(\"state = encapsulate_state()\")\nprint(f\"  increment(): {state['increment']()}\")\nprint(f\"  increment(): {state['increment']()}\")\nprint(f\"  get(): {state['get']()}\")\nprint(\"State hidden in closure (data privacy)\")\n\nstate2 = encapsulate_state()\nprint(\"\\nstate2 = encapsulate_state()\")\nprint(f\"  increment(): {state2['increment']()}\")\nprint(\"Independent instances (no shared global)\")\n\nprint(\"\\n✅ GOOD: Explicit Dependencies\")\nprint(\"-\"*60)\nurl = explicit_dependencies(\"https://api.example.com\", \"users\", 60)\nprint(f\"explicit_dependencies(...): {url}\")\nprint(\"All inputs visible in function signature\")\nprint(\"Easy to test: pass different arguments\")\n\nprint(\"\\n✅ GOOD: Constants as Globals\")\nprint(\"-\"*60)\nprint(f\"constants_are_ok(): {constants_are_ok()}\")\nprint(\"Reading constants is acceptable:\")\nprint(f\"  MAX_RETRIES = {MAX_RETRIES}\")\nprint(f\"  API_VERSION = {API_VERSION}\")\nprint(\"Constants: UPPERCASE_NAMES, immutable values\")\n\nprint(\"\\n\" + \"=\"*60)\nprint(\"Best Practices Summary:\")\nprint(\"=\"*60)\nprint(\"1. ✅ DO: Use function parameters\")\nprint(\"2. ✅ DO: Encapsulate state (class/closure)\")\nprint(\"3. ✅ DO: Make dependencies explicit\")\nprint(\"4. ✅ DO: Use global constants (config)\")\nprint(\"5. ✅ DO: Return values, don't modify globals\")\nprint(\"6. ❌ DON'T: Modify global variables\")\nprint(\"7. ❌ DON'T: Shadow built-in names\")\nprint(\"8. ❌ DON'T: Hide dependencies\")\nprint(\"\\nBenefits:\")\nprint(\"  - Easier to test\")\nprint(\"  - Easier to understand\")\nprint(\"  - Easier to debug\")\nprint(\"  - Fewer bugs\")\nprint(\"  - Better code reuse\")",
  "solution": "# Global constant\nMAX_RETRIES = 3\nAPI_VERSION = \"v2\"\ncounter = 0\n\ndef bad_global_usage():\n    \"\"\"Demonstrate poor global usage.\"\"\"\n    global counter\n    counter += 1\n    return counter\n\ndef good_parameter_usage(value, increment=1):\n    \"\"\"Use parameters instead of globals.\"\"\"\n    return value + increment\n\ndef avoid_builtin_shadow():\n    \"\"\"Avoid shadowing built-in names.\"\"\"\n    items = [1, 2, 3, 4, 5]\n    data_dict = {'a': 1}\n    maximum = max(items)\n    return {'items': items, 'max': maximum}\n\ndef encapsulate_state():\n    \"\"\"Encapsulate state in closure.\"\"\"\n    count = 0\n    \n    def increment():\n        nonlocal count\n        count += 1\n        return count\n    \n    def get():\n        return count\n    \n    return {'increment': increment, 'get': get}\n\ndef explicit_dependencies(base_url, endpoint, timeout=30):\n    \"\"\"Make dependencies explicit via parameters.\"\"\"\n    return f\"{base_url}/{endpoint}?timeout={timeout}\"\n\ndef constants_are_ok():\n    \"\"\"Using global constants is acceptable.\"\"\"\n    return f\"API {API_VERSION}, max retries: {MAX_RETRIES}\"\n\n# Test code as provided",
  "hints": [
    "Minimize globals: Use parameters or encapsulate in class/closure",
    "Explicit parameters: All inputs visible in function signature",
    "Don't shadow built-ins: Avoid names like list, dict, max, min",
    "Constants OK: UPPERCASE immutable config values acceptable",
    "Encapsulation: Hide state in closures or classes",
    "Return values: Don't modify globals, return new values"
  ],
  "testCases": [
    {
      "id": "tc1",
      "description": "Parameter usage (no globals)",
      "input": "good_parameter_usage(10, 5)",
      "expectedOutput": "15",
      "isHidden": false
    },
    {
      "id": "tc2",
      "description": "Avoid built-in shadowing",
      "input": "avoid_builtin_shadow()['max']",
      "expectedOutput": "5",
      "isHidden": false
    },
    {
      "id": "tc3",
      "description": "Encapsulated state",
      "input": "s = encapsulate_state(); s['increment'](); s['get']()",
      "expectedOutput": "1",
      "isHidden": false
    },
    {
      "id": "tc4",
      "description": "Explicit dependencies",
      "input": "'https://api.example.com/users?timeout=60' in explicit_dependencies('https://api.example.com', 'users', 60)",
      "expectedOutput": "True",
      "isHidden": true
    },
    {
      "id": "tc5",
      "description": "Constants usage OK",
      "input": "'v2' in constants_are_ok()",
      "expectedOutput": "True",
      "isHidden": true
    },
    {
      "id": "tc6",
      "description": "Independent closures",
      "input": "s1 = encapsulate_state(); s2 = encapsulate_state(); s1['increment'](); s2['get']()",
      "expectedOutput": "0",
      "isHidden": true
    }
  ]
}