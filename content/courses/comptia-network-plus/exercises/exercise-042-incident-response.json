{
  "id": "exercise-042-incident-response",
  "lessonId": "lesson-042-incident-response",
  "title": "Incident Response and Breach Management",
  "description": "Develop effective incident response procedures. Detect security incidents, investigate root causes, contain threats, and implement recovery strategies to minimize business impact.",
  "difficulty": "advanced",
  "points": 100,
  "language": "text",
  "starterCode": "# INCIDENT RESPONSE EXERCISE\n# Detect, contain, and recover from security incidents\n\n## SCENARIO: EcommerceCorp ransomware attack (in progress)\n## - Time: 2 AM on Sunday (minimal staff)\n## - Discovery: Automated backup fails (disk encrypted)\n## - Scope: Unknown (still investigating)\n## - Business impact: Revenue-generating systems offline\n## - Stakes: Customer trust, regulatory penalties, insurance claims\n\n## PART 1: INCIDENT RESPONSE FUNDAMENTALS\n## Q1: Incident response team roles:\n##     Incident Commander (IC):\n##     - Role: _______ (overall incident coordination)\n##     - Decisions: _______ (what to do, prioritize actions)\n##     - Communication: _______ (update leadership, teams)\n##     - Accountability: Responsible for outcome\n##     \n##     Lead Investigator:\n##     - Role: _______ (forensics, root cause)\n##     - Focus: What happened? How did it start?\n##     - Preserve: Evidence (for investigation, legal)\n##     - Timeline: Reconstruct attack chain\n##     \n##     Technical Lead:\n##     - Role: _______ (execute containment, recovery)\n##     - Focus: How to stop it? How to restore?\n##     - Coordination: Work with IC on priorities\n##     - Execution: Implement decisions\n##     \n##     Communications:\n##     - Internal: Keep teams informed\n##     - External: Customer/media communications\n##     - Sensitive: What can be disclosed?\n##     - Legal: Involve counsel\n\n## Q2: Incident response phases:\n##     Detection: _______ (something is wrong)\n##     - Alert: Monitoring detects anomaly\n##     - Example: Backup fails, unusual network traffic\n##     - Response: Activate incident response team\n##     \n##     Containment (short-term): _______ (stop the spread)\n##     - Action: Isolate affected systems\n##     - Example: Disconnect ransomware server from network\n##     - Goal: Prevent further damage\n##     \n##     Investigation: _______ (what happened?)\n##     - Forensics: Examine logs, memory, files\n##     - Timeline: Reconstruct attack\n##     - Attribution: Who did it?\n##     \n##     Recovery: _______ (restore normal operations)\n##     - Restore: Systems from clean backups\n##     - Rebuild: Compromised systems from scratch\n##     - Verify: Confirm systems clean\n##     \n##     Lessons learned: _______ (prevent recurrence)\n##     - Post-mortem: What went wrong?\n##     - Improvements: Security, detection, response\n##     - Update: Incident response procedures\n\n## Q3: Types of incidents:\n##     Malware infection:\n##     - Vector: _______ (email attachment, website, USB)\n##     - Spread: Worm spreads to other systems\n##     - Containment: Isolate infected systems\n##     - Recovery: Restore from backups\n##     \n##     Ransomware attack:\n##     - Encryption: _______ (encrypts all files)\n##     - Demand: Ransom payment (Bitcoin)\n##     - Business impact: Systems unusable\n##     - Response: Do NOT pay (enables criminals)\n##     \n##     Data breach:\n##     - Exfiltration: _______ (attacker steals data)\n##     - Discovery: Monitoring reveals unauthorized access\n##     - Notification: Legal requirement to notify users\n##     - Investigation: What data stolen?\n##     \n##     Denial of Service (DoS):\n##     - Attack: _______ (flood traffic, crashes system)\n##     - Duration: Minutes to hours\n##     - Containment: Block traffic at firewall\n##     - Recovery: Restart services\n\n## PART 2: DETECTION AND INITIAL RESPONSE\n## Q4: Incident indicators (IOCs):\n##     Anomalies suggesting incident:\n##     \n##     System indicators:\n##     - CPU spike: _______ (unusual high usage)\n##     - Disk full: _______ (someone writing lots of data)\n##     - Process: Unknown process running\n##     - Network: Unusual connections\n##     \n##     Network indicators:\n##     - Traffic spike: _______ (more than normal)\n##     - Outbound: Unusual connections to internet\n##     - Port: Connections to unusual ports\n##     - Protocol: Suspicious protocol usage\n##     \n##     Application indicators:\n##     - Logs: Error messages, suspicious entries\n##     - Failed login: Many attempts (brute force?)\n##     - Modification: Files changed unexpectedly\n##     - Access: Unusual users accessing systems\n##     \n##     User behavior:\n##     - Off-hours: Activity when user usually offline\n##     - Volume: Accessing many files suddenly\n##     - Pattern: Different than user's normal behavior\n##     - Commands: Running admin commands they never use\n\n## Q5: Triage during initial response:\n##     First responder arrives at incident:\n##     \n##     Immediate assessment:\n##     - Severity: How bad is it? (critical vs minor)\n##     - Scope: How many systems affected?\n##     - Impact: Revenue loss? Data exposed?\n##     - Urgency: How fast must we respond?\n##     \n##     Initial actions:\n##     1. Notify: _______ (activate incident response team)\n##     2. Preserve: _______ (don't destroy evidence)\n##     3. Contain: _______ (isolate affected systems)\n##     4. Document: _______ (what you observe)\n##     5. Communicate: _______ (inform leadership)\n\n## Q6: Communication during incident:\n##     Incident command center:\n##     - Setup: Central war room (physical or Slack channel)\n##     - Participants: IC, investigators, technical leads\n##     - Frequency: Updates every 15-30 minutes\n##     - Format: Structured (sitrep = situation report)\n##     \n##     SITREP format:\n##     - Status: What we know, what we're doing\n##     - Timeline: What happened, when\n##     - Impact: Systems affected, customers impacted\n##     - Next steps: What's happening next\n##     - ETA: When will this be resolved?\n##     \n##     External communication:\n##     - When: After initial containment\n##     - Who: Legal and PR teams\n##     - Message: _______ (facts only, no speculation)\n##     - Frequency: As new info available\n\n## PART 3: INVESTIGATION AND FORENSICS\n## Q7: Forensic investigation:\n##     Goal: _______ (prove what happened for legal)\n##     \n##     Evidence preservation:\n##     - Volatile data: _______ (memory, network connections)\n##     - Disk: _______ (file system, deleted files)\n##     - Logs: _______ (Windows events, application logs)\n##     - Chain of custody: _______ (who touched what)\n##     \n##     Investigation steps:\n##     1. Image: _______ (create bit-for-bit copy)\n##     2. Hash: _______ (verify integrity of copy)\n##     3. Analyze: _______ (examine on copy, not original)\n##     4. Document: _______ (find evidence)\n##     5. Report: _______ (conclusions for legal)\n\n## Q8: Attack timeline reconstruction:\n##     Working backward from discovery:\n##     \n##     Discovery point: Backup fails at 2 AM\n##     - Effect: Ransomware active, files encrypted\n##     - When started: Work backward to find when\n##     - Evidence: Last good backup?\n##     \n##     Likely timeline:\n##     - T+0: Initial compromise (email with malware)\n##     - T+2 hours: Malware downloads ransomware\n##     - T+4 hours: Ransomware starts encryption\n##     - T+6 hours: Backup fails (we discover)\n##     \n##     Investigation method:\n##     - Logs: When was process first seen?\n##     - Artifacts: When were files encrypted?\n##     - Email: When was malicious email sent?\n##     - Beaconing: When did malware connect out?\n\n## Q9: Attribution (who did it?):\n##     Evidence:\n##     - Malware: What family? Known group?\n##     - Tools: What attack tools used?\n##     - Techniques: APT vs script kiddies?\n##     - Language: Comments in ransom note?\n##     - Infrastructure: Where was C&C server?\n##     \n##     Limitations:\n##     - Spoofing: Attackers hide true identity\n##     - OPSEC: Techniques similar across groups\n##     - Conclusion: \"Likely\" not \"definitely\"\n##     - Legal: Evidence needed for law enforcement\n\n## PART 4: CONTAINMENT STRATEGIES\n## Q10: Short-term vs long-term containment:\n##      Short-term (immediate):\n##      - Goal: _______ (stop current attack)\n##      - Action: Disconnect affected systems\n##      - Timeframe: Minutes\n##      - Example: Unplug ransomware-infected server\n##      - Risk: Loss of logging if not careful\n##      \n##      Long-term (hours/days):\n##      - Goal: _______ (ensure threat doesn't persist)\n##      - Action: _______ (patch, change credentials)\n##      - Timeframe: Hours to days\n##      - Example: Patch vulnerability, change all passwords\n##      - Benefit: _______ (reinfection unlikely)\n\n## Q11: Incident containment decisions:\n##      For EcommerceCorp ransomware:\n##      \n##      Option 1: Shut down entire network\n##      - Benefit: Definitely stops spread\n##      - Cost: _______ (huge - zero revenue, no orders)\n##      - Decision: Too extreme, loses business\n##      \n##      Option 2: Isolate backend servers only\n##      - Benefit: _______ (stops internal spread)\n##      - Cost: Website still up (limited impact)\n##      - Decision: Preferred (minimize business impact)\n##      \n##      Option 3: Isolate the infected system only\n##      - Benefit: _______ (minimal business impact)\n##      - Cost: Ransomware may already spread internally\n##      - Decision: Risk vs benefit trade-off\n\n## PART 5: RECOVERY PROCEDURES\n## Q12: Backup and restore strategy:\n##      Scenario: Ransomware encrypted backups too\n##      \n##      Problem: _______ (no clean backups available)\n##      \n##      Options:\n##      1. Old backup (7+ days old)\n##      - Data loss: 7 days worth\n##      - Orders lost: _______ (customers may re-order)\n##      - Impact: Acceptable vs complete loss\n##      \n##      2. Partial restore (specific systems)\n##      - Restore: Database only (most critical)\n##      - Data loss: _______ (less, but manual effort)\n##      - Impact: Gradual recovery\n##      \n##      3. Rebuild from scratch\n##      - Cost: _______ (very high)\n##      - Time: _______ (weeks)\n##      - Decision: Only if backups unusable\n\n## Q13: System rebuild:\n##      Compromised systems must be rebuilt\n##      \n##      Steps:\n##      1. Wipe: _______ (delete everything, fresh install)\n##      2. OS: _______ (install clean OS from media)\n##      3. Applications: _______ (install fresh)\n##      4. Data: _______ (restore from clean backup)\n##      5. Config: _______ (reconfigure)\n##      \n##      Pitfalls:\n##      - Reinfection: Restore from infected backup ‚Üí reinfected\n##      - Backdoors: Attacker left backdoor, comes back\n##      - Verification: How to know system is clean?\n\n## Q14: Verification of cleanup:\n##      How do you know system is clean?\n##      \n##      Technical checks:\n##      - Scan: _______ (antivirus full scan, no threats)\n##      - Hashes: _______ (system files match known good)\n##      - Network: _______ (no suspicious connections)\n##      - Processes: _______ (no malicious processes)\n##      - Logs: _______ (no suspicious activities)\n##      \n##      Confidence:\n##      - High: _______ (multiple checks pass)\n##      - Medium: _______ (most checks pass)\n##      - Low: _______ (uncertain, verify manually)\n\n## PART 6: BUSINESS CONTINUITY\n## Q15: Communication strategy:\n##      Customer notification (ransomware):\n##      \n##      What to say:\n##      - Fact: \"We experienced security incident\"\n##      - Action: \"We took systems offline to contain\"\n##      - Status: \"Services will be restored by DATE\"\n##      - Assurance: \"We're investigating and improving security\"\n##      \n##      What NOT to say:\n##      - Speculation: \"We don't know how it happened\"\n##      - Blame: \"It was our vendors' fault\"\n##      - Minimize: \"Not a big deal\" (if it is)\n##      - Promises: \"This will never happen again\"\n\n## Q16: Insurance and legal:\n##      Cyber insurance policy:\n##      - Coverage: _______ (what costs paid?)\n##      - Notification: Timeline to notify insurer\n##      - Investigation: Insurer may require specific firm\n##      - Claim: Documenting costs for reimbursement\n##      \n##      Legal considerations:\n##      - Data breach notification: Required by law\n##      - Regulatory: GDPR/CCPA fines if breach\n##      - Evidence: Preserved for law enforcement\n##      - Liability: Who is liable for customer damages?\n\n## PART 7: LESSONS LEARNED\n## Q17: Post-incident review:\n##      Timeline: _______ (1-2 weeks after recovery)\n##      \n##      Questions:\n##      - Root cause: How did attacker get in?\n##      - Timeline: How long was attacker inside?\n##      - Detection: Why did alerts fail?\n##      - Response: What did we do well? Poorly?\n##      - Improvements: What should we change?\n##      \n##      Improvements identified:\n##      - Security: _______ (patch email, MFA)\n##      - Detection: _______ (better monitoring)\n##      - Response: _______ (faster incident response)\n##      - Recovery: _______ (test backups monthly)\n\n## Q18: Preventing recurrence:\n##      For ransomware vector (email attachment):\n##      \n##      Short-term:\n##      - Block: Email attachments (except allowed types)\n##      - Train: User security awareness\n##      - Monitor: Antivirus on all endpoints\n##      \n##      Long-term:\n##      - Architecture: Segmentation (lateral movement)\n##      - Backups: Offline backups (immutable)\n##      - Patch: Regular patching program\n##      - EDR: Endpoint detection and response\n\n## Q19: Testing incident response:\n##      Tabletop exercise (no systems involved):\n##      - Scenario: \"Ransomware attack discovered\"\n##      - Participants: Incident response team\n##      - Walk through: What would we do?\n##      - Problems: Identify gaps in process\n##      \n##      Red team exercise (actually simulating attack):\n##      - Attackers: Penetration testers, authorized\n##      - Goal: See if real response works\n##      - Risk: Must be done carefully\n##      - Value: Real test of procedures\n\n## Q20: Incident response documentation:\n##      What to keep:\n##      - Timeline: Detailed timeline of all events\n##      - Chat logs: All incident response communications\n##      - Evidence: Forensic evidence and findings\n##      - Decisions: Why decisions were made\n##      - Lessons: Improvements identified\n##      \n##      Why:\n##      - Legal: May be required for discovery\n##      - Compliance: Audit trail\n##      - Future: Reference for similar incidents\n##      - Improvement: Learning from experience",
  "solution": "# INCIDENT RESPONSE SOLUTION\n\n## PART 1: INCIDENT RESPONSE FUNDAMENTALS\n\n### Incident Response Team Roles\n\n**Incident Commander (IC)**:\n- Role: **OVERALL INCIDENT COORDINATION**\n- Decisions: **WHAT TO DO, PRIORITIZE ACTIONS**\n- Communication: **UPDATE LEADERSHIP, TEAMS**\n- Accountability: Responsible for outcome\n- Examples: CEO makes incident command decision (CEO = IC)\n\n**Lead Investigator**:\n- Role: **FORENSICS, ROOT CAUSE**\n- Focus: What happened? How did it start?\n- Preserve: Evidence (for investigation, legal)\n- Timeline: Reconstruct attack chain\n\n**Technical Lead**:\n- Role: **EXECUTE CONTAINMENT, RECOVERY**\n- Focus: How to stop it? How to restore?\n- Coordination: Work with IC on priorities\n- Execution: Implement decisions\n\n**Communications**:\n- Internal: Keep teams informed\n- External: Customer/media communications\n- Sensitive: What can be disclosed?\n- Legal: Involve counsel\n\n### Incident Response Phases\n\n**Detection**: **SOMETHING IS WRONG** üö®\n- Alert: Monitoring detects anomaly\n- Example: Backup fails, unusual network traffic\n- Response: Activate incident response team\n- Goal: Recognize incident exists\n\n**Containment** (short-term): **STOP THE SPREAD**\n- Action: Isolate affected systems\n- Example: Disconnect ransomware server from network\n- Goal: Prevent further damage\n- Timeline: Minutes to hours\n\n**Investigation**: **WHAT HAPPENED?**\n- Forensics: Examine logs, memory, files\n- Timeline: Reconstruct attack\n- Attribution: Who did it?\n- Goal: Understand incident completely\n\n**Recovery**: **RESTORE NORMAL OPERATIONS**\n- Restore: Systems from clean backups\n- Rebuild: Compromised systems from scratch\n- Verify: Confirm systems clean\n- Goal: Return to business as usual\n\n**Lessons Learned**: **PREVENT RECURRENCE**\n- Post-mortem: What went wrong?\n- Improvements: Security, detection, response\n- Update: Incident response procedures\n- Goal: Improve for future\n\n### Types of Incidents\n\n**Malware infection**:\n- Vector: **EMAIL ATTACHMENT, WEBSITE, USB**\n- Spread: Worm spreads to other systems\n- Containment: Isolate infected systems\n- Recovery: Restore from backups\n\n**Ransomware attack**:\n- Encryption: **ENCRYPTS ALL FILES** ‚ö†Ô∏è\n- Demand: Ransom payment (Bitcoin)\n- Business impact: Systems unusable\n- Response: Do NOT pay (enables criminals) ‚úì\n\n**Data breach**:\n- Exfiltration: **ATTACKER STEALS DATA**\n- Discovery: Monitoring reveals unauthorized access\n- Notification: Legal requirement to notify users\n- Investigation: What data stolen?\n\n**Denial of Service** (DoS):\n- Attack: **FLOOD TRAFFIC, CRASHES SYSTEM**\n- Duration: Minutes to hours\n- Containment: Block traffic at firewall\n- Recovery: Restart services\n\n## PART 2: DETECTION AND INITIAL RESPONSE\n\n### Incident Indicators (IOCs)\n\n**System indicators**:\n- CPU spike: **UNUSUAL HIGH USAGE** (malware running)\n- Disk full: **SOMEONE WRITING LOTS OF DATA** (ransomware encrypting)\n- Process: Unknown process running\n- Network: Unusual connections\n\n**Network indicators**:\n- Traffic spike: **MORE THAN NORMAL** (data exfiltration)\n- Outbound: Unusual connections to internet\n- Port: Connections to unusual ports\n- Protocol: Suspicious protocol usage\n\n**Application indicators**:\n- Logs: Error messages, suspicious entries\n- Failed login: Many attempts (brute force?)\n- Modification: Files changed unexpectedly\n- Access: Unusual users accessing systems\n\n**User behavior**:\n- Off-hours: Activity when user usually offline\n- Volume: Accessing many files suddenly\n- Pattern: Different than user's normal behavior\n- Commands: Running admin commands they never use\n\n### Triage During Initial Response\n\n**First responder arrives**:\n\n**Immediate assessment**:\n- Severity: How bad is it? (critical vs minor)\n- Scope: How many systems affected?\n- Impact: Revenue loss? Data exposed?\n- Urgency: How fast must we respond?\n\n**Initial actions**:\n1. Notify: **ACTIVATE INCIDENT RESPONSE TEAM** ‚úì\n2. Preserve: **DON'T DESTROY EVIDENCE** ‚úì\n3. Contain: **ISOLATE AFFECTED SYSTEMS** ‚úì\n4. Document: **WHAT YOU OBSERVE** ‚úì\n5. Communicate: **INFORM LEADERSHIP** ‚úì\n\n### Communication During Incident\n\n**Incident command center**:\n- Setup: Central war room (physical or Slack channel)\n- Participants: IC, investigators, technical leads\n- Frequency: Updates every 15-30 minutes\n- Format: Structured (sitrep = situation report)\n\n**SITREP format**:\n- Status: What we know, what we're doing\n- Timeline: What happened, when\n- Impact: Systems affected, customers impacted\n- Next steps: What's happening next\n- ETA: When will this be resolved?\n\n**External communication**:\n- When: After initial containment\n- Who: Legal and PR teams\n- Message: **FACTS ONLY, NO SPECULATION**\n- Frequency: As new info available\n\n## PART 3: INVESTIGATION AND FORENSICS\n\n### Forensic Investigation\n\n**Goal**: **PROVE WHAT HAPPENED FOR LEGAL**\n\n**Evidence preservation**:\n- Volatile data: **MEMORY, NETWORK CONNECTIONS** (lost on reboot)\n- Disk: **FILE SYSTEM, DELETED FILES**\n- Logs: **WINDOWS EVENTS, APPLICATION LOGS**\n- Chain of custody: **WHO TOUCHED WHAT** (legal requirement)\n\n**Investigation steps**:\n1. Image: **CREATE BIT-FOR-BIT COPY** (forensic image)\n2. Hash: **VERIFY INTEGRITY OF COPY** (SHA256)\n3. Analyze: **EXAMINE ON COPY, NOT ORIGINAL** (preserve evidence)\n4. Document: **FIND EVIDENCE** (timeline, artifacts)\n5. Report: **CONCLUSIONS FOR LEGAL**\n\n### Attack Timeline Reconstruction\n\n**Working backward from discovery**:\n\n**Discovery point**: Backup fails at 2 AM\n- Effect: Ransomware active, files encrypted\n- When started: Work backward to find when\n- Evidence: Last good backup?\n\n**Likely timeline**:\n- **T+0**: Initial compromise (email with malware)\n- **T+2 hours**: Malware downloads ransomware\n- **T+4 hours**: Ransomware starts encryption\n- **T+6 hours**: Backup fails (we discover) üö®\n\n**Investigation method**:\n- Logs: When was process first seen?\n- Artifacts: When were files encrypted?\n- Email: When was malicious email sent?\n- Beaconing: When did malware connect out?\n\n### Attribution (Who Did It?)\n\n**Evidence**:\n- Malware: What family? Known group?\n- Tools: What attack tools used?\n- Techniques: APT vs script kiddies?\n- Language: Comments in ransom note?\n- Infrastructure: Where was C&C server?\n\n**Limitations**:\n- Spoofing: Attackers hide true identity\n- OPSEC: Techniques similar across groups\n- Conclusion: \"Likely\" not \"definitely\"\n- Legal: Evidence needed for law enforcement\n\n## PART 4: CONTAINMENT STRATEGIES\n\n### Short-Term vs Long-Term Containment\n\n**Short-term** (immediate):\n- Goal: **STOP CURRENT ATTACK**\n- Action: Disconnect affected systems\n- Timeframe: Minutes\n- Example: Unplug ransomware-infected server\n- Risk: Loss of logging if not careful\n\n**Long-term** (hours/days):\n- Goal: **ENSURE THREAT DOESN'T PERSIST**\n- Action: **PATCH, CHANGE CREDENTIALS**\n- Timeframe: Hours to days\n- Example: Patch vulnerability, change all passwords\n- Benefit: **REINFECTION UNLIKELY** ‚úì\n\n### Incident Containment Decisions\n\n**For EcommerceCorp ransomware**:\n\n**Option 1**: Shut down entire network\n- Benefit: Definitely stops spread\n- Cost: **HUGE - ZERO REVENUE, NO ORDERS** üí∞\n- Decision: Too extreme, loses business ‚úó\n\n**Option 2**: Isolate backend servers only\n- Benefit: **STOPS INTERNAL SPREAD**\n- Cost: Website still up (limited impact)\n- Decision: Preferred (minimize business impact) ‚úì\n\n**Option 3**: Isolate the infected system only\n- Benefit: **MINIMAL BUSINESS IMPACT**\n- Cost: Ransomware may already spread internally\n- Decision: Risk vs benefit trade-off\n\n## PART 5: RECOVERY PROCEDURES\n\n### Backup and Restore Strategy\n\n**Scenario**: Ransomware encrypted backups too ‚ö†Ô∏è\n\n**Problem**: **NO CLEAN BACKUPS AVAILABLE**\n\n**Options**:\n\n**1. Old backup** (7+ days old):\n- Data loss: 7 days worth\n- Orders lost: **CUSTOMERS MAY RE-ORDER**\n- Impact: Acceptable vs complete loss\n\n**2. Partial restore** (specific systems):\n- Restore: Database only (most critical)\n- Data loss: **LESS, BUT MANUAL EFFORT**\n- Impact: Gradual recovery\n\n**3. Rebuild from scratch**:\n- Cost: **VERY HIGH**\n- Time: **WEEKS**\n- Decision: Only if backups unusable\n\n### System Rebuild\n\n**Compromised systems must be rebuilt**:\n\n**Steps**:\n1. Wipe: **DELETE EVERYTHING, FRESH INSTALL**\n2. OS: **INSTALL CLEAN OS FROM MEDIA** (verified good)\n3. Applications: **INSTALL FRESH** (from original media)\n4. Data: **RESTORE FROM CLEAN BACKUP** (7+ days old if needed)\n5. Config: **RECONFIGURE** (from documentation)\n\n**Pitfalls**:\n- Reinfection: Restore from infected backup ‚Üí reinfected ‚ö†Ô∏è\n- Backdoors: Attacker left backdoor, comes back\n- Verification: How to know system is clean?\n\n### Verification of Cleanup\n\n**How do you know system is clean?**\n\n**Technical checks**:\n- Scan: **ANTIVIRUS FULL SCAN, NO THREATS**\n- Hashes: **SYSTEM FILES MATCH KNOWN GOOD**\n- Network: **NO SUSPICIOUS CONNECTIONS**\n- Processes: **NO MALICIOUS PROCESSES**\n- Logs: **NO SUSPICIOUS ACTIVITIES**\n\n**Confidence levels**:\n- High: **MULTIPLE CHECKS PASS** ‚úì\n- Medium: **MOST CHECKS PASS**\n- Low: **UNCERTAIN, VERIFY MANUALLY**\n\n## PART 6: BUSINESS CONTINUITY\n\n### Communication Strategy\n\n**Customer notification** (ransomware):\n\n**What to say**:\n- Fact: \"We experienced security incident\"\n- Action: \"We took systems offline to contain\"\n- Status: \"Services will be restored by DATE\"\n- Assurance: \"We're investigating and improving security\"\n\n**What NOT to say**:\n- Speculation: \"We don't know how it happened\" ‚ùå\n- Blame: \"It was our vendors' fault\" ‚ùå\n- Minimize: \"Not a big deal\" (if it is) ‚ùå\n- Promises: \"This will never happen again\" ‚ùå\n\n### Insurance and Legal\n\n**Cyber insurance policy**:\n- Coverage: **WHAT COSTS PAID?** (legal, recovery, etc.)\n- Notification: Timeline to notify insurer (often 24-72 hours)\n- Investigation: Insurer may require specific firm\n- Claim: Documenting costs for reimbursement\n\n**Legal considerations**:\n- Data breach notification: Required by law\n- Regulatory: GDPR/CCPA fines if breach\n- Evidence: Preserved for law enforcement\n- Liability: Who is liable for customer damages?\n\n## PART 7: LESSONS LEARNED\n\n### Post-Incident Review\n\n**Timeline**: **1-2 WEEKS AFTER RECOVERY**\n\n**Questions**:\n- Root cause: How did attacker get in?\n- Timeline: How long was attacker inside?\n- Detection: Why did alerts fail?\n- Response: What did we do well? Poorly?\n- Improvements: What should we change?\n\n**Improvements identified**:\n- Security: **PATCH EMAIL, MFA** ‚úì\n- Detection: **BETTER MONITORING** ‚úì\n- Response: **FASTER INCIDENT RESPONSE** ‚úì\n- Recovery: **TEST BACKUPS MONTHLY** ‚úì\n\n### Preventing Recurrence\n\n**For ransomware vector** (email attachment):\n\n**Short-term**:\n- Block: Email attachments (except allowed types)\n- Train: User security awareness\n- Monitor: Antivirus on all endpoints\n\n**Long-term**:\n- Architecture: Segmentation (lateral movement)\n- Backups: Offline backups (immutable) ‚úì\n- Patch: Regular patching program ‚úì\n- EDR: Endpoint detection and response ‚úì\n\n### Testing Incident Response\n\n**Tabletop exercise** (no systems involved):\n- Scenario: \"Ransomware attack discovered\"\n- Participants: Incident response team\n- Walk through: What would we do?\n- Problems: Identify gaps in process\n\n**Red team exercise** (actually simulating attack):\n- Attackers: Penetration testers, authorized\n- Goal: See if real response works\n- Risk: Must be done carefully\n- Value: Real test of procedures\n\n### Incident Response Documentation\n\n**What to keep**:\n- Timeline: Detailed timeline of all events\n- Chat logs: All incident response communications\n- Evidence: Forensic evidence and findings\n- Decisions: Why decisions were made\n- Lessons: Improvements identified\n\n**Why**:\n- Legal: May be required for discovery\n- Compliance: Audit trail\n- Future: Reference for similar incidents\n- Improvement: Learning from experience",
  "hints": [
    "Incident response phases: Detection ‚Üí Containment ‚Üí Investigation ‚Üí Recovery ‚Üí Lessons learned",
    "Incident Commander makes decisions; Lead Investigator does forensics; Technical Lead executes",
    "SITREP format: Status, Timeline, Impact, Next steps, ETA",
    "Short-term containment: stop attack; long-term: ensure no persistence",
    "Forensic investigation: image ‚Üí hash ‚Üí analyze on copy (not original)",
    "Evidence preservation: protect volatile data (memory, logs), chain of custody",
    "Ransomware: don't pay ransom; restore from clean backup; rebuild infected systems",
    "Backup strategy: offline backups prevent encryption; test monthly",
    "Communication: facts only, no speculation; involve legal early",
    "Post-incident: tabletop exercises, red team testing, regular drills"
  ],
  "testCases": [
    {"id": "tc1-phases", "description": "Response phases", "input": "Detection through lessons learned", "expected": "Five phases in order", "assert": "assert ('detect' in solution.lower() or 'contain' in solution.lower() or 'recovery' in solution.lower())"},
    {"id": "tc2-roles", "description": "Team roles", "input": "IC, investigator, technical lead", "expected": "Different responsibilities", "assert": "assert ('incident' in solution.lower() or 'commander' in solution.lower() or 'investigator' in solution.lower())"},
    {"id": "tc3-indicators", "description": "IOCs", "input": "Detection signs", "expected": "Anomalies suggesting incident", "assert": "assert ('cpu' in solution.lower() or 'traffic' in solution.lower() or 'indicator' in solution.lower())"},
    {"id": "tc4-forensics", "description": "Evidence preservation", "input": "Forensic investigation", "expected": "Image, hash, analyze on copy", "assert": "assert ('forensic' in solution.lower() or 'evidence' in solution.lower() or 'chain' in solution.lower())"},
    {"id": "tc5-containment", "description": "Containment decisions", "input": "Trade-offs", "expected": "Balance security and business impact", "assert": "assert ('contain' in solution.lower() or 'isolat' in solution.lower() or 'spread' in solution.lower())"},
    {"id": "tc6-recovery", "description": "Backup restore", "input": "System rebuild", "expected": "Clean backup, rebuild steps", "assert": "assert ('backup' in solution.lower() or 'restore' in solution.lower() or 'rebuild' in solution.lower())"},
    {"id": "tc7-verification", "description": "Cleanup verification", "input": "System clean check", "expected": "Scans, hashes, no threats", "assert": "assert ('verify' in solution.lower() or 'clean' in solution.lower() or 'scan' in solution.lower())"},
    {"id": "tc8-communication", "description": "External comms", "input": "Customer notification", "expected": "Facts, no speculation", "assert": "assert ('communicat' in solution.lower() or 'customer' in solution.lower() or 'message' in solution.lower())"},
    {"id": "tc9-lessons", "description": "Post-incident", "input": "Improvements", "expected": "Root cause, security improvements", "assert": "assert ('lesson' in solution.lower() or 'improvement' in solution.lower() or 'post' in solution.lower())"},
    {"id": "tc10-testing", "description": "Exercise types", "input": "Tabletop, red team", "expected": "Testing procedures", "assert": "assert ('tabletop' in solution.lower() or 'exercise' in solution.lower() or 'test' in solution.lower())"}
  ]
}
