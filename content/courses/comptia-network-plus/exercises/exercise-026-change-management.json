{
  "id": "exercise-026-change-management",
  "lessonId": "lesson-026-change-management",
  "title": "Change Request and Implementation Plan",
  "description": "Your company needs to upgrade the firmware on both core switches to patch a critical security vulnerability (CVE-2025-1234). The switches are in an HSRP high-availability pair, serving all VLANs for 500 users. You must create a complete change request with implementation plan, risk assessment, rollback procedures, and post-implementation verification. Any mistakes could cause a complete network outage.",
  "difficulty": "hard",
  "points": 100,
  "language": "text",
  "scenario": {
    "company": "Regional Medical Center",
    "situation": "Critical security vulnerability in core switch firmware requires immediate patching",
    "constraints": [
      "Zero-downtime requirement (healthcare facility operates 24/7)",
      "Must maintain HIPAA compliance (documented change control)",
      "CAB approval required before implementation",
      "Rollback plan mandatory for all changes"
    ],
    "infrastructure": {
      "core_switches": "Core-SW-01 (Primary) and Core-SW-02 (Secondary) in HSRP",
      "current_firmware": "IOS-XE 17.6.3",
      "target_firmware": "IOS-XE 17.9.4a",
      "users_affected": 500,
      "critical_systems": [
        "EMR system",
        "PACS imaging",
        "VoIP phones"
      ]
    }
  },
  "starterCode": "# Change Request Form - CHG0012345\n\n## 1. Change Summary\n**Change ID:** CHG0012345\n**Date Submitted:** ___\n**Submitted By:** ___ (Network Engineer)\n**Change Type:** ___ (Standard/Normal/Emergency)\n**Priority:** ___ (Low/Medium/High/Critical)\n**Risk Level:** ___ (Low/Medium/High)\n\n## 2. Change Details\n**Summary:** ___\n\n**Business Justification:**\n___\n___\n___\n\n**Impact if NOT Implemented:**\n___\n___\n\n## 3. Technical Details\n**Devices Affected:**\n- Core-SW-01: ___\n- Core-SW-02: ___\n\n**Current Configuration:**\n- Model: ___\n- Current Firmware: ___\n- Target Firmware: ___\n\n**Critical Dependencies:**\n- HSRP configuration: ___\n- VLANs affected: ___\n- Users impacted: ___\n\n## 4. Implementation Plan\n**Maintenance Window:**\n- Date: ___\n- Time: ___\n- Duration: ___ hours\n- Justification for timing: ___\n\n**Implementation Steps:**\n\n### Pre-Implementation (T-30 minutes)\n1. ___\n2. ___\n3. ___\n\n### Implementation (T-0)\n**Step 1: Verify Current State (10 minutes)**\n```\nCore-SW-01# ___\nCore-SW-01# ___\nCore-SW-01# ___\n```\n\n**Step 2: Upload Firmware to Secondary Switch (15 minutes)**\n```\nCore-SW-02# ___\nCore-SW-02# ___\nCore-SW-02# ___\n```\n\n**Step 3: Set Boot Variable and Reload Secondary (20 minutes)**\n```\nCore-SW-02# ___\nCore-SW-02# ___\nCore-SW-02# ___\n```\n\n**Step 4: Verify Secondary Switch Operation (10 minutes)**\nGO/NO-GO Decision Point:\n- [ ] ___\n- [ ] ___\n- [ ] ___\n\n**Step 5: Repeat for Primary Switch (45 minutes)**\n(Same procedure as Steps 2-4)\n\n**Step 6: Post-Implementation Verification (30 minutes)**\n- [ ] ___\n- [ ] ___\n- [ ] ___\n\n**Total Time:** ___ hours\n\n## 5. Rollback Plan\n**Rollback Procedure:**\nIf issues occur after upgrade:\n1. ___\n2. ___\n3. ___\n\n**Rollback Decision Triggers:**\n- ___\n- ___\n- ___\n\n**Estimated Rollback Time:** ___ minutes\n\n## 6. Risk Assessment\n**Risk Matrix:**\n| Risk | Likelihood | Impact | Mitigation |\n|------|------------|--------|------------|\n| Firmware boot failure | ___ | ___ | ___ |\n| Configuration loss | ___ | ___ | ___ |\n| Extended downtime | ___ | ___ | ___ |\n| HSRP failover issues | ___ | ___ | ___ |\n\n**Overall Risk Level:** ___\n**Risk Score Calculation:** Impact (_/5) × Likelihood (_/5) = ___\n\n**Expected Service Impact:**\n- Expected downtime per switch: ___\n- Worst-case scenario: ___\n\n## 7. Testing and Validation\n**Pre-Production Testing:**\n- [ ] ___\n- [ ] ___\n- [ ] ___\n\n**Post-Implementation Tests:**\n- [ ] ___\n- [ ] ___\n- [ ] ___\n\n## 8. Communication Plan\n**Stakeholders to Notify:**\n- [ ] ___ (role)\n- [ ] ___ (role)\n- [ ] ___ (role)\n\n**Notification Timeline:**\n- T-7 days: ___\n- T-3 days: ___\n- T-1 day: ___\n- T-0 (start): ___\n- T-end: ___\n\n## 9. Approvals Required\n**Change Advisory Board (CAB):**\n- [ ] Network Manager: _______________ Date: ___\n- [ ] IT Director: _______________ Date: ___\n- [ ] CISO: _______________ Date: ___\n- [ ] Clinical Operations Manager: _______________ Date: ___\n\n**Implementation Authorization:**\n- [ ] Change Manager: _______________ Date: ___",
  "solution": "# Change Request Form - CHG0012345\n\n## 1. Change Summary\n**Change ID:** CHG0012345\n**Date Submitted:** 2025-01-15\n**Submitted By:** John Smith (Senior Network Engineer)\n**Change Type:** Normal (requires CAB approval)\n**Priority:** High\n**Risk Level:** Medium\n\n## 2. Change Details\n**Summary:** Upgrade Core Switch Firmware from 17.6.3 to 17.9.4a to patch critical security vulnerability CVE-2025-1234\n\n**Business Justification:**\n- Critical security vulnerability CVE-2025-1234 allows remote code execution\n- Active exploits detected in the wild (CISA alert)\n- HIPAA compliance requires patching critical vulnerabilities within 30 days\n- Firmware 17.9.4a also includes performance improvements for 10G interfaces\n\n**Impact if NOT Implemented:**\n- Potential security breach and unauthorized access to network\n- HIPAA violation and potential fines ($100-$50,000 per violation)\n- Risk to patient data confidentiality\n- Continued spanning-tree instability issues\n\n## 3. Technical Details\n**Devices Affected:**\n- Core-SW-01: Primary core switch (HSRP Active)\n- Core-SW-02: Secondary core switch (HSRP Standby)\n\n**Current Configuration:**\n- Model: Cisco Catalyst 9500-48Y4C\n- Current Firmware: IOS-XE 17.6.3\n- Target Firmware: IOS-XE 17.9.4a\n\n**Critical Dependencies:**\n- HSRP configuration: Virtual IP 10.0.0.1 serving as default gateway for all VLANs\n- VLANs affected: VLAN 1-100 (all production VLANs)\n- Users impacted: 500 staff members + critical medical systems\n\n## 4. Implementation Plan\n**Maintenance Window:**\n- Date: Saturday, January 25, 2025\n- Time: 2:00 AM - 5:00 AM EST\n- Duration: 3 hours (estimated 2 hours actual)\n- Justification for timing: Minimal patient activity, lowest network utilization\n\n**Implementation Steps:**\n\n### Pre-Implementation (T-30 minutes)\n1. Join conference bridge (555-123-4567)\n2. Verify all personnel present (primary engineer, backup engineer, change manager)\n3. Confirm CAB approval received\n4. Verify configuration backups current (within 24 hours)\n5. Test console access and out-of-band management\n\n### Implementation (T-0)\n**Step 1: Verify Current State (10 minutes)**\n```\nCore-SW-01# show version\nCore-SW-01# show redundancy states\nCore-SW-01# show standby brief\nCore-SW-01# show spanning-tree summary\nCore-SW-01# show running-config | redirect flash:backup-pre-change.cfg\n```\n\n**Step 2: Upload Firmware to Secondary Switch (15 minutes)**\n```\nCore-SW-02# copy tftp://10.1.1.100/cat9k-universalk9.17.09.04a.SPA.bin flash:\nCore-SW-02# verify /md5 flash:cat9k-universalk9.17.09.04a.SPA.bin\n! Expected MD5: a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6\n```\n\n**Step 3: Set Boot Variable and Reload Secondary (20 minutes)**\n```\nCore-SW-02# configure terminal\nCore-SW-02(config)# boot system flash:cat9k-universalk9.17.09.04a.SPA.bin\nCore-SW-02(config)# exit\nCore-SW-02# write memory\nCore-SW-02# show boot\nCore-SW-02# reload\n! Expected boot time: 10-12 minutes\n```\n\n**Step 4: Verify Secondary Switch Operation (10 minutes)**\nGO/NO-GO Decision Point:\n- [ ] Version 17.9.4a confirmed (show version)\n- [ ] HSRP state is Standby (show standby brief)\n- [ ] All interfaces operational (show interface status)\n- [ ] CPU <50%, memory normal (show processes cpu, show memory)\n- [ ] No spanning-tree topology changes (show spanning-tree summary)\n- [ ] Connectivity test successful (ping 8.8.8.8)\n\nIf ALL checks pass: Proceed to Step 5\nIf ANY check fails: STOP - Initiate rollback on Core-SW-02\n\n**Step 5: Repeat for Primary Switch (45 minutes)**\n(Same procedure as Steps 2-4 for Core-SW-01)\n\n**Step 6: Post-Implementation Verification (30 minutes)**\n- [ ] Both switches running 17.9.4a\n- [ ] HSRP Active/Standby states correct\n- [ ] All VLANs operational (show vlan brief)\n- [ ] Trunk links up (show interfaces trunk)\n- [ ] Test connectivity from each VLAN to internet\n- [ ] No user complaints in first 30 minutes\n- [ ] Verify EMR system accessible\n- [ ] Verify PACS imaging system accessible\n- [ ] Test VoIP phone calls\n\n**Total Time:** 2 hours 10 minutes (30-minute buffer = 3-hour window)\n\n## 5. Rollback Plan\n**Rollback Procedure:**\nIf issues occur after upgrade:\n1. Access switch via console or out-of-band management\n2. Configure boot to previous firmware version:\n   ```\n   configure terminal\n   boot system flash:cat9k-universalk9.17.06.03.SPA.bin\n   exit\n   write memory\n   reload\n   ```\n3. Monitor boot process (10-12 minutes)\n4. Verify operation with same checks as Step 4\n\n**Rollback Decision Triggers:**\n- Switch fails to boot with new firmware (>15 minutes)\n- HSRP not functioning correctly\n- VLANs not routing properly\n- Spanning-tree instability\n- CPU >80% sustained\n- Any critical functionality broken\n- Unable to access EMR or PACS systems\n\n**Estimated Rollback Time:** 15 minutes per switch\n\n## 6. Risk Assessment\n**Risk Matrix:**\n| Risk | Likelihood | Impact | Mitigation |\n|------|------------|--------|------------|\n| Firmware boot failure | Low (2) | High (4) | Test on secondary first, rollback available |\n| Configuration loss | Low (1) | High (5) | Backup configs verified, stored off-device |\n| Extended downtime | Medium (3) | High (5) | Rollback plan prepared, experienced engineer |\n| HSRP failover issues | Low (2) | Medium (3) | HSRP tested in lab, <5 second failover expected |\n\n**Overall Risk Level:** Medium\n**Risk Score Calculation:** Average Impact (4.25) × Average Likelihood (2) = 8.5 (Medium: 6-12)\n\n**Expected Service Impact:**\n- Expected downtime per switch: 5-10 seconds (HSRP failover time)\n- Worst-case scenario: 30 minutes if rollback required\n\n## 7. Testing and Validation\n**Pre-Production Testing:**\n- [X] Tested firmware 17.9.4a in lab environment on identical hardware\n- [X] Reviewed Cisco release notes for known issues\n- [X] Verified compatibility with all installed modules\n- [X] Confirmed licensing compatible with new version\n- [X] Tested HSRP failover in lab (<3 seconds)\n\n**Post-Implementation Tests:**\n- [ ] Verify version on both switches (show version)\n- [ ] Test HSRP failover (shutdown active interface, verify failover)\n- [ ] Connectivity from all VLANs (ping gateway, ping internet)\n- [ ] Access critical systems (EMR, PACS, VoIP)\n- [ ] Review logs for errors (show logging | include %)\n- [ ] Monitor for 24 hours post-change\n\n## 8. Communication Plan\n**Stakeholders to Notify:**\n- [ ] IT Director (executive oversight)\n- [ ] Clinical Operations Manager (clinical impact)\n- [ ] NOC Team (monitoring during maintenance)\n- [ ] Help Desk (Saturday morning shift briefing)\n- [ ] Security Team (SIEM alert suppression)\n- [ ] Facilities (ensure datacenter access available)\n\n**Notification Timeline:**\n- T-7 days: Initial notification email to all stakeholders\n- T-3 days: Reminder with detailed timeline\n- T-1 day: Final reminder with NOC phone number for issues\n- T-0 (2:00 AM): Begin maintenance notification\n- T+2 hours (4:00 AM): Completion notification (success or status)\n- T+1 day: Post-implementation review summary\n\n## 9. Approvals Required\n**Change Advisory Board (CAB):**\n- [X] Network Manager: Sarah Johnson - Date: 2025-01-16\n- [X] IT Director: Michael Brown - Date: 2025-01-17\n- [X] CISO: Jennifer Lee - Date: 2025-01-17\n- [X] Clinical Operations Manager: Dr. Robert Chen - Date: 2025-01-18\n\n**Implementation Authorization:**\n- [X] Change Manager: David Williams - Date: 2025-01-20",
  "hints": [
    "Change type should be 'Normal' for firmware upgrades requiring CAB approval",
    "Risk level is 'Medium' - high impact but low likelihood with proper planning",
    "Always upgrade secondary (standby) switch first, verify operation, then upgrade primary",
    "HSRP provides automatic failover - expect 3-5 seconds downtime per switch reload",
    "GO/NO-GO decision point after secondary upgrade prevents cascading failures",
    "Rollback must boot from previous firmware image stored on flash",
    "Healthcare facilities require 24/7 operation - schedule during lowest activity (2-4 AM)",
    "HIPAA compliance requires documented change control and CAB approvals",
    "Risk score calculation: Impact (1-5) × Likelihood (1-5), score 1-8=Low, 9-15=Medium, 16-25=High",
    "Post-implementation verification must include testing critical systems (EMR, PACS)"
  ],
  "testCases": [
    {
      "id": "tc1-change-type",
      "description": "Change type classification",
      "input": "Change type",
      "expected": "Change type is Normal requiring CAB approval",
      "assert": "assert 'Normal' in solution"
    },
    {
      "id": "tc2-risk-assessment",
      "description": "Risk assessment with matrix",
      "input": "Risk level",
      "expected": "Risk level is Medium with documented risk matrix",
      "assert": "assert 'Medium' in solution and 'Risk Matrix' in solution"
    },
    {
      "id": "tc3-upgrade-sequence",
      "description": "Upgrade sequence",
      "input": "Implementation steps",
      "expected": "Secondary switch upgraded first, verified, then primary",
      "assert": "assert 'secondary' in solution.lower() or 'Secondary' in solution or 'Core-SW-02' in solution"
    },
    {
      "id": "tc4-go-no-go",
      "description": "GO/NO-GO decision point",
      "input": "Decision checkpoint",
      "expected": "GO/NO-GO decision point after secondary switch verification",
      "assert": "assert 'GO/NO-GO' in solution or 'go/no-go' in solution.lower()"
    },
    {
      "id": "tc5-rollback",
      "description": "Rollback procedure",
      "input": "Rollback plan",
      "expected": "Rollback procedure with boot system command and reload",
      "assert": "assert 'boot system' in solution and 'reload' in solution"
    },
    {
      "id": "tc6-maintenance-window",
      "description": "Maintenance timing",
      "input": "Schedule",
      "expected": "Maintenance window scheduled during low-activity hours",
      "assert": "assert ('2:00 AM' in solution or '2 AM' in solution or 'Saturday' in solution)"
    },
    {
      "id": "tc7-cab-approvals",
      "description": "CAB approvals",
      "input": "Approvals",
      "expected": "Multiple CAB approvals including Network Manager, IT Director, CISO",
      "assert": "assert 'Network Manager' in solution and 'IT Director' in solution and 'CISO' in solution"
    },
    {
      "id": "tc8-backups",
      "description": "Pre-implementation backups",
      "input": "Preparation",
      "expected": "Configuration backups verified before starting",
      "assert": "assert 'backup' in solution.lower()"
    },
    {
      "id": "tc9-testing",
      "description": "Post-implementation testing",
      "input": "Validation",
      "expected": "Post-implementation tests include HSRP, VLANs, critical systems",
      "assert": "assert 'HSRP' in solution or 'VLANs' in solution or 'critical' in solution.lower()"
    },
    {
      "id": "tc10-communication",
      "description": "Communication plan",
      "input": "Notifications",
      "expected": "Communication plan with T-7, T-3, T-1 day notifications",
      "assert": "assert 'T-7' in solution and 'T-3' in solution and 'T-1' in solution"
    },
    {
      "id": "tc11-hsrp",
      "description": "HSRP high availability",
      "input": "Redundancy",
      "expected": "HSRP configured for zero-downtime upgrade",
      "assert": "assert 'HSRP' in solution and ('Active' in solution or 'Standby' in solution)"
    },
    {
      "id": "tc12-filesize",
      "description": "Complete change management documentation",
      "input": "Document size",
      "expected": "Comprehensive change request exercise with 15,000+ characters",
      "assert": "assert len(solution) >= 10000"
    }
  ]
}
