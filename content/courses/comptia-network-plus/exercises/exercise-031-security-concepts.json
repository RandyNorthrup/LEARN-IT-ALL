{
  "id": "exercise-031-security-concepts",
  "lessonId": "lesson-031-security-concepts",
  "title": "CIA Triad Application and Defense in Depth Implementation",
  "description": "You are the security architect for a mid-sized financial services company that processes customer transactions and manages sensitive financial data. You must design security controls that protect confidentiality, integrity, and availability of their systems. You'll analyze threat scenarios, recommend security mechanisms for each CIA principle, design defense-in-depth strategies, and create a security policy framework.",
  "difficulty": "intermediate",
  "points": 100,
  "language": "text",
  "scenario": {
    "company": "SecureFinance Corp",
    "situation": "Financial services company with growing security concerns after competitor experienced data breach",
    "current_assets": {
      "customer_database": "50,000 customer records with financial history",
      "transaction_systems": "$10B annual transaction volume",
      "employee_count": 300,
      "remote_workers": 75,
      "branch_offices": 12,
      "internet_connectivity": "Dual ISP with redundant firewalls"
    },
    "compliance_requirements": [
      "PCI DSS (Payment Card Industry) - for credit card processing",
      "SOC 2 Type II - for service organization controls",
      "State financial regulation - customer data protection",
      "GLBA (Gramm-Leach-Bliley) - financial privacy"
    ],
    "recent_incidents": [
      "Competitor experienced customer data breach (confidentiality impact)",
      "Internal system configuration drift caused billing errors (integrity impact)",
      "DDoS attack brought down website for 2 hours (availability impact)"
    ]
  },
  "starterCode": "# CIA Triad Security Design - SecureFinance Corp\n# Comprehensive Security Architecture Assessment\n\n## ===================================================================\n## CHALLENGE 1: ANALYZE CONFIDENTIALITY THREATS AND CONTROLS\n## ===================================================================\n\n## Current Situation:\n## - 50,000 customer financial records stored in database\n## - 75 remote workers accessing systems from various locations\n## - 12 branch offices with network access\n## - Competitor recently experienced data breach\n\n## Confidentiality Threats (Identify & Prioritize):\n## Q1: List 5 specific threats to customer data confidentiality\n##     (Examples: network interception, unauthorized access, physical theft, etc.)\n##     Threat 1: _______________\n##     Threat 2: _______________\n##     Threat 3: _______________\n##     Threat 4: _______________\n##     Threat 5: _______________\n\n## Q2: Which threat is HIGHEST risk? Why?\n##     Answer: _______________\n##     Justification: _______________\n\n## Confidentiality Controls Design:\n## Q3: For customer database (at rest):\n##     - Encryption algorithm: _______________\n##     - Key management: _______________\n##     - Access control method: _______________\n##     - Who should have access? (List roles)\n\n## Q4: For remote workers (data in transit):\n##     - Encryption protocol: _______________\n##     - VPN requirements: _______________\n##     - Multi-factor authentication: Yes/No - Explain\n##     - Session timeout policy: ___ minutes\n\n## Q5: Cost-benefit analysis:\n##     - Cost of strong encryption overhead: $___\n##     - Cost of data breach (estimate): $___\n##     - ROI of implementing confidentiality controls: ___\n\n## ===================================================================\n## CHALLENGE 2: ANALYZE INTEGRITY THREATS AND CONTROLS\n## ===================================================================\n\n## Integrity Threats (Recent Issue: Configuration Drift):\n## Q6: Describe the configuration drift incident:\n##     - What changed? _______________\n##     - Who made the change? _______________\n##     - When was it discovered? _______________\n##     - Business impact: _______________\n\n## Q7: Design integrity controls to prevent similar incidents:\n##     - Version control system: _______________\n##     - Change approval process: _______________\n##     - Rollback capability: Yes/No\n##     - Audit logging: _______________\n##     - File integrity monitoring: Yes/No\n\n## Q8: Implement file integrity checking for critical configs:\n##     ```\n##     # Hash-based integrity check\n##     Initial hash of router-config.txt: ________________\n##     \n##     # After modification, verify:\n##     New hash: ________________\n##     \n##     # Do hashes match? Yes/No\n##     # If different, what changed?\n##     ```\n\n## Q9: Transaction integrity in financial system:\n##     - Digital signature on each transaction? Yes/No\n##     - Non-repudiation requirement? Yes/No\n##     - Blockchain for immutability? Pros/Cons\n\n## Q10: PCI DSS integrity requirements:\n##      - Must validate system changes how? _______________\n##      - Configuration change audit trail? _______________\n##      - Testing before production deployment? Yes/No\n\n## ===================================================================\n## CHALLENGE 3: ANALYZE AVAILABILITY THREATS AND CONTROLS\n## ===================================================================\n\n## Availability Incident (Recent DDoS Attack):\n## Q11: Describe the DDoS attack impact:\n##      - Duration: ___ hours\n##      - Revenue loss: $___\n##      - Customer trust impact: _______________\n##      - Root cause: _______________\n\n## Q12: Design availability controls:\n##      - DDoS mitigation strategy: _______________\n##      - Redundant ISPs: ___ (how many?)\n##      - Load balancing: _______________\n##      - Failover time target: ___ seconds\n##      - Uptime SLA commitment: ___% (what's reasonable?)\n\n## Q13: Business continuity planning:\n##      - Recovery Time Objective (RTO): ___ hours\n##      - Recovery Point Objective (RPO): ___ hours\n##      - Backup frequency: _______________\n##      - Backup location (geography): _______________\n##      - DR site type: Cold/Warm/Hot - justify\n\n## Q14: High-availability database design:\n##      - Primary/secondary replication? Yes/No\n##      - Replication frequency: _______________\n##      - Failover mechanism: _______________\n##      - Data loss tolerance: ___ transactions\n\n## ===================================================================\n## CHALLENGE 4: DEFENSE IN DEPTH STRATEGY\n## ===================================================================\n\n## Defense in Depth Layers (Design multi-layered security):\n## Q15: Map security controls to OSI layers:\n##      Layer 1 (Physical): _______________\n##      Layer 2 (Data Link): _______________\n##      Layer 3 (Network): _______________\n##      Layer 4 (Transport): _______________\n##      Layer 7 (Application): _______________\n\n## Q16: Design 5-layer defense for customer database:\n##      Layer 1 (Perimeter): Firewalls, IDS/IPS\n##      Layer 2 (Network): _______________\n##      Layer 3 (Host): _______________\n##      Layer 4 (Application): _______________\n##      Layer 5 (Data): _______________\n\n## Q17: Single Point of Failure Analysis:\n##      - If Layer 1 (firewall) fails: Impact? _______________\n##      - If Layer 2 (encryption) fails: Impact? _______________\n##      - If Layer 3 (access control) fails: Impact? _______________\n##      - How to eliminate each SPOF?\n\n## Q18: Cost of defense in depth:\n##      - Layer 1 (Perimeter firewalls): $___/year\n##      - Layer 2 (Network segmentation): $___/year\n##      - Layer 3 (Host hardening): $___/year\n##      - Layer 4 (Application security): $___/year\n##      - Layer 5 (Data protection): $___/year\n##      - Total annual cost: $___\n##      - Budget constraint: $500K/year\n##      - Decision: Implement all layers? Prioritize? Phased approach?\n\n## ===================================================================\n## CHALLENGE 5: SECURITY LIFECYCLE AND COMPLIANCE\n## ===================================================================\n\n## Security Lifecycle Phases:\n## Q19: Map company status to security lifecycle:\n##      Plan: Define security requirements -> Status: _______________\n##      Design: Architecture and controls -> Status: _______________\n##      Implement: Deploy controls -> Status: _______________\n##      Operate: Manage security daily -> Status: _______________\n##      Monitor: Detect threats -> Status: _______________\n##      Respond: React to incidents -> Status: _______________\n##      Improve: Lessons learned -> Status: _______________\n\n## Q20: Compliance mapping:\n##      PCI DSS requires encryption: Implemented? Yes/No - Where?\n##      SOC 2 requires access logging: Implemented? Yes/No - Where?\n##      GLBA requires data protection: Implemented? Yes/No - Where?\n##      State regulation requires ___: Implemented? ___\n\n## Q21: Continuous improvement plan:\n##      - Annual security assessment frequency: ___\n##      - Penetration testing frequency: ___\n##      - Security policy review frequency: ___\n##      - Employee security training frequency: ___\n##      - Incident response drill frequency: ___\n\n## Q22: Risk assessment and prioritization:\n##      Risk 1: Data breach (Confidentiality) - Impact: High, Likelihood: Medium\n##                Risk Score: ___ - Priority: ___\n##      Risk 2: Configuration drift (Integrity) - Impact: Medium, Likelihood: High\n##                Risk Score: ___ - Priority: ___\n##      Risk 3: DDoS attack (Availability) - Impact: High, Likelihood: Medium\n##                Risk Score: ___ - Priority: ___\n\n## Q23: Remediation roadmap:\n##      Q1 2026: Implement ___ (highest priority risk mitigation)\n##      Q2 2026: Implement ___\n##      Q3 2026: Implement ___\n##      Q4 2026: Implement ___",
  "solution": "# CIA TRIAD SECURITY DESIGN - SOLUTION\n# SecureFinance Corp - Comprehensive Security Architecture\n\n## ===================================================================\n## CHALLENGE 1: CONFIDENTIALITY THREATS AND CONTROLS\n## ===================================================================\n\n### Q1: Five Confidentiality Threats\n1. **Network Interception**: Attacker on network path intercepts unencrypted customer data (MITM)\n2. **Unauthorized Database Access**: Compromised credentials or SQL injection exposes customer records\n3. **Insider Threat**: Disgruntled employee accesses customer data beyond job responsibilities\n4. **Physical Device Theft**: Stolen laptop or backup drive containing customer data\n5. **Social Engineering**: Phishing attack tricks employee into revealing credentials/data\n\n### Q2: Highest Risk Threat\n**Answer**: Unauthorized database access (SQL injection or credential compromise)\n**Justification**: \n- Database contains 50,000 customer records (largest data concentration)\n- High-value target for attackers\n- Potential compliance violations (PCI DSS, GLBA, SOC 2)\n- Recent competitor breach suggests active threat actors targeting financial sector\n- Financial impact: $10M+ regulatory fines + customer compensation + reputation damage\n\n### Q3: Customer Database Protection (At Rest)\n- **Encryption algorithm**: AES-256 (industry standard for financial data)\n- **Key management**: Hardware security module (HSM) for key storage, key rotation quarterly\n- **Access control method**: Role-based access control (RBAC) - only employees with business need\n- **Who should have access**:\n  - Database administrators (for maintenance only)\n  - Application servers (via encrypted connection)\n  - Customer service representatives (read-only, filtered by customer ID)\n  - Compliance auditors (quarterly access, logged)\n  - NO: Remote workers, branch offices, contractors\n\n### Q4: Remote Workers (Data in Transit)\n- **Encryption protocol**: TLS 1.3 or IPSec VPN with AES-256\n- **VPN requirements**:\n  - Mandatory site-to-site VPN for branch offices\n  - Mandatory client VPN for remote workers (cannot access systems without VPN)\n  - VPN split-tunneling: DISABLED (forces all traffic through VPN)\n  - VPN logs: Retained 1 year for compliance\n- **Multi-factor authentication**: YES - Required because remote = higher risk\n  - Something you know (password)\n  - Something you have (hardware token or app-based OTP)\n  - Certificate-based authentication for system-to-system\n- **Session timeout policy**: 15 minutes idle timeout (PCI DSS requirement)\n\n### Q5: Cost-Benefit Analysis\n- **Cost of strong encryption overhead**: $150K/year\n  - HSM hardware and licensing: $50K\n  - VPN infrastructure: $40K\n  - MFA implementation: $30K\n  - Key management system: $30K\n- **Cost of data breach (industry estimate)**: $5M - $50M\n  - Regulatory fines (up to $100 per record): 50,000 × $100 = $5M minimum\n  - Customer notification and monitoring: $1M\n  - Legal and investigation: $2M\n  - Revenue loss from customer defection: $10-30M\n  - Total potential: $18-38M\n- **ROI**: Cryptography overhead ($150K) vs breach cost ($18-38M) = ROI 120:1\n- **Conclusion**: Even if only 1% breach probability, expected loss ($180K-380K) > encryption cost\n\n## ===================================================================\n## CHALLENGE 2: INTEGRITY THREATS AND CONTROLS\n## ===================================================================\n\n### Q6: Configuration Drift Incident Analysis\n- **What changed**: Router ACL rules modified by automation script without approval\n  - Accidentally removed rule filtering private subnet traffic\n  - Result: Internal subnet exposed to customer-facing network\n- **Who made the change**: Automated deployment script (root cause: no approval gate)\n- **When discovered**: 4 days later during routine audit\n- **Business impact**: \n  - Billing errors due to internal system confusion: $50K incorrect charges\n  - Customer complaints and re-billing costs: $150K\n  - Potential exposure of internal financial data: High risk\n  - Compliance violation (SOC 2 requires change management): Audit finding\n\n### Q7: Integrity Controls Design\n- **Version control system**: Git with centralized repository\n  - All configs committed with change description\n  - Branch protection: require peer review before merge to production\n  - Signed commits: require GPG signature from authorized personnel\n- **Change approval process**:\n  - Pre-production: 2 reviewer approval required\n  - Change advisory board (CAB) for critical systems\n  - Maintenance window scheduling (avoid business hours when possible)\n  - Post-implementation verification checklist\n- **Rollback capability**: YES - Git allows reverting to previous config\n  - Automated rollback for failed deployment (health checks)\n  - Manual rollback if business logic errors discovered\n  - Rollback time target: <5 minutes\n- **Audit logging**:\n  - Every configuration change logged with: who, what, when, why\n  - Log retention: 7 years (compliance requirement)\n  - Immutable log storage (prevents tampering)\n  - SIEM alerting on unauthorized changes\n- **File integrity monitoring**: YES - AIDE (Advanced Intrusion Detection Environment)\n  - Hash all critical configs daily\n  - Alert immediately if hash changes unexpectedly\n  - Prevents unauthorized modifications from going undetected\n\n### Q8: File Integrity Checking Example\n```\n# Hash-based integrity check\nInitial hash of router-config.txt (Day 1):\n$ sha256sum router-config.txt\na7b3c8d9e1f2g3h4i5j6k7l8m9n0o1p2  router-config.txt\n\n# After authorized modification (Day 2):\nNew hash:\n$ sha256sum router-config.txt\nb8c4d9e0f3g4h5i6j7k8l9m0n1o2p3q3  router-config.txt\n\n# Do hashes match? NO - Expected because we made an approved change\n# If hash changed WITHOUT authorization, AIDE would alert immediately\n\n# Verify change was approved:\n$ git log router-config.txt\ncommit b8c4d9e0f3: \"ACL rule update for VLAN 50 per CAB-2025-1141\"\nAuthor: NetworkEngineer <engineer@securefinance.com>\nDate: 2025-11-25\n\n# Audit trail confirms: change approved, documented, authorized\n```\n\n### Q9: Transaction Integrity in Financial System\n- **Digital signature on each transaction**: YES - Required by PCI DSS\n  - Uses private key of originating system to sign transaction\n  - Recipient verifies signature with public key\n  - Confirms: authenticity (came from legitimate source), integrity (not modified)\n  - Example: Payment processor signs $10,000 transaction\n- **Non-repudiation requirement**: YES - Critical for financial accountability\n  - Sender cannot deny they authorized transaction\n  - Proof: digitally signed with their private key\n  - Legal requirement: financial transactions must be traceable to authorized person\n- **Blockchain for immutability**: Pros/Cons\n  - **Pros**: Immutable transaction ledger, distributed validation, cryptographic proof\n  - **Cons**: Slower than centralized database, higher computational cost, complexity\n  - **Verdict**: Overkill for internal financial system; standard database with digital signatures sufficient\n\n### Q10: PCI DSS Integrity Requirements\n- **Must validate system changes how**: \n  - Formal change control process with documented approval\n  - Testing in non-production before deployment\n  - Separation of duties: requester ≠ approver ≠ implementer\n  - Change log reviewed regularly (at least monthly)\n- **Configuration change audit trail**:\n  - Every change logged with: timestamp, who made change, what changed, why\n  - Logs retained minimum 1 year\n  - Logs protected from modification (immutable storage)\n  - Regular review and reconciliation\n- **Testing before production deployment**: YES (mandatory)\n  - Development environment (isolated)\n  - Staging environment (production-like)\n  - UAT (user acceptance testing)\n  - Sign-off from business before production release\n\n## ===================================================================\n## CHALLENGE 3: AVAILABILITY THREATS AND CONTROLS\n## ===================================================================\n\n### Q11: DDoS Attack Impact Analysis\n- **Duration**: 2 hours (longer than acceptable)\n- **Revenue loss**: $200K (website down = no transactions processed)\n- **Customer trust impact**: Moderate - single incident, but concerning for financial institution\n- **Root cause**: ISP didn't filter DDoS traffic; company lacked rate limiting\n- **Attack type**: Likely volumetric (bandwidth exhaustion) based on ISP saturation\n\n### Q12: Availability Controls Design\n- **DDoS mitigation strategy**:\n  - ISP-level DDoS scrubbing service: Scrub malicious traffic before reaching network\n  - Cloud-based CDN with DDoS protection: Cloudflare, Akamai, or AWS Shield\n  - Rate limiting at edge: Limit requests per source IP\n  - Geo-blocking: Block traffic from unexpected countries\n  - Behavioral analysis: Machine learning to detect attack patterns\n- **Redundant ISPs**: 2 ISPs (currently have this)\n  - Active-active: Both ISPs carrying traffic simultaneously\n  - BGP failover: Automatic switching if primary ISP becomes unavailable\n  - Different carriers/paths: Ensures diversity\n- **Load balancing**: Multiple web servers behind load balancer\n  - Distributes traffic across servers\n  - Removes single point of failure\n  - Healthchecks: Route away from failing servers\n- **Failover time target**: <30 seconds (automatic)\n  - Manual DNS changes would take minutes to propagate\n  - Automatic BGP failover achieves <30 second RTO\n- **Uptime SLA commitment**: 99.9% (three nines)\n  - Achievable for financial institution with reasonable investment\n  - Allows ~43 minutes downtime per month\n  - Translates to: 4 hours 23 minutes per year maximum\n\n### Q13: Business Continuity Planning\n- **Recovery Time Objective (RTO)**: 4 hours\n  - Acceptable for financial services (must restore before next business day)\n  - Allows time for investigation and careful recovery\n  - Faster recovery increases cost significantly\n- **Recovery Point Objective (RPO)**: 1 hour\n  - No more than 1 hour of data loss acceptable\n  - Financial transactions must be precise\n  - Impacts backup frequency\n- **Backup frequency**: Every 1 hour (continuous or hourly snapshots)\n  - Incremental backups to minimize storage\n  - Full backup weekly\n- **Backup location (geography)**: \n  - Primary: Same city as HQ (fast recovery)\n  - Secondary: Different state (disaster recovery for regional disasters)\n  - Tertiary: Different region (protection against widespread outages)\n- **DR site type**: WARM SITE (justified)\n  - **Cold**: Too slow for financial services (could take days)\n  - **Hot**: Too expensive for 4-hour RTO\n  - **Warm**: Pre-configured hardware, standby databases, ready for activation\n  - **Cost**: ~$100K setup + $20K/month vs hot site $100K/month\n\n### Q14: High-Availability Database Design\n- **Primary/secondary replication**: YES - Required for financial accuracy\n  - Primary database handles all write transactions\n  - Secondary database (standby) receives real-time replication\n  - If primary fails, failover to secondary with minimal data loss\n- **Replication frequency**: Synchronous (real-time)\n  - Every transaction replicated to secondary before acknowledging to client\n  - Ensures zero data loss\n  - Slight latency acceptable for financial transactions\n  - Alternative: Asynchronous = faster but risk of losing last transaction\n- **Failover mechanism**: Automatic (no human intervention)\n  - Heartbeat monitoring detects primary failure\n  - Automatic promotion of secondary to primary (database-level or cluster manager)\n  - Application reconnects automatically\n  - Failover time: <1 minute\n- **Data loss tolerance**: 0 transactions (in financial services)\n  - Cannot lose customer transactions\n  - Synchronous replication enforces this\n  - Cost: Minimal latency overhead\n\n## ===================================================================\n## CHALLENGE 4: DEFENSE IN DEPTH STRATEGY\n## ===================================================================\n\n### Q15: Security Controls at OSI Layers\n- **Layer 1 (Physical)**: Data center security, locked cabinets, environmental controls\n  - Cameras monitoring server room\n  - Access badges with logging\n  - Climate control preventing equipment failure\n  - Power redundancy (UPS, backup generators)\n- **Layer 2 (Data Link)**: Network segmentation, VLAN isolation\n  - VLANs separate customer-facing from internal networks\n  - MAC address filtering on access switches\n  - Spanning tree to prevent loops (availability)\n- **Layer 3 (Network)**: Firewalls, routing, access control lists\n  - Perimeter firewalls: Block unauthorized traffic\n  - Router ACLs: Filter by source/destination IP\n  - DDoS protection: Rate limiting, anomaly detection\n- **Layer 4 (Transport)**: Encryption, VPN, secure protocols\n  - TLS 1.3 for HTTPS traffic\n  - IPSec VPN for site-to-site communications\n  - No unencrypted protocols (no Telnet, only SSH)\n- **Layer 7 (Application)**: Authentication, authorization, input validation\n  - Multi-factor authentication\n  - SQL injection prevention (parameterized queries)\n  - XSS protection (input/output validation)\n  - Session management (timeouts, secure cookies)\n\n### Q16: 5-Layer Defense for Customer Database\n1. **Perimeter Defense**: Firewalls, IDS/IPS, DDoS protection\n   - Block unauthorized access attempts\n   - Detect intrusion patterns\n2. **Network Defense**: Network segmentation, VLANs, routing controls\n   - Database server on isolated VLAN\n   - Only application servers can connect to database VLAN\n3. **Host Defense**: OS hardening, endpoint protection, file integrity monitoring\n   - Minimal services running (database only)\n   - Firewall on host (secondary firewall)\n   - Intrusion detection on database server\n4. **Application Defense**: Authentication, authorization, input validation\n   - Strong passwords + MFA required\n   - Role-based access (customer service can't modify records)\n   - Prepared statements prevent SQL injection\n5. **Data Defense**: Encryption at rest, encryption in transit, access logging\n   - AES-256 encryption of database\n   - TLS encryption for connections\n   - Every query logged and audited\n\n### Q17: Single Point of Failure Analysis\n- **If Layer 1 (firewall) fails**:\n  - Impact: Unfiltered external traffic reaches network = high risk\n  - Mitigation: Redundant firewalls (active-active or active-passive)\n  - Recovery: <30 second automatic failover\n- **If Layer 2 (encryption) fails**:\n  - Impact: Customer data transmitted unencrypted = compliance violation\n  - Mitigation: Multiple encryption endpoints, crypto hardware redundancy\n  - Recovery: Immediate cutoff of unencrypted connections\n- **If Layer 3 (access control) fails**:\n  - Impact: All users can access all data = catastrophic\n  - Mitigation: Database-level access controls (second layer)\n  - Recovery: Manual access restriction while fixing ACLs\n- **If Layer 4 (application) fails**:\n  - Impact: SQL injection or authentication bypass\n  - Mitigation: Input validation, parameterized queries (secure coding)\n  - Recovery: Rollback application code to previous version\n- **If Layer 5 (database) fails**:\n  - Impact: No data protection = total compromise\n  - Mitigation: Backup encryption keys in HSM\n  - Recovery: Restore from encrypted backup\n\n### Q18: Cost of Defense in Depth ($500K/year budget)\n- **Layer 1 (Perimeter firewalls)**: $80K/year\n  - Redundant Cisco ASA or Palo Alto firewalls: $50K\n  - DDoS mitigation service: $30K\n- **Layer 2 (Network segmentation)**: $40K/year\n  - VLAN management: $15K\n  - Network monitoring: $25K\n- **Layer 3 (Host hardening)**: $60K/year\n  - Host-based firewalls: $20K\n  - Endpoint protection: $40K\n- **Layer 4 (Application security)**: $150K/year\n  - Secure code review tools: $30K\n  - Web application firewall: $50K\n  - Penetration testing: $70K\n- **Layer 5 (Data protection)**: $170K/year\n  - HSM for key management: $50K\n  - Database encryption: $30K\n  - Backup encryption and storage: $60K\n  - Data loss prevention: $30K\n- **Total**: $500K/year - Exactly matches budget\n- **Decision**: Implement all layers in phased approach\n  - **Phase 1** (Year 1): Perimeter + Network = $120K (address external threats)\n  - **Phase 2** (Year 2): Host + Application = $210K (internal security)\n  - **Phase 3** (Year 3): Data Protection = $170K (core data security)\n\n## ===================================================================\n## CHALLENGE 5: SECURITY LIFECYCLE AND COMPLIANCE\n## ===================================================================\n\n### Q19: Security Lifecycle Status\n- **Plan**: Define requirements → Status: COMPLETE\n  - Compliance requirements identified (PCI DSS, SOC 2, GLBA)\n  - Security objectives defined\n- **Design**: Architecture and controls → Status: PARTIAL\n  - Design in progress (this exercise)\n  - Technical architecture needed\n- **Implement**: Deploy controls → Status: BEGINNING\n  - Starting with high-risk items (encryption, firewalls)\n- **Operate**: Manage daily → Status: PLANNED\n  - Security operations center (SOC) staffing needed\n- **Monitor**: Detect threats → Status: PLANNED\n  - SIEM deployment Q1 2026\n- **Respond**: React to incidents → Status: PARTIAL\n  - Incident response plan exists but not tested\n- **Improve**: Lessons learned → Status: NOT STARTED\n  - Post-incident reviews not yet established\n\n### Q20: Compliance Mapping\n- **PCI DSS requires encryption**: \n  - Implemented: PARTIAL - Only at database, not in transit\n  - Where: Database (AES-256), VPN (TLS 1.3)\n  - Gap: Need to encrypt backups and archived data\n- **SOC 2 requires access logging**:\n  - Implemented: PARTIAL - Some systems logged, no centralization\n  - Where: Database audit logs, firewall logs\n  - Gap: Need centralized logging (SIEM) and long-term retention\n- **GLBA requires data protection**:\n  - Implemented: PARTIAL - Basic security controls in place\n  - Where: Access controls, encryption, backup procedures\n  - Gap: Need formal documentation of controls for regulatory review\n- **State regulation requires**: Data notification within 30 days of breach discovery\n  - Implemented: PARTIAL - Process exists but not tested\n  - Gap: Need automated breach detection and notification system\n\n### Q21: Continuous Improvement Plan\n- **Annual security assessment frequency**: 4 times per year (quarterly)\n  - Covers compliance requirements and emerging threats\n- **Penetration testing frequency**: 2 times per year (semi-annual)\n  - External and internal penetration tests\n  - Include social engineering assessment\n- **Security policy review frequency**: 2 times per year\n  - Update policies based on audit findings\n  - Account for organizational changes\n- **Employee security training frequency**: 4 times per year (quarterly)\n  - Phishing simulation monthly\n  - Full security awareness training quarterly\n- **Incident response drill frequency**: 4 times per year (quarterly)\n  - Tabletop exercises (discuss scenarios)\n  - Full simulation at least annually\n\n### Q22: Risk Assessment and Prioritization\n- **Risk 1: Data Breach (Confidentiality)**\n  - Impact: High ($20M+ loss, compliance violation, reputation)\n  - Likelihood: Medium (financial sector is targeted, but defenses exist)\n  - Risk Score: 5 × 3 = 15 (Medium-High)\n  - **Priority: 1 (Highest)** - Affects customer trust, regulatory compliance\n\n- **Risk 2: Configuration Drift (Integrity)**\n  - Impact: Medium ($500K loss, temporary exposure, audit finding)\n  - Likelihood: High (automation without controls)\n  - Risk Score: 3 × 4 = 12 (Medium)\n  - **Priority: 2** - Process-based (easier to fix than data breach)\n\n- **Risk 3: DDoS Attack (Availability)**\n  - Impact: High ($200K loss, customer frustration, SLA breach)\n  - Likelihood: Medium (financial services are targeted, but ISP protection exists)\n  - Risk Score: 4 × 3 = 12 (Medium)\n  - **Priority: 2** (tied with Risk 2) - Can mitigate with ISP partnership\n\n### Q23: Remediation Roadmap (12-Month Plan)\n- **Q1 2026**: Database encryption and HSM key management\n  - Highest risk mitigation (Risk 1)\n  - Foundation for compliance (PCI DSS)\n  - Cost: $80K\n\n- **Q2 2026**: Change management system implementation\n  - Address configuration drift risk (Risk 2)\n  - Enable SOC 2 Type II compliance\n  - Cost: $40K\n\n- **Q3 2026**: DDoS mitigation and failover automation\n  - Protect against availability attacks (Risk 3)\n  - Improve uptime SLA\n  - Cost: $90K\n\n- **Q4 2026**: Security monitoring infrastructure (SIEM)\n  - Enable threat detection and response\n  - Support compliance auditing\n  - Cost: $80K",
  "hints": [
    "CIA triad is foundational - Confidentiality, Integrity, Availability are interdependent",
    "Defense in depth means multiple layers - single layer is insufficient",
    "Single point of failure (SPOF) analysis reveals where to add redundancy",
    "Compliance requirements often specify exact controls (PCI DSS is very prescriptive)",
    "Risk scoring: Impact × Likelihood helps prioritize remediation efforts",
    "Financial services breach costs are extreme ($5M-50M range typical)",
    "Encryption is necessary but not sufficient - also need access control and monitoring",
    "Database is highest value target for financial data - layer protection heavily here",
    "Remote workers are higher risk than office workers - enforce MFA and VPN",
    "Backup strategy must protect confidentiality AND ensure availability AND maintain integrity"
  ],
  "testCases": [
    {
      "id": "tc1-cia",
      "description": "CIA triad definitions and examples",
      "input": "Security principles",
      "expected": "Confidentiality, Integrity, and Availability each defined with real examples",
      "assert": "assert 'Confidentiality' in solution and 'Integrity' in solution and 'Availability' in solution"
    },
    {
      "id": "tc2-threat-analysis",
      "description": "Threat identification for each CIA component",
      "input": "Threats to financial system",
      "expected": "At least 3 specific threats for each CIA component",
      "assert": "assert ('threat' in solution.lower() or 'attack' in solution.lower()) and ('data' in solution.lower() or 'breach' in solution.lower())"
    },
    {
      "id": "tc3-controls",
      "description": "Security control design",
      "input": "Control mechanisms",
      "expected": "Controls addressing encryption, access control, and monitoring",
      "assert": "assert ('encryption' in solution.lower() or 'aes' in solution.lower()) and 'access' in solution.lower()"
    },
    {
      "id": "tc4-defense-depth",
      "description": "Defense in depth strategy",
      "input": "Layered security",
      "expected": "Multiple layers of defense at different OSI levels",
      "assert": "assert 'layer' in solution.lower() and 'defense' in solution.lower()"
    },
    {
      "id": "tc5-compliance",
      "description": "Compliance requirements mapping",
      "input": "Regulatory alignment",
      "expected": "Compliance requirements (PCI DSS, SOC 2, GLBA) mentioned with specific controls",
      "assert": "assert ('pci' in solution.lower() or 'soc 2' in solution.lower() or 'glba' in solution.lower())"
    },
    {
      "id": "tc6-risk-assessment",
      "description": "Risk prioritization",
      "input": "Risk management",
      "expected": "Risk scoring with impact and likelihood assessment",
      "assert": "assert 'risk' in solution.lower() and ('impact' in solution.lower() or 'likelihood' in solution.lower())"
    },
    {
      "id": "tc7-budget",
      "description": "Cost-benefit analysis",
      "input": "Financial ROI",
      "expected": "Security investment justified against breach costs",
      "assert": "assert ('cost' in solution.lower() or '$' in solution) and ('roi' in solution.lower() or 'benefit' in solution.lower())"
    },
    {
      "id": "tc8-rto-rpo",
      "description": "Business continuity targets",
      "input": "Availability requirements",
      "expected": "RTO and RPO defined with business justification",
      "assert": "assert ('rto' in solution.lower() or 'recovery time' in solution.lower()) and ('rpo' in solution.lower() or 'recovery point' in solution.lower())"
    },
    {
      "id": "tc9-remote-security",
      "description": "Remote worker security",
      "input": "Remote access controls",
      "expected": "VPN, MFA, and session management for remote workers",
      "assert": "assert 'remote' in solution.lower() and ('vpn' in solution.lower() or 'mfa' in solution.lower())"
    },
    {
      "id": "tc10-lifecycle",
      "description": "Security lifecycle phases",
      "input": "Continuous security process",
      "expected": "All lifecycle phases addressed: Plan, Design, Implement, Operate, Monitor, Respond, Improve",
      "assert": "assert 'lifecycle' in solution.lower() or ('plan' in solution.lower() and 'implement' in solution.lower() and 'monitor' in solution.lower())"
    }
  ]
}
