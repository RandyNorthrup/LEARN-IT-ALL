{
  "id": "exercise-037-ids-ips-monitoring",
  "lessonId": "lesson-037-ids-ips-monitoring",
  "title": "Intrusion Detection and Prevention Systems",
  "description": "Implement intrusion detection (IDS) and intrusion prevention systems (IPS) to monitor and stop network attacks. Analyze network traffic patterns, identify threats, configure detection rules, and respond to security incidents.",
  "difficulty": "intermediate",
  "points": 100,
  "language": "text",
  "starterCode": "# INTRUSION DETECTION AND PREVENTION SYSTEMS EXERCISE\n# Monitor network attacks and prevent intrusions\n\n## SCENARIO: TechCorp security breach\n## - Network: 5,000 employees, 50 branch offices\n## - Data: Financial data, customer information, trade secrets\n## - Previous incidents:\n##   * Port scanning detected (attacker reconnaissance)\n##   * Unauthorized SSH login attempts (brute force)\n##   * SQL injection attack on web portal (application attack)\n##   * Data exfiltration attempt (stolen files to attacker server)\n## - Current state: No IDS/IPS deployed (only firewall)\n\n## PART 1: IDS/IPS FUNDAMENTALS\n## Q1: Intrusion Detection System (IDS):\n##     - Definition: _______\n##     - Function: Detect attacks? Yes / No\n##     - Prevent attacks? Yes / No\n##     - Response: How does IDS respond to attack?\n##     - Example: Detects SQL injection attack\n##     - Action taken: _______ (logs/alerts)\n##\n## Q2: Intrusion Prevention System (IPS):\n##     - Definition: _______\n##     - Function: Detect attacks? Yes / No\n##     - Prevent attacks? Yes / No\n##     - Response: How does IPS respond to attack?\n##     - Example: Detects SQL injection attack\n##     - Action taken: _______ (blocks/drops)\n##\n## Q3: Difference between IDS and IPS:\n##     - IDS: Detects but _______\n##     - IPS: Detects and _______\n##     - Timeline: IDS action (hours/days) vs IPS action (milliseconds)\n##     - Cost: IDS cheaper or IPS? _______\n##     - Risk: IDS false positive → _______, IPS false positive → _______\n##     - Deployment: IDS in monitoring mode vs IPS in _______\n##\n## Q4: IDS/IPS detection methods:\n##     - Signature-based: Looks for _______ (known attack patterns)\n##     - Example: \"SQL injection = pattern UNION SELECT\"\n##     - Anomaly-based: Looks for _______ (unusual behavior)\n##     - Example: \"Port scan = many connection attempts\"\n##     - Hybrid: Combines both methods\n##     - Limitation of signature-based: _______ (what about new attacks?)\n##     - Limitation of anomaly-based: _______ (high false positives)\n\n## PART 2: IDS/IPS PLACEMENT AND ARCHITECTURE\n## Q5: Network placement options:\n##     - Inline IPS: Placed _______ in network path\n##     - Benefit: _______ (can block)\n##     - Risk: _______ (single point of failure)\n##     - Bypass: If IPS fails, does traffic bypass? Yes / No\n##     \n##     - Out-of-band IDS: Traffic copied to IDS (SPAN/mirror port)\n##     - Benefit: _______ (doesn't affect traffic)\n##     - Limitation: _______ (cannot block attacks)\n##     - Detection: Still detects attacks? Yes / No\n\n## Q6: Segmentation and IDS/IPS placement:\n##     Network segments:\n##     - Internet: Attackers, public traffic\n##     - DMZ: Web servers (public-facing)\n##     - Internal: Employees, confidential data\n##     - Management: Network admin tools\n##     \n##     Where to place IDS/IPS:\n##     - Edge (Internet-DMZ border): Detect _______ attacks\n##     - Core (DMZ-Internal border): Detect _______ attacks\n##     - Internal: Detect _______ attacks (lateral movement)\n##     \n##     Priority placement: _______ (which is most critical?)\n##\n## PART 3: ATTACK TYPES AND DETECTION\n## Q7: Port scanning (reconnaissance):\n##     - What: Attacker probes ports to find _______\n##     - Signature: Many TCP SYN packets to different ports\n##     - Detection: IDS sees _______ in short time\n##     - Response (IDS): Log and alert\n##     - Response (IPS): Block scanning IP? Yes / No\n##     - Risk: False positive from network admin?\n##     - Mitigation: _______ (adjust threshold)\n##\n## Q8: Brute force attack (password cracking):\n##     - What: Attacker tries many _______ to guess password\n##     - Example: SSH login, FTP login, HTTP authentication\n##     - Signature: Many failed login attempts from same IP\n##     - Detection: IDS sees _______ (50+ failed logins)\n##     - Response (IDS): Log and alert\n##     - Response (IPS): Block IP temporarily? Yes / No\n##     - Timing: Attack detected after _______ attempts (10, 50, 100?)\n##\n## Q9: SQL injection attack (application attack):\n##     - What: Attacker injects _______ into web form\n##     - Example: Login form username: \"admin' --\"\n##     - Signature: Detects SQL keywords in unusual place\n##     - Detection: IDS analyzes _______ payload\n##     - Response (IDS): Log and alert security team\n##     - Response (IPS): Block request immediately? Yes / No\n##     - Benefit of IPS: _______ (prevents before reaching app)\n##\n## Q10: DDoS attack (denial of service):\n##      - What: Attacker floods _______ with traffic\n##      - Goal: Overwhelm server, crash service\n##      - Scale: Many bots sending traffic from _______ IPs\n##      - Detection: IDS sees _______ (high volume from many sources)\n##      - Response (IDS): Alert (cannot stop distributed attack)\n##      - Response (IPS): Block many IPs? Problem: _______\n##      - Mitigation: _______ (upstream, ISP level)\n\n## PART 4: SIGNATURE-BASED DETECTION\n## Q11: Creating detection signatures:\n##      - Format: Pattern to match attack traffic\n##      - Example signature (SQL injection):\n##        \"If HTTP request contains 'UNION' OR 'SELECT' OR 'DROP' → ALERT\"\n##      - Problem: False positive example: _______\n##      - Solution: More specific pattern\n##      \n##      - Example signature (Port scan):\n##        \"If SYN packets to 20+ different ports in 60 sec → ALERT\"\n##      - Threshold: 20 ports in 60 seconds\n##      - Tuning: Increase to 50 if too many false positives\n##\n## Q12: Common signatures for TechCorp:\n##      - Signature 1: Brute force attack\n##        Rule: \"If 10+ failed SSH logins from same IP in 5 min → BLOCK IP\"\n##      - Signature 2: SQL injection\n##        Rule: \"If HTTP request contains SQL keywords in body → BLOCK\"\n##      - Signature 3: Port scan\n##        Rule: \"If SYN packets to 30+ ports in 60 sec → BLOCK IP\"\n##      - Signature 4: Known malware signature\n##        Rule: \"If traffic matches known malware pattern → ALERT/BLOCK\"\n##      - Signature 5: Data exfiltration\n##        Rule: \"If large file transfer to external IP → ALERT\"\n\n## PART 5: ANOMALY-BASED DETECTION\n## Q13: Anomaly detection baseline:\n##      - Baseline: Normal traffic pattern\n##      - Measurement: Volume, protocols, ports, times\n##      - Example: Normal = 100 Mbps daytime, 10 Mbps night\n##      - Anomaly: Sudden 1 Gbps at 2 AM (unusual)\n##      - Detection: IDS compares to baseline, alerts if unusual\n##      - Tuning: _______ (how much deviation triggers alert?)\n##      \n##      - Problem 1: Learning period required? _______\n##      - Problem 2: Legitimate changes (new application) trigger false positive? _______\n##      - Problem 3: Adversary adaptation (attacker slowly increases traffic)? _______\n\n## Q14: Behavioral analysis:\n##      - Monitors: User behavior patterns\n##      - Example: User normally accesses files 9-5 (daytime)\n##      - Anomaly: User accessing files at 3 AM\n##      - Alert: Unusual access pattern (possible breach)\n##      - Learning: Requires _______ (weeks/months of baseline)\n##      - Privacy: Monitoring user activity continuously? Concerns\n\n## PART 6: IDS/IPS ALERT HANDLING\n## Q15: Alert response process:\n##      - IDS generates alert: \"SQL injection detected on web server\"\n##      - Alert includes: Timestamp, source IP, destination IP, payload, rule triggered\n##      - Response timeline:\n##        * Immediate (<1 sec): Block (if IPS) or log\n##        * Short-term (seconds): Notify SOC (Security Operations Center)\n##        * Medium-term (hours): Investigate (what was attacked?)\n##        * Long-term (days): Remediate (fix vulnerability)\n##      \n##      - Response process:\n##        1. Isolate: _______ (separate from network)\n##        2. Analyze: _______ (gather evidence)\n##        3. Contain: _______ (stop attack spread)\n##        4. Eradicate: _______ (remove attacker)\n##        5. Recover: _______ (restore services)\n\n## Q16: False positive vs false negative:\n##      - False positive: IDS alerts on _______ (not actual attack)\n##      - Example: SQL injection signature triggers on comment containing \"SELECT\"\n##      - Cost: SOC investigates for hours (wasted time)\n##      - False negative: IDS misses _______ (actual attack)\n##      - Example: New zero-day attack (no signature exists)\n##      - Cost: Attacker compromises system (severe)\n##      \n##      - Comparison: Which is worse? _______ (false negative)\n##      - Why: False positive = wasted time, False negative = security breach\n##      - Trade-off: Tune signatures aggressive (catch attacks) or conservative (avoid FP)?\n\n## Q17: Alert tuning:\n##      - Initial setup: Alert on many patterns (high sensitivity)\n##      - Result: Overwhelmed with alerts (alert fatigue)\n##      - Problem: SOC team ignores alerts (desensitization)\n##      - Solution: Tune signatures _______ (adjust thresholds)\n##      \n##      - Tuning example:\n##        * Signature: \"Port scan = 20+ ports in 60 sec\"\n##        * Too sensitive: 50 false positives per day\n##        * Adjustment: Increase to 50 ports (reduce false positives)\n##        * Result: 5 true positives, 2 false positives per day\n##        * Trade-off: Some scans missed vs manageable alert count\n\n## PART 7: IDS/IPS DEPLOYMENT\n## Q18: Hybrid deployment strategy:\n##      TechCorp has multiple locations:\n##      - Headquarters (main office, high traffic)\n##      - 50 branch offices (lower traffic)\n##      - Deployment strategy:\n##      \n##      Headquarters:\n##      - Deploy: Inline IPS at edge (prevents attacks immediately)\n##      - Deploy: Out-of-band IDS internally (detects lateral movement)\n##      - Redundancy: 2 IPS units (active-passive)\n##      - Cost: Highest security investment\n##      \n##      Branch offices:\n##      - Deploy: _______ (IPS or IDS?)\n##      - Why: _______ (cost vs protection trade-off)\n##      - Alternative: _______ (centralized monitoring?)\n\n## Q19: Management and correlation:\n##      - Each IDS/IPS generates alerts\n##      - Total alerts: HQ IPS (100/day) + HQ IDS (200/day) + 50 branches (50 each) = _______ alerts\n##      - Problem: Cannot manually review all\n##      - Solution: SIEM (Security Information and Event Management)\n##      - SIEM function: _______ (centralize, correlate, detect patterns)\n##      - Example: \"SQL injection at 3 branch offices simultaneously = coordinated attack\"\n##      - Detection: Without SIEM, alerts appear isolated; with SIEM, attack pattern visible\n\n## PART 8: INCIDENT RESPONSE\n## Q20: Incident timeline:\n##      Attack sequence:\n##      - 14:00: Port scan detected (reconnaissance)\n##      - 14:15: SQL injection attempt blocked (attack attempt)\n##      - 14:30: Brute force SSH detected (persistence attempt)\n##      - 14:45: Large data transfer to external IP detected (data exfiltration)\n##      \n##      Response:\n##      - 14:00 Alert: SOC reviews port scan (investigation begins)\n##      - 14:15 Alert: SQL injection blocked, no action needed (IPS stopped it)\n##      - 14:30 Alert: SSH brute force, block source IP immediately\n##      - 14:45 Alert: Data exfiltration, emergency response\n##        * Isolate compromised system immediately\n##        * Stop data transfer\n##        * Investigate what data was transferred\n##        * Notify incident response team\n##      \n##      Lessons:\n##      - Early detection (port scan) enables proactive defense\n##      - IPS blocks attack (SQL injection) without human intervention\n##      - Quick response (SSH brute force) limits damage\n\n## Q21: Forensics and evidence collection:\n##      - After incident: Need evidence for investigation\n##      - IDS/IPS provides: Logs, captured packets, alert details\n##      - Chain of custody: Maintain evidence integrity\n##      - Questions to answer:\n##        * What was attacked? _______\n##        * Who attacked? _______ (IP address, geographic location)\n##        * How long was attacker present? _______\n##        * What data was accessed? _______\n##        * What data was stolen? _______\n##      - IDS/IPS logs enable answering these questions\n\n## PART 9: IDS/IPS CHALLENGES\n## Q22: Encrypted traffic problem:\n##      - Modern traffic: HTTPS (encrypted)\n##      - IDS sees: Ciphertext (unreadable)\n##      - Cannot inspect: What is in HTTPS payload?\n##      - Problem: Malware/attack could hide in HTTPS\n##      - Solution 1: SSL/TLS decryption (proxy decrypts then inspects)\n##      - Risk: Performance impact, privacy concerns\n##      - Solution 2: Only inspect unencrypted traffic (less coverage)\n##      - Recommendation: Balance security vs performance\n\n## Q23: Tuning and maintenance:\n##      - New signatures released regularly (new attacks discovered)\n##      - Maintenance required: Update signatures weekly/monthly\n##      - Cost: Vendor subscriptions, tuning effort\n##      - Skipped updates: Missing coverage for recent attacks\n##      - Aggressive tuning: High false positives (alert fatigue)\n##      - Conservative tuning: Missing some attacks (false negatives)\n##      - Best practice: _______ (balance and monitoring)\n##      - Metrics to track:\n##        * Detection rate: What % of attacks caught?\n##        * False positive rate: How many false alerts?\n##        * Mean time to detect (MTTD): How fast detected?\n##        * Mean time to respond (MTTR): How fast responded?",
  "solution": "# INTRUSION DETECTION AND PREVENTION SYSTEMS SOLUTION\n\n## PART 1: IDS/IPS FUNDAMENTALS\n\n### Intrusion Detection System (IDS)\n\n**Definition**: Network security device that monitors traffic and logs/alerts when attack patterns detected\n\n**Function**: \n- Detect attacks? **YES**\n- Prevent attacks? **NO** (only detects)\n- Response: **Log and alert** (notify security team)\n\n**Example**: Detects SQL injection attack\n- **Action taken**: Logs incident, alerts SOC team (\"SQL injection detected\")\n- Timeline: Alert within seconds, investigation within minutes/hours\n- No automatic action (human decision required)\n\n### Intrusion Prevention System (IPS)\n\n**Definition**: Network security device that monitors traffic, detects attacks, AND automatically blocks/prevents them\n\n**Function**:\n- Detect attacks? **YES**\n- Prevent attacks? **YES** (detects and stops)\n- Response: **Block and drop** (automatically blocks malicious traffic)\n\n**Example**: Detects SQL injection attack\n- **Action taken**: Blocks request immediately (attacker never reaches application)\n- Timeline: Block within milliseconds (automatic)\n- No human intervention needed\n\n### Difference Between IDS and IPS\n\n**IDS**: Detects but **cannot prevent** (monitoring only)\n\n**IPS**: Detects and **blocks** (active defense)\n\n**Timeline**: \n- IDS action: Hours/days (after human review)\n- IPS action: Milliseconds (automatic)\n\n**Cost**: **IPS more expensive** (requires more processing, inline deployment)\n\n**Risk of false positive**:\n- IDS: Investigation wastes time (security team reviews false positive)\n- IPS: **Attack blocked** (legitimate user blocked if false positive)\n\n**Deployment**:\n- IDS: Monitoring mode (passive)\n- IPS: **Blocking mode** (active, inline)\n\n### IDS/IPS Detection Methods\n\n**Signature-based**: Looks for **known attack patterns** (like antivirus signatures)\n- Example: \"SQL injection = pattern 'UNION SELECT' in HTTP payload\"\n- Comparison: Similar to antivirus virus definitions\n- Fast: Quick pattern matching\n- Accurate: Matches known attacks precisely\n\n**Anomaly-based**: Looks for **unusual behavior** (deviations from baseline)\n- Example: \"Port scan = 50 connection attempts to different ports in 60 seconds\"\n- Example: \"Data exfiltration = 10 GB transfer to external IP (abnormal volume)\"\n- Flexible: Detects unknown attacks\n- Noisy: High false positives (legitimate unusual events)\n\n**Hybrid**: Combines both methods\n- Benefits: Known attacks (signature) + unknown attacks (anomaly)\n- Better detection overall\n\n**Limitation of signature-based**: **Cannot detect zero-day attacks** (new attacks with no signature)\n- Example: New ransomware with no known signature\n- Workaround: Behavioral heuristics can detect suspicious behavior\n\n**Limitation of anomaly-based**: **High false positives** (many legitimate anomalies)\n- Example: New legitimate application = unusual traffic pattern\n- Example: Network administrator testing = unusual port access\n- Mitigation: Tuning thresholds and baselines\n\n## PART 2: IDS/IPS PLACEMENT AND ARCHITECTURE\n\n### Network Placement Options\n\n**Inline IPS**: Placed **directly in network path** (traffic flows through device)\n\n```\nInternet ← [IPS] ← Internal Network\n       (inline position)\n```\n\n**Benefit**: Can block attacks in real-time\n\n**Risk**: Single point of failure\n- If IPS fails, no traffic flow\n- Solution: Redundancy (active-active or active-passive)\n\n**Bypass**: If IPS fails, does traffic bypass? **YES** (depends on bypass mode)\n- Active bypass: Traffic continues even if device fails\n- Passive bypass: No traffic (fail-closed, safer)\n\n**Out-of-band IDS**: Traffic **copied to IDS** (SPAN/mirror port)\n\n```\nInternet ← [Firewall] ← Internal Network\n                    ↓\n                   [IDS] (monitors copy, doesn't block)\n```\n\n**Benefit**: Doesn't affect traffic (non-intrusive)\n- Traffic flows normally regardless of IDS status\n- No performance impact\n- Cannot cause failures\n\n**Limitation**: Cannot block attacks (only detects)\n- IDS analyzes traffic but has no blocking capability\n- Security team must manually respond\n\n**Detection**: Still detects attacks? **YES**\n- Analyzes copied traffic same as inline\n- Alerts SOC when attacks detected\n- Allows time for investigation before blocking\n\n### Segmentation and IDS/IPS Placement\n\n**Network segments**:\n- **Internet**: Attackers, public traffic\n- **DMZ**: Web servers (public-facing)\n- **Internal**: Employees, confidential data\n- **Management**: Network admin tools\n\n**Where to place detection**:\n\n**Edge (Internet-DMZ border)**: Detect **inbound attacks** (from internet)\n- Port scans, exploit attempts, DDoS\n- First line of defense\n\n**Core (DMZ-Internal border)**: Detect **lateral movement** attacks\n- Attacker compromises web server, tries to move to internal network\n- Prevents internal access\n\n**Internal**: Detect **lateral movement and insider threats**\n- Employee to sensitive systems\n- Stolen credentials moving between servers\n\n**Priority placement**: **Edge (Internet-DMZ border)**\n- Most critical: Stops external attacks before reaching critical systems\n- Highest volume: Monitors all internet traffic\n- Protects entire network\n\n## PART 3: ATTACK TYPES AND DETECTION\n\n### Port Scanning (Reconnaissance)\n\n**What**: Attacker probes ports to find **open services** (what's running?)\n- Goal: Discover vulnerable services\n- Method: Send SYN to ports 1-1000, see which respond\n- Goal: Build map of target network\n\n**Signature**: Many TCP SYN packets to different ports\n\n**Detection**: IDS sees **many SYN packets in short time** (50+ to different ports)\n- Normal: Background traffic to ports 22, 80, 443 (web/SSH)\n- Scan: 1000 SYN packets to random ports (clearly reconnaissance)\n\n**Response (IDS)**: Log and alert (\"Port scan detected from X.X.X.X\")\n\n**Response (IPS)**: Block scanning IP? **YES**\n- IPS immediately blocks source IP (prevents next phase of attack)\n- Stops reconnaissance early\n\n**Risk**: False positive from network admin?\n- Network admin legitimately scanning ports (testing)\n- False alarm: Admin's IP blocked\n- Mitigation: **Whitelist admin IPs** (never block certain sources)\n\n### Brute Force Attack (Password Cracking)\n\n**What**: Attacker tries many **passwords** to guess correct one\n- Example: SSH login (username known, password guessed)\n- Example: FTP login (guess credentials)\n- Example: HTTP authentication (web app)\n\n**Signature**: Many failed login attempts from same IP\n\n**Detection**: IDS sees **failed login pattern** (50+ failed attempts)\n- Normal: User mistyping password (1-3 failed attempts)\n- Brute force: 100 failed attempts in 5 minutes (clearly attack)\n\n**Response (IDS)**: Log and alert (\"SSH brute force detected from X.X.X.X\")\n\n**Response (IPS)**: Block IP temporarily? **YES**\n- IPS blocks source IP for 15-30 minutes\n- Attacker cannot continue guessing\n- After timeout, IP unblocked (legitimate user can retry)\n\n**Timing**: Attack detected after **10+ failed attempts** (immediately)\n- Not waiting for 100 attempts\n- Quick threshold to stop early\n- Tuning: Adjust based on legitimate retry patterns\n\n### SQL Injection Attack (Application Attack)\n\n**What**: Attacker injects **SQL commands** into web form\n- Example: Login form username field: \"admin' --\"\n- Goal: Bypass authentication or extract data\n- Payload: SQL code in unexpected place\n\n**Signature**: Detects SQL keywords in unusual places\n- Normal: SQL on database (legitimate)\n- Attack: SQL in web form input (suspicious)\n- Keywords: UNION, SELECT, DROP, INSERT, DELETE\n\n**Detection**: IDS analyzes **HTTP payload** (request body)\n- Examines form data\n- If SQL keywords found: Alert\n- Pattern matching: \"username field contains 'UNION' → SQL injection\"\n\n**Response (IDS)**: Log and alert\n- Security team reviews\n- Manual investigation\n- Fix application code\n\n**Response (IPS)**: Block request immediately? **YES**\n- IPS blocks malicious HTTP request before reaching application\n- Prevents attack execution\n- Automatic: No human needed\n\n**Benefit of IPS**: **Prevents before reaching application**\n- Without IPS: SQL injection reaches database (could steal data)\n- With IPS: Blocked at network layer (attacker never reaches app)\n- Defense in depth: Application + IPS protection\n\n### DDoS Attack (Denial of Service)\n\n**What**: Attacker floods **server** with traffic\n- Goal: Overwhelm server, crash service\n- Result: Legitimate users cannot access service\n\n**Scale**: Many bots sending traffic from **multiple IPs** (distributed)\n- Attack: 10,000 computers sending traffic\n- Difficult to block: Different IPs each time\n\n**Detection**: IDS sees **high volume from many sources**\n- Normal: 1 Gbps traffic (typical peak)\n- DDoS: 100 Gbps traffic (overwhelming)\n- From: 10,000 different IPs (clearly distributed)\n\n**Response (IDS)**: Alert (cannot stop distributed attack)\n- IDS alerts SOC\n- Beyond IDS scope: Too much traffic to block individually\n\n**Response (IPS)**: Block many IPs? **Problem**: \n- If IPS blocks 10,000 IPs, creates massive blocklist\n- Eventually blocks legitimate traffic (false positives)\n- Cannot distinguish bot traffic from legitimate\n\n**Mitigation**: **Upstream, ISP level**\n- ISP level blocking (before reaching company)\n- DDoS mitigation service (Cloudflare, Akamai)\n- Rate limiting (slow down request rate)\n- Geographic filtering (block certain countries)\n- IDS/IPS not sufficient for DDoS (requires upstream defense)\n\n## PART 4: SIGNATURE-BASED DETECTION\n\n### Creating Detection Signatures\n\n**Format**: Pattern to match attack traffic\n\n**Example signature (SQL injection)**:\n```\nIf HTTP request contains 'UNION' OR 'SELECT' OR 'DROP' → ALERT\n```\n\n**Problem**: False positive example\n- Website help page: \"SQL SELECT statement returns rows\"\n- Contains keyword: \"SELECT\"\n- False alert: Signature triggers on help text\n- Not an attack\n\n**Solution**: More specific pattern\n- Check location: SQL keywords in POST data (form submission) not page text\n- Check context: Keywords must appear in suspicious patterns\n- Example: \"username field contains 'UNION SELECT' → SQL injection\" (more specific)\n\n**Example signature (Port scan)**:\n```\nIf SYN packets to 20+ different ports in 60 seconds → ALERT\n```\n\n**Threshold**: 20 ports in 60 seconds\n- Normal: Connection to web server (port 80) = 1 connection\n- Scan: Connections to ports 1-100 = 100 connections\n- Threshold identifies scan pattern\n\n**Tuning**: Increase to 50 if too many false positives\n- Initial threshold (20 ports): Too sensitive, many alerts\n- Increased threshold (50 ports): Fewer false positives, fewer alerts\n- Trade-off: Some scans missed (conservative approach)\n\n### Common Signatures for TechCorp\n\n**Signature 1: Brute force attack**\n```\nRule: \"If 10+ failed SSH logins from same IP in 5 minutes → BLOCK IP\"\n```\n- Detection: 10 failed SSH login attempts = pattern\n- Action: Block source IP for 30 minutes\n- User impact: Legitimate user temporarily blocked (acceptable)\n\n**Signature 2: SQL injection**\n```\nRule: \"If HTTP request contains SQL keywords in body → BLOCK\"\n```\n- Detection: SQL keywords in POST data\n- Action: Block HTTP request\n- User impact: Suspicious request blocked (good)\n\n**Signature 3: Port scan**\n```\nRule: \"If SYN packets to 30+ ports in 60 seconds → BLOCK IP\"\n```\n- Detection: Reconnaissance activity\n- Action: Block scanning IP\n- User impact: Attacker blocked (correct)\n\n**Signature 4: Known malware signature**\n```\nRule: \"If traffic matches known malware pattern → ALERT/BLOCK\"\n```\n- Detection: Traffic pattern matches known malware C2 communication\n- Action: Alert SOC and block\n- User impact: Malware communication blocked (protects network)\n\n**Signature 5: Data exfiltration**\n```\nRule: \"If large file transfer to external IP → ALERT\"\n```\n- Detection: 100+ MB transfer to unknown external IP\n- Action: Alert SOC (investigate before blocking)\n- User impact: SOC reviews (may be legitimate file sharing)\n\n## PART 5: ANOMALY-BASED DETECTION\n\n### Anomaly Detection Baseline\n\n**Baseline**: Normal traffic pattern\n\n**Measurement parameters**:\n- Volume: How much data?\n- Protocols: What types (TCP, UDP, ICMP)?\n- Ports: Which ports active?\n- Times: When is traffic active?\n- Users: Who is accessing?\n\n**Example**: Normal = 100 Mbps daytime, 10 Mbps night\n- Daytime (9-17): 100 Mbps (employees working)\n- Evening (17-21): 30 Mbps (some remote workers)\n- Night (21-9): 10 Mbps (maintenance, backups)\n\n**Anomaly**: Sudden 1 Gbps at 2 AM (unusual)\n- Expected: 10 Mbps\n- Actual: 1 Gbps\n- Deviation: 100x normal (clearly abnormal)\n\n**Detection**: IDS compares to baseline, alerts if unusual\n- Statistical analysis: Is current traffic within expected bounds?\n- Threshold: Alert if deviation > 50% (conservative) or > 200% (aggressive)\n\n**Tuning**: **How much deviation triggers alert?**\n- Conservative: Only alert if 10x normal (fewer false positives)\n- Aggressive: Alert if 2x normal (catches attacks early, more false positives)\n- Balance: 3-5x normal (reasonable threshold)\n\n**Problem 1**: Learning period required? **YES**\n- IDS must observe normal traffic for weeks/months\n- Builds baseline: What is \"normal\" for this network?\n- Without baseline: Cannot detect anomalies\n\n**Problem 2**: Legitimate changes trigger false positive? **YES**\n- Example: New application deployment (unusual traffic increase)\n- Example: Executive videoconference (unusual bandwidth)\n- Solution: Update baseline (acknowledge new normal)\n\n**Problem 3**: Adversary adaptation (attacker slowly increases traffic)? **YES**\n- Attacker gradually exfiltrates data (not sudden spike)\n- Fits within baseline (appears normal)\n- IDS doesn't alert (misses attack)\n- Mitigation: Combine with other detection methods\n\n### Behavioral Analysis\n\n**Monitors**: User behavior patterns\n\n**Example**: User normally accesses files 9-5 (daytime)\n- User pattern: Login at 8:30, logout at 17:00\n- File access: Normal work files\n- Sensitivity: Access to payroll, HR (unusual)\n\n**Anomaly**: User accessing files at 3 AM\n- Normal: 0 access at 3 AM\n- Anomaly: User logged in, accessing HR files\n- Alert: Unusual access pattern (possible account compromise)\n\n**Detection**: IDS/UEBA (User and Entity Behavior Analytics)\n- Tracks: User login times, files accessed, data downloads\n- Compares: To normal behavior\n- Alerts: On deviation (unusual activity)\n\n**Learning**: Requires **weeks/months of baseline**\n- System learns normal behavior over time\n- Multiple users = different patterns (manager vs engineer)\n- Seasonal variations (year-end financial activity vs normal)\n\n**Privacy**: Monitoring user activity continuously\n- Concerns: Privacy, surveillance\n- Mitigation: Anonymize where possible, justify monitoring\n- Legal: Some jurisdictions require employee notification\n\n## PART 6: IDS/IPS ALERT HANDLING\n\n### Alert Response Process\n\n**IDS generates alert**: \"SQL injection detected on web server\"\n\n**Alert includes**:\n- Timestamp: When attack occurred (exact time)\n- Source IP: Where attack came from (attacker IP)\n- Destination IP: What was attacked (victim server)\n- Payload: What was in the attack (malicious data)\n- Rule triggered: Which signature/anomaly matched\n- Confidence: How confident is detection? (80%, 95%)\n\n**Response timeline**:\n\n**Immediate (<1 second)**:\n- IPS: Block (automatic)\n- IDS: Log (passive)\n\n**Short-term (seconds)**:\n- Notify SOC (Security Operations Center)\n- Alert appears in dashboard\n- On-call security team notified\n\n**Medium-term (minutes/hours)**:\n- Investigate: What was attacked?\n- Analyze: Did attack succeed?\n- Contain: Stop attack spread\n\n**Long-term (days/weeks)**:\n- Remediate: Fix vulnerability\n- Patch: Update systems\n- Review: Prevent future attacks\n\n**Response process (5 phases)**:\n\n1. **Isolate**: **Separate compromised system from network**\n   - Disconnect device (physically or logically)\n   - Stop lateral movement\n   - Prevent data exfiltration\n\n2. **Analyze**: **Gather evidence**\n   - Collect logs\n   - Capture packets\n   - Preserve state (don't reboot)\n\n3. **Contain**: **Stop attack spread**\n   - Block attacker IP\n   - Revoke compromised credentials\n   - Patch vulnerability\n\n4. **Eradicate**: **Remove attacker**\n   - Remove malware\n   - Close backdoors\n   - Reset credentials\n\n5. **Recover**: **Restore services**\n   - Restore from backup (if needed)\n   - Reboot systems\n   - Resume operations\n\n### False Positive vs False Negative\n\n**False positive**: IDS alerts on **non-attack** (legitimate activity)\n- Example: SQL injection signature triggers on comment containing \"SELECT\"\n- User comment: \"The SELECT statement returns data\"\n- System alerts: \"SQL injection detected\"\n- Truth: Not an attack (just discussing SQL)\n\n**Cost**: SOC investigates for hours (wasted time, resources)\n\n**False negative**: IDS misses **actual attack** (attack not detected)\n- Example: New zero-day attack (no signature exists)\n- Attacker exploits unknown vulnerability\n- IDS silent: No alert (system doesn't know it's an attack)\n- Truth: Actual attack, but IDS missed it\n\n**Cost**: Attacker compromises system (severe, data breach, business impact)\n\n**Comparison**: Which is worse? **False negative** (missed attack)\n- **False positive**: Wasted time (SOC investigates, nothing wrong)\n- **False negative**: Security breach (system compromised, data stolen)\n- Analogy: Airport security\n  - False positive: Flag innocent traveler (inconvenient)\n  - False negative: Miss terrorist (dangerous)\n  - False negative much worse\n\n**Why**: \n- False positive: Recoverable (SOC investigates, finds nothing)\n- False negative: Unrecoverable (damage already done)\n\n**Trade-off**: Tune signatures aggressive (catch attacks) or conservative (avoid FP)?\n- **Aggressive**: Catch more attacks (better security) but more false positives (alert fatigue)\n- **Conservative**: Fewer false positives (less noise) but miss some attacks (worse security)\n- **Recommendation**: **Aggressive tuning** (catch attacks is more important)\n\n### Alert Tuning\n\n**Initial setup**: Alert on many patterns (high sensitivity)\n\n**Result**: Overwhelmed with alerts (alert fatigue)\n- 1000+ alerts per day\n- SOC team cannot review all\n\n**Problem**: SOC team ignores alerts (desensitization)\n- After 100 false positives, team stops taking alerts seriously\n- Security effectiveness drops\n\n**Solution**: Tune signatures **downward** (adjust thresholds)\n\n**Tuning example**:\n```\nSignature: \"Port scan = 20+ ports in 60 seconds\"\nDay 1: Too sensitive: 50 false positives per day\n  - Network admin testing\n  - Vulnerability scanner (legitimate)\n  - Admin tools\n\nAdjustment: Increase to 50 ports (reduce sensitivity)\n  - Fewer legitimate sources match\n  - More likely to be actual scan\n\nDay 5: Result: 5 true positives, 2 false positives per day\n  - Effective: Real scans detected\n  - Manageable: SOC can review alerts\n  - Trade-off: Some small scans missed (acceptable)\n```\n\n**Tuning goals**:\n- Reduce false positives (SOC can review all)\n- Detect real attacks (true positives captured)\n- Balance: Sensitivity vs manageability\n\n## PART 7: IDS/IPS DEPLOYMENT\n\n### Hybrid Deployment Strategy\n\n**TechCorp scenario**: Multiple locations\n- Headquarters (main office, high traffic, critical systems)\n- 50 branch offices (lower traffic, less critical)\n\n**Headquarters deployment**:\n\n**Deploy**: Inline IPS at edge (prevents attacks immediately)\n- Position: Internet → [IPS] → Internal network\n- Function: Block attacks automatically\n- Benefit: Real-time protection for main office\n\n**Deploy**: Out-of-band IDS internally (detects lateral movement)\n- Position: SPAN port on internal switches\n- Function: Detect compromised systems moving laterally\n- Benefit: Catches internal threats\n\n**Redundancy**: 2 IPS units (active-passive)\n- Primary IPS: Active (blocking traffic)\n- Backup IPS: Passive (standby)\n- Failover: If primary fails, backup activates\n- Goal: No single point of failure\n\n**Cost**: Highest security investment\n- Inline IPS: $50,000-100,000\n- Internal IDS: $20,000-30,000\n- Redundancy: +50% additional\n- Total: ~$150,000+ equipment\n\n**Branch offices deployment**:\n\n**Deploy**: **IDS only** (not IPS)\n- Why: Cost-benefit analysis\n  - Branch traffic: Lower volume (fewer attacks)\n  - IPS cost: ~$50,000 each\n  - Total for 50 branches: $2.5M (expensive)\n  - ROI: Low (branches have less sensitive data)\n- Alternative: IDS cheaper (~$5,000 per branch)\n  - Alerts SOC of attacks\n  - Headquarters can respond\n  - Cost: ~$250,000 (much cheaper)\n\n**Centralized monitoring**:\n- Branch IDS sends alerts to HQ\n- SIEM (central manager) receives all alerts\n- HQ SOC monitors all branches\n- Cost-effective: Central team handles all locations\n\n### Management and Correlation\n\n**Alert volume**:\n- HQ IPS: 100 alerts/day (inline blocks, fewer alerts)\n- HQ IDS: 200 alerts/day (internal monitoring)\n- 50 branches: 50 alerts each = 2,500 alerts/day\n- **Total**: ~2,800 alerts per day\n\n**Problem**: Cannot manually review all\n- 2,800 alerts/day = 116 alerts per hour\n- Impossible for SOC to review each\n- Many get ignored\n\n**Solution**: SIEM (Security Information and Event Management)\n\n**SIEM function**: **Centralize, correlate, detect patterns**\n- Centralizes: Collects all alerts in one place\n- Correlates: Finds related alerts\n- Patterns: Identifies attack sequences\n\n**Example**: \"SQL injection at 3 branch offices simultaneously = coordinated attack\"\n\n**Without SIEM**:\n- Branch A: \"SQL injection detected\" (isolated alert)\n- Branch B: \"SQL injection detected\" (isolated alert)\n- Branch C: \"SQL injection detected\" (isolated alert)\n- SOC view: 3 unrelated alerts\n- Conclusion: Uncoordinated, individual incidents\n\n**With SIEM**:\n- SIEM correlates: 3 SQL injection alerts at same time = coordinated\n- Pattern recognition: Same attack type, multiple locations, short timeframe\n- Conclusion: Organized attack, likely same attacker\n- Response: Escalate to incident response team\n\n**Benefits**:\n- Alert reduction: 2,800 → 100 important correlations (20x reduction)\n- Pattern detection: Coordinated attacks identified\n- Prioritization: Important alerts highlighted\n\n## PART 8: INCIDENT RESPONSE\n\n### Incident Timeline\n\n**Attack sequence**:\n\n**14:00**: Port scan detected\n- Activity: 50 connection attempts to different ports\n- Classification: Reconnaissance phase\n- Severity: Low (probing, not attacking yet)\n- Action: Log and monitor (no immediate threat)\n\n**14:15**: SQL injection attempt blocked\n- Activity: Malicious HTTP payload sent\n- Signature: SQL keywords in POST data\n- Classification: Attack attempt\n- Severity: Medium (blocked by IPS, no damage)\n- Action: Alert SOC (successful block, no action needed)\n- Lesson: IPS worked (blocked before reaching database)\n\n**14:30**: Brute force SSH detected\n- Activity: 50 failed SSH login attempts\n- Classification: Persistence attempt (trying to gain access)\n- Severity: High (likely to succeed if unblocked)\n- Action: Block source IP immediately (prevent account compromise)\n- Lesson: Same attacker continuing (port scan → SQL injection → SSH)\n\n**14:45**: Large data transfer to external IP detected\n- Activity: 5 GB transfer from internal server to unknown IP\n- Classification: Data exfiltration\n- Severity: Critical (data breach occurring)\n- Action: Emergency response\n  - **Isolate compromised system immediately** (disconnect from network)\n  - **Stop data transfer** (block outbound to external IP)\n  - **Investigate what data was transferred** (forensics)\n  - **Notify incident response team** (escalate to management)\n\n**Response actions by phase**:\n\n**14:00 Alert**: SOC reviews port scan\n- Investigation begins\n- Attacker identified by IP\n- Watch for further activity\n\n**14:15 Alert**: SQL injection blocked\n- No action needed\n- IPS stopped attack\n- Attack logged\n\n**14:30 Alert**: SSH brute force\n- Immediate response: Block IP\n- Investigation: Who owns compromised account?\n- Contain: Change account password\n\n**14:45 Alert**: Data exfiltration\n- Emergency response activated\n- Isolate server\n- Stop data transfer\n- Incident commander takes charge\n\n**Lessons**:\n- **Early detection** (port scan) enables proactive defense\n  - Attacker reconnaissance phase identified\n  - Allowed investigation to begin before attack\n- **IPS blocks attack** (SQL injection) without human intervention\n  - Attack stopped automatically\n  - Database never reached\n  - Defense in depth principle\n- **Quick response** (SSH brute force) limits damage\n  - IP blocked after first attempt\n  - Attacker cannot continue\n  - Prevents account compromise\n- **Detection enables forensics** (data exfiltration)\n  - IDS logs show attack sequence\n  - Forensic team has complete timeline\n  - Helps prevent future attacks\n\n### Forensics and Evidence Collection\n\n**After incident**: Need evidence for investigation\n\n**IDS/IPS provides**:\n- Logs: Complete timeline of attacks\n- Captured packets: Full content of attacks\n- Alert details: Signature matched, confidence level\n- Flow data: Source → destination traffic patterns\n\n**Chain of custody**: Maintain evidence integrity\n- Document: Who collected, when, how\n- Preserve: No modification, tampering\n- Verify: Hash values, integrity checks\n- Admissible: Evidence holds up in court\n\n**Investigation questions answered**:\n\n**What was attacked?** **Web portal server (10.0.1.5)**\n- IDS logs: Port 443 (HTTPS), HTTP traffic\n- Evidence: SQL injection attempt on /login.php\n- Impact: Database potentially accessed\n\n**Who attacked?** **IP 203.0.113.50, geographic location Malaysia**\n- Evidence: Source IP in logs\n- Geo-location: From threat intelligence\n- Attribution: Likely nation-state or criminal group\n- Caveat: IP could be compromised proxy (attribution complex)\n\n**How long was attacker present?** **45 minutes (14:00-14:45)**\n- Timeline: Port scan at 14:00, data exfiltration ends 14:45\n- Duration: Short (well-organized attack)\n- Implication: Attacker knew target well (planned)\n\n**What data was accessed?** **Customer database table with PII**\n- Investigation: Review database logs\n- Access: Queries between 14:15-14:30 (after successful SQL injection)\n- Data: Customer names, addresses, phone numbers\n- Compliance: GDPR affected (EU customer data)\n\n**What data was stolen?** **Estimated 50,000 customer records**\n- Investigation: Review data transfer logs\n- Volume: 5 GB transferred\n- Content: Average record size 100 KB × 50,000 = 5 GB (matches)\n- Severity: Major data breach (regulatory notification required)\n\n## PART 9: IDS/IPS CHALLENGES\n\n### Encrypted Traffic Problem\n\n**Modern traffic**: HTTPS (encrypted)\n- Most traffic now encrypted (security best practice)\n- TLS 1.3 standard (strong encryption)\n\n**IDS sees**: Ciphertext (unreadable)\n- IDS receives encrypted packet\n- Content: Looks like random data\n- Cannot inspect: What is inside HTTPS?\n\n**Cannot inspect**: What is in HTTPS payload?\n- Malware could hide in HTTPS\n- SQL injection in HTTPS not visible\n- Command/control communication encrypted\n- IDS blind to threats in encrypted traffic\n\n**Solution 1**: SSL/TLS decryption (proxy decrypts then inspects)\n- Proxy (IPS) acts as man-in-the-middle\n- Client connects to proxy (encrypted)\n- Proxy decrypts: \"Bob is logging in\"\n- Proxy inspects: Check for SQL injection in login\n- Proxy re-encrypts: Forward to server\n- Result: IPS sees plaintext\n- **Risk**: Performance impact (CPU-intensive)\n- **Risk**: Privacy concerns (all HTTPS visible)\n- **Issue**: Certificate validation (client trusts proxy cert?)\n\n**Solution 2**: Only inspect unencrypted traffic (less coverage)\n- Allow HTTPS to pass (cannot inspect)\n- Inspect HTTP only\n- **Problem**: Most traffic now HTTPS (misses most threats)\n- **Coverage**: Very limited\n\n**Solution 3**: Hybrid approach\n- Decrypt only suspicious connections (risk-based)\n- Whitelist trusted sites (don't decrypt)\n- Aggressive threshold: Decrypt many connections\n- Conservative threshold: Decrypt few connections\n- **Balance**: Security vs performance/privacy\n\n**Recommendation**: **Selective decryption**\n- Decrypt: Unusual traffic patterns, suspicious sources\n- Whitelist: Google, Microsoft, trusted vendors (don't decrypt)\n- Performance: Reduced decryption overhead\n- Privacy: Most traffic passes encrypted\n- Security: Threats in suspicious traffic caught\n\n### Tuning and Maintenance\n\n**New signatures released regularly**\n- New attacks discovered weekly\n- Vendors (Snort, Suricata) release updates\n- Vendors: Weekly or monthly update cycle\n\n**Maintenance required**: Update signatures weekly/monthly\n- Download new signatures\n- Deploy to IDS/IPS\n- Test: Verify no issues\n- Enable: Activate new signatures\n- Cost: Ongoing effort\n\n**Skipped updates**: Missing coverage for recent attacks\n- Example: New ransomware signature released\n- Organization hasn't updated\n- Ransomware hits network (no signature, no detection)\n- Damage: Files encrypted, business disrupted\n- Mitigation: Automatic updates recommended\n\n**Aggressive tuning**: High false positives (alert fatigue)\n- Many signatures enabled\n- Sensitive thresholds\n- Result: 10,000+ alerts per day\n- SOC overwhelmed: Most alerts ignored\n\n**Conservative tuning**: Missing some attacks (false negatives)\n- Few signatures enabled\n- High thresholds\n- Result: 10 alerts per day\n- Coverage: Very limited (many attacks missed)\n- Security: Compromised\n\n**Best practice**: **Balance and monitoring**\n- Tune: 100-300 alerts per day (manageable)\n- Monitor: False positive ratio\n- Metrics: Track effectiveness\n- Review: Regular tuning meetings\n\n**Metrics to track**:\n\n**Detection rate**: What % of attacks caught?\n- Goal: 90%+ (catch most attacks)\n- Measurement: Compare to threat intelligence\n- Improvement: Add signatures, lower thresholds\n\n**False positive rate**: How many false alerts?\n- Goal: <5% of total alerts\n- Measurement: Manual review of alerts\n- Reduction: Tune signatures, whitelist legitimate sources\n\n**Mean time to detect (MTTD)**: How fast detected?\n- Goal: <1 minute\n- Measurement: Timestamp comparison\n- Improvement: Optimize detection engine\n\n**Mean time to respond (MTTR)**: How fast responded?\n- Goal: <15 minutes\n- Measurement: From alert to action\n- Improvement: Automation, SOC training, runbooks",
  "hints": [
    "IDS detects attacks but cannot prevent; IPS detects AND blocks automatically",
    "Inline IPS blocks attacks in real-time but creates single point of failure",
    "Signature-based detection: known attacks, fast but misses zero-days",
    "Anomaly-based detection: catches unknown attacks, high false positives",
    "False negatives (missed attacks) worse than false positives (false alarms)",
    "Port scan often first phase of attack; early detection enables proactive defense",
    "SQL injection can be blocked at network layer (IPS) before reaching database",
    "DDoS requires upstream mitigation (ISP level), not just IPS",
    "SIEM correlates alerts from multiple sources to detect coordinated attacks",
    "Encrypted traffic (HTTPS) limits IDS visibility; selective decryption can help"
  ],
  "testCases": [
    {"id": "tc1-ids-ips-difference", "description": "IDS vs IPS distinction", "input": "Detection and prevention", "expected": "IDS detects only, IPS blocks", "assert": "assert ('detect' in solution.lower() and 'ips' in solution.lower()) or ('prevent' in solution.lower() and 'block' in solution.lower())"},
    {"id": "tc2-signature-based", "description": "Signature-based detection", "input": "Known attack patterns", "expected": "Matches known signatures, misses zero-day", "assert": "assert ('signature' in solution.lower() or 'pattern' in solution.lower()) and ('known' in solution.lower() or 'zero' in solution.lower())"},
    {"id": "tc3-anomaly-detection", "description": "Anomaly-based detection", "input": "Unusual behavior patterns", "expected": "Baseline comparison, detects unknown attacks", "assert": "assert ('anomaly' in solution.lower() or 'baseline' in solution.lower() or 'unusual' in solution.lower())"},
    {"id": "tc4-placement", "description": "IDS/IPS deployment", "input": "Inline vs out-of-band", "expected": "Inline blocks, out-of-band monitors", "assert": "assert ('inline' in solution.lower() or 'placement' in solution.lower()) and ('block' in solution.lower() or 'monitor' in solution.lower())"},
    {"id": "tc5-false-positive", "description": "Alert types", "input": "False positive vs false negative", "expected": "False negative worse (missed attack)", "assert": "assert ('false' in solution.lower()) and ('positive' in solution.lower() or 'negative' in solution.lower())"},
    {"id": "tc6-attack-detection", "description": "Attack recognition", "input": "Port scan, brute force, SQL injection", "expected": "Different signatures for each attack", "assert": "assert ('port' in solution.lower() or 'brute' in solution.lower() or 'sql' in solution.lower())"},
    {"id": "tc7-response", "description": "Incident response", "input": "Attack timeline and actions", "expected": "Immediate block, investigation, containment", "assert": "assert ('block' in solution.lower() or 'response' in solution.lower() or 'incident' in solution.lower())"},
    {"id": "tc8-encryption", "description": "Encrypted traffic handling", "input": "HTTPS inspection", "expected": "Decryption needed for inspection", "assert": "assert ('encrypt' in solution.lower() or 'https' in solution.lower() or 'traffic' in solution.lower())"},
    {"id": "tc9-siem", "description": "Alert correlation", "input": "Centralized monitoring", "expected": "SIEM correlates alerts, detects patterns", "assert": "assert ('siem' in solution.lower() or 'correlat' in solution.lower() or 'central' in solution.lower())"},
    {"id": "tc10-tuning", "description": "Signature tuning", "input": "Sensitivity adjustment", "expected": "Balance false positives and false negatives", "assert": "assert ('tun' in solution.lower() or 'threshold' in solution.lower() or ('false' in solution.lower() and 'balance' in solution.lower()))"}
  ]
}
