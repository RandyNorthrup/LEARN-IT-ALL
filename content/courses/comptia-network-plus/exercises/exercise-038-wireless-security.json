{
  "id": "exercise-038-wireless-security",
  "lessonId": "lesson-038-wireless-security",
  "title": "Wireless Network Security and Authentication",
  "description": "Secure wireless networks against attacks. Compare wireless security standards (WEP, WPA, WPA2, WPA3), implement strong authentication, detect rogue access points, and respond to wireless threats.",
  "difficulty": "intermediate",
  "points": 100,
  "language": "text",
  "starterCode": "# WIRELESS SECURITY EXERCISE\n# Secure WiFi networks and prevent wireless attacks\n\n## SCENARIO: RetailChain WiFi security crisis\n## - 500 stores nationwide with public WiFi\n## - Headquarters: Secure wireless for employees\n## - Point-of-Sale (POS) systems: Connected wirelessly (payment processing)\n## - Guest WiFi: Public internet access\n## - Current state: WPA2 PSK (no per-user authentication)\n## - Incidents: Rogue AP in stores, data interception, compromised POS\n\n## PART 1: WIRELESS FUNDAMENTALS\n## Q1: Wireless security challenges:\n##     - Physical medium: Radio waves are _______ (broadcast)\n##     - Coverage: Outside building walls (physical access not needed)\n##     - Interception: Attacker in parking lot can capture traffic\n##     - Challenge: Encrypt all traffic (encryption mandatory)\n##     - Authentication: Need to verify _______\n##\n## Q2: Wireless attack types:\n##     - Passive attack: Attacker _______ (sniffs traffic, no interaction)\n##     - Active attack: Attacker _______ (injects frames, disrupts)\n##     - Rogue AP: Attacker creates fake WiFi network\n##     - Man-in-the-middle: Attacker between client and AP\n##     - Deauthentication: Attacker sends disconnect frames\n\n## PART 2: WIRELESS STANDARDS EVOLUTION\n## Q3: WEP (Wired Equivalent Privacy):\n##     - Year: 1997 (very old)\n##     - Encryption: RC4 (weak cipher)\n##     - Key length: 40-bit or 104-bit\n##     - Authentication: Open system or shared key (weak)\n##     - Status: _______ (should never be used)\n##     - Vulnerability: IV collision (weak key scheduling)\n##     - Time to break: _______ (minutes with tools)\n##\n## Q4: WPA (WiFi Protected Access):\n##     - Year: 2003 (interim solution)\n##     - Improvement over WEP: TKIP (Temporal Key Integrity Protocol)\n##     - TKIP: Changes encryption key per _______ (per packet)\n##     - Authentication: Pre-shared key (PSK) or 802.1X\n##     - Status: Deprecated (replaced by WPA2)\n##     - Vulnerability: TKIP can be cracked (not as weak as WEP)\n##     - Better than WEP but not secure for new networks\n\n## Q5: WPA2 (802.11i):\n##     - Year: 2004 (current standard)\n##     - Encryption: AES-CCMP (strong cipher)\n##     - Authentication: PSK (personal) or 802.1X (enterprise)\n##     - WPA2-PSK: _______ (for home/small business)\n##     - WPA2-Enterprise: _______ (for corporate, uses RADIUS)\n##     - Status: Secure (still acceptable, though WPA3 preferred)\n##     - Advantage over WPA: Stronger encryption (AES vs TKIP)\n##\n## Q6: WPA3 (802.11ax):\n##     - Year: 2018 (latest standard)\n##     - Encryption: AES-GCMP-256 (128-bit or 256-bit keys)\n##     - Authentication: Simultaneous Authentication of Equals (SAE)\n##     - SAE: Replaces PSK with better key agreement\n##     - Improvement: Resistant to brute-force and KRACK attacks\n##     - Individual Data Encryption (OWE): Guest network encryption\n##     - Status: Most secure (recommended for new deployments)\n##     - Adoption: Slow (not all devices support)\n\n## Q7: Comparing wireless standards:\n##     Complete table:\n##     \n##     | Feature | WEP | WPA | WPA2 | WPA3 |\n##     |---------|-----|-----|------|------|\n##     | Encryption | RC4 | TKIP | AES | ? |\n##     | Key length | 40-104 bit | ? | 128-256 bit | ? |\n##     | Security | BROKEN | Weak | GOOD | BEST |\n##     | Brute-force resistant | NO | NO | YES | YES+ |\n##     | Backwards compatible | N/A | With WEP | With WPA | No |\n\n## PART 3: PSK VS ENTERPRISE AUTHENTICATION\n## Q8: Pre-Shared Key (PSK) authentication:\n##     - Setup: Everyone shares same password (like WiFi password)\n##     - Security: If 1 person leaves, must change password _______ (for all)\n##     - Example: 100 employees know password \"Welcome123\"\n##     - Problem: Disgruntled employee leaves, still has password\n##     - Solution: Change password (inconvenient, tell 100 people)\n##     - Shared key: All users and APs use same key (no unique identity)\n##     - Limitation: Cannot track individual user\n\n## Q9: 802.1X (Enterprise) authentication:\n##     - Setup: Each user has unique username/password\n##     - Authentication: RADIUS server authenticates each user\n##     - Process:\n##       1. Client connects to AP\n##       2. AP acts as proxy (doesn't authenticate directly)\n##       3. Client sends credentials to RADIUS server\n##       4. RADIUS server verifies (database lookup)\n##       5. RADIUS grants or denies access\n##       6. AP allows or blocks client\n##     - Benefit: Individual authentication (track who used network)\n##     - Benefit: User leaves, revoke single account (not re-do all)\n##     - Cost: Requires RADIUS server infrastructure\n##\n## Q10: PSK vs 802.1X decision:\n##      - Home network: _______ (PSK, simple)\n##      - Small office (20 people): _______ (PSK or 802.1X)\n##      - Corporate (5000 people): _______ (802.1X, centralized)\n##      - Retail stores (public WiFi): _______ (Open with encryption, or 802.1X for employee WiFi)\n##      - Temporary network (1 day): _______ (PSK, easy setup)\n\n## PART 4: WIRELESS ATTACKS AND DEFENSES\n## Q11: Rogue access point (Evil Twin):\n##      - What: Attacker creates fake WiFi network\n##      - Name: Often matches legitimate network (\"Starbucks\", \"Airport WiFi\")\n##      - Goal: _______ (intercept traffic from users)\n##      - Users connect: Thinking legitimate, actually attacker\n##      - Traffic: All internet traffic flows through attacker\n##      - Data captured: Passwords, emails, banking credentials\n##      - Detection: _______ (multiple APs with same name)\n##      - Defense: _______ (warn users, disable weak APs)\n\n## Q12: Deauthentication attack:\n##      - What: Attacker sends disconnect frames\n##      - Frame: 802.11 deauthentication frame (standard wireless frame)\n##      - Effect: Client disconnects from legitimate AP\n##      - Why: _______ (to force reconnection to rogue AP)\n##      - Vulnerable clients: _______ (any device, no auth on deauth frames)\n##      - Prevention: _______ (802.11w - protected management frames)\n##      - WPA3 benefit: _______ (requires protected frames)\n\n## Q13: Key recovery attacks:\n##      - WEP: IV collision attacks (break encryption in minutes)\n##      - WPA: TKIP weaknesses (can recover keys in hours)\n##      - WPA2: KRACK (Key Reinstallation Attack)\n##        * Vulnerability: Key reinstallation in 4-way handshake\n##        * Result: Can force key reuse (weaken encryption)\n##        * Fix: Patch AP and clients\n##      - WPA3: Resistant to KRACK and similar attacks\n##      - Lesson: New standards fix discovered vulnerabilities\n\n## PART 5: RETAIL CHAIN WIRELESS DESIGN\n## Q14: RetailChain POS network:\n##      Payment processing must be _______ (encrypted)\n##      Compliance: PCI DSS requires wireless encryption\n##      \n##      Network design:\n##      - Guest WiFi: Public internet access\n##      - Employee WiFi: Internal tools, inventory\n##      - POS WiFi: Credit card processing (most secure)\n##      \n##      Q14a: Guest WiFi security:\n##      - Standard: WPA2 with _______ (shared password)\n##      - Or: WPA3-Personal with _______ (stronger encryption)\n##      - Recommendation: WPA2 or WPA3 (both acceptable for guest)\n##      - Risk: Guest network isolated from _______ (employee and POS)\n##      - VLAN: Separate network (guests cannot see employee data)\n##\n##      Q14b: Employee WiFi security:\n##      - Standard: WPA2-Enterprise with _______ (802.1X, RADIUS)\n##      - Or: WPA3-Enterprise (more secure)\n##      - Benefit: Individual authentication (not shared password)\n##      - Coverage: All stores (500 locations)\n##      - Centralized: RADIUS server at headquarters\n##      - Scalability: Can manage thousands of users\n##\n##      Q14c: POS WiFi security:\n##      - Most critical (payment data)\n##      - Standard: WPA2-Enterprise _______ (maximum encryption)\n##      - Or: WPA3-Enterprise (best)\n##      - Encryption: AES-CCMP (WPA2) or AES-GCMP-256 (WPA3)\n##      - Recommendation: WPA3 if possible, WPA2 minimum\n##      - Isolation: Separate network (air-gapped from guests)\n##      - Monitoring: _______ (detect rogue APs, unauthorized devices)\n\n## PART 6: ROGUE AP DETECTION\n## Q15: Detecting rogue access points:\n##      - Method 1: _______ (passive scanning)\n##        * Tool: WiFi analyzer app (passive)\n##        * Measure: Signal strength, location\n##        * Find: Unknown APs in area\n##      \n##      - Method 2: _______ (active testing)\n##        * Tool: Wireless penetration testing\n##        * Look: For evil twin APs\n##        * Test: Connect and check server identity\n##      \n##      - Method 3: _______ (monitoring)\n##        * Tool: Wireless IDS (like IDS for WiFi)\n##        * Monitor: Deauthentication attacks\n##        * Alert: On suspicious activity\n##      \n##      - Method 4: Certificate pinning\n##        * Clients verify: Server certificate (not forged)\n##        * Defense: Against rogue AP intercepting HTTPS\n##\n## Q16: Preventing rogue AP connections:\n##      - User education: _______ (never auto-connect, verify network)\n##      - Disable auto-connect: Turn off for open networks\n##      - Hide SSID: _______ (makes AP harder to find? Not really)\n##      - MAC filtering: _______ (whitelist known MAC addresses)\n##      - WPA2-Enterprise: Forces _______ (authentication, harder to spoof)\n##      - Certificate validation: _______ (client verifies server)\n\n## PART 7: WIRELESS INCIDENT RESPONSE\n## Q17: Rogue AP detected in store:\n##      - Incident: Wireless IDS detects unauthorized AP\n##      - SSID: \"RetailChain\" (identical to legitimate network)\n##      - Signal: Stronger than legitimate AP in that area\n##      - Location: Parking lot (unusual)\n##      - Response:\n##        1. Capture: _______ (MAC address, channel, signal strength)\n##        2. Isolate: _______ (block AP from network)\n##        3. Investigate: _______ (where did it come from?)\n##        4. Remediate: _______ (remove rogue AP)\n##        5. Review: _______ (patch vulnerability that allowed it)\n##        6. Communicate: _______ (alert other stores)\n\n## Q18: Deauthentication attack detected:\n##      - Incident: IDS detects 50 deauth frames in 1 minute\n##      - Pattern: All from same source MAC address\n##      - Result: 100 customers kicked off guest WiFi\n##      - Customer impact: WiFi disruption, poor experience\n##      - Response:\n##        1. Block: _______ (MAC address of attacker)\n##        2. Verify: Is WPA3 enabled? If not, vulnerable\n##        3. Update: Deploy 802.11w (protected management frames)\n##        4. Monitor: Watch for repeat attacks\n##        5. Response: _______ (restore connectivity)\n\n## PART 8: WIRELESS ENCRYPTION AND PERFORMANCE\n## Q19: Encryption overhead:\n##      - Unencrypted WiFi: 150 Mbps theoretical (802.11ac)\n##      - WPA2 encryption: ~130 Mbps (13% overhead)\n##      - WPA3 encryption: ~120 Mbps (20% overhead, stronger cipher)\n##      - Trade-off: _______ vs security\n##      - Recommendation: Accept overhead for security\n##\n## Q20: Legacy device compatibility:\n##      - Scenario: Old printer only supports WEP\n##      - Problem: WEP is broken, cannot use\n##      - Options:\n##        1. Use WPA2 (printer won't connect)\n##        2. Use WEP anyway (security risk)\n##        3. Replace printer (expensive)\n##        4. Isolate on separate AP (backup solution)\n##      - Best: Option 3 (replace) or Option 4 (isolate)\n##      - Lesson: Planning for legacy device phase-out\n\n## PART 9: WIRELESS SECURITY BEST PRACTICES\n## Q21: RetailChain wireless security roadmap:\n##      - Current state: WPA2 PSK (all locations)\n##      - Phase 1 (Months 1-3): _______ (upgrade to WPA2-Enterprise)\n##        * Deploy RADIUS servers (HQ + backup)\n##        * Rollout at stores (10 per week, 50 weeks)\n##        * Training: Store staff on new network\n##      \n##      - Phase 2 (Months 4-6): _______ (add wireless IDS)\n##        * Detect rogue APs\n##        * Monitor deauth attacks\n##        * Alert on suspicious activity\n##      \n##      - Phase 3 (Year 2): _______ (upgrade to WPA3 when available)\n##        * Stronger encryption\n##        * Better protection against attacks\n##        * Upgrade APs and clients\n##      \n##      - Timeline: _______ (how long total?)\n##      - Cost: $_______ (estimate)\n\n## Q22: Wireless security checklist:\n##      - [ ] WPA2 minimum (no WEP or WPA)\n##      - [ ] Strong password or enterprise auth (not default)\n##      - [ ] Encryption enabled (AES-CCMP at minimum)\n##      - [ ] Guest network isolated from employee\n##      - [ ] SSID broadcast disabled (optional, adds little)\n##      - [ ] MAC filtering configured (optional, limited value)\n##      - [ ] Firmware updated on APs (patch vulnerabilities)\n##      - [ ] 802.11w enabled (protected management frames)\n##      - [ ] Monitoring enabled (detect rogue APs)\n##      - [ ] Incident response plan documented\n##      - [ ] User training provided (phishing awareness)\n##      - [ ] Regular audits (quarterly)\n##      - [ ] WPA3 roadmap planned (future upgrade)",
  "solution": "# WIRELESS SECURITY SOLUTION\n\n## PART 1: WIRELESS FUNDAMENTALS\n\n### Wireless Security Challenges\n\n**Physical medium**: Radio waves are **BROADCAST** (sent through air to all receivers)\n- Wired network: Traffic in cables (physically secure)\n- Wireless: Traffic in air (anyone in range can intercept)\n\n**Coverage**: Outside building walls (physical access not needed)\n- Attacker: Can be in parking lot, building next door\n- Interception: Possible from distance (depends on power)\n\n**Interception**: Attacker in parking lot can capture traffic\n- No network access needed\n- No login required\n- Passive listening (no detection)\n\n**Challenge**: Encrypt all traffic (encryption mandatory)\n- Unlike wired: Cannot rely on physical security\n- All wireless traffic must be encrypted\n- Strong encryption required (modern standards)\n\n**Authentication**: Need to verify **AP identity** (is this legitimate network?)\n- Plus: Client identity (is this authorized user?)\n\n### Wireless Attack Types\n\n**Passive attack**: Attacker **SNIFFS traffic** (captures without interacting)\n- No detection: No network disruption\n- Data gathered: Passwords, emails, credentials\n- Defense: Strong encryption\n\n**Active attack**: Attacker **INJECTS frames or DISRUPTS** (modifies/interferes)\n- Deauthentication: Disconnect clients\n- Rogue AP: Create fake network\n- Jamming: Interfere with signal\n\n**Rogue AP**: Attacker creates fake WiFi network\n- Name: Often matches legitimate (\"Starbucks\", \"AirportWiFi\")\n- Users connect: Thinking legitimate, actually attacker\n- Man-in-the-middle: All traffic flows through attacker\n\n## PART 2: WIRELESS STANDARDS EVOLUTION\n\n### WEP (Wired Equivalent Privacy)\n\n**Year**: 1997 (very old, original WiFi security)\n\n**Encryption**: RC4 (weak cipher, not recommended for any new use)\n\n**Key length**: 40-bit or 104-bit (too short)\n\n**Authentication**: Open system or shared key (both weak)\n\n**Status**: **COMPLETELY BROKEN** (never use)\n\n**Vulnerability**: IV collision attacks (Initialization Vector reuse)\n- Weak key scheduling: RC4 implementation flawed\n- Attack: Analyze captured frames, recover key\n\n**Time to break**: **MINUTES** (with tools like aircrack-ng)\n- Can capture 10,000 frames\n- Run attack algorithm\n- Key recovered in 2-5 minutes\n- Completely impractical as security\n\n### WPA (WiFi Protected Access)\n\n**Year**: 2003 (interim solution, improving on WEP)\n\n**Improvement**: TKIP (Temporal Key Integrity Protocol)\n- Changes encryption key per **PACKET** (not static)\n- Each packet: Different key (prevents key reuse)\n- Better than WEP (which uses same key)\n\n**Authentication**: \n- PSK: Pre-shared key (everyone knows password)\n- 802.1X: Individual authentication via RADIUS\n\n**Status**: Deprecated (still works, but superseded by WPA2)\n\n**Vulnerability**: TKIP can be cracked (not as weak as WEP)\n- Weaker than WPA2 (AES encryption)\n- Can be broken in hours (not minutes like WEP)\n\n**Assessment**: Better than WEP but not secure for new networks\n- Legacy support only\n- Upgrade to WPA2 or WPA3 recommended\n\n### WPA2 (802.11i Standard)\n\n**Year**: 2004 (current standard, widely deployed)\n\n**Encryption**: AES-CCMP (strong cipher)\n- AES: Advanced Encryption Standard (US government approved)\n- CCMP: Counter Mode with CBC-MAC Protocol\n- 128-bit key default\n\n**Authentication**:\n- **WPA2-PSK**: Personal (home/small office)\n  - Everyone shares password\n  - Called PSK mode\n- **WPA2-Enterprise**: Corporate/institutional\n  - Individual username/password\n  - RADIUS server backend\n\n**Status**: Secure (still acceptable standard)\n\n**Advantage over WPA**: \n- Stronger encryption: AES vs TKIP\n- More resistant to attacks\n- No known practical attacks on WPA2-AES\n\n### WPA3 (802.11ax - Latest Standard)\n\n**Year**: 2018 (newest standard)\n\n**Encryption**: AES-GCMP-256 (Galois/Counter Mode)\n- 128-bit or 256-bit keys\n- Stronger than WPA2\n- Resistant to certain attacks\n\n**Authentication**: Simultaneous Authentication of Equals (SAE)\n- Replaces PSK (Pre-Shared Key)\n- Better key agreement protocol\n- Resistant to brute-force attacks\n\n**Improvement**: Resistant to brute-force and KRACK attacks\n- KRACK: Key Reinstallation Attack (WPA2 vulnerability)\n- WPA3: Cannot be exploited by KRACK\n- Brute-force: Much harder with SAE\n\n**Individual Data Encryption (OWE)**: Guest network encryption\n- Guest networks: Encrypted per-device\n- Each guest: Different encryption key\n- Prevents guest seeing other guest traffic\n\n**Status**: Most secure (recommended for new deployments)\n\n**Adoption**: Slow (not all devices support yet)\n- APs: Gradually available\n- Clients: Older devices don't support\n- Timeline: 5+ years for widespread adoption\n\n### Comparing Wireless Standards\n\n**Comparison table**:\n\n| Feature | WEP | WPA | WPA2 | WPA3 |\n|---------|-----|-----|------|------|\n| Encryption | RC4 (broken) | TKIP | AES-CCMP | AES-GCMP-256 |\n| Key length | 40-104 bit | Dynamic | 128-256 bit | 128-256 bit |\n| Security | BROKEN | Weak | GOOD | BEST |\n| Brute-force resistant | NO | Weak | YES | YES (much better) |\n| KRACK resistant | N/A | NO | Needs patch | YES |\n| Backwards compatible | N/A | With WEP | With WPA | No (new devices) |\n| Recommended | NEVER | Legacy only | YES | YES (preferred) |\n| Time to break | Minutes | Hours | Unknown (strong) | Unknown (stronger) |\n\n## PART 3: PSK VS ENTERPRISE AUTHENTICATION\n\n### Pre-Shared Key (PSK) Authentication\n\n**Setup**: Everyone shares same password\n- Like WiFi password: \"Welcome123\"\n- Everyone knows it (written on wall, email, etc)\n- Used by all devices\n\n**Security issue**: If 1 person leaves, must change password **FOR EVERYONE**\n- 100 employees know password\n- Employee leaves (disgruntled, moving to competitor)\n- Still has password (can access network)\n- Solution: Change password for all 100 (inconvenient, tell everyone)\n\n**Shared key**: All users and APs use same key\n- No unique identity per user\n- Cannot distinguish user1 from user2\n- All traffic encrypted with same key\n\n**Limitation**: Cannot track individual user\n- Logs show: \"Someone on network\" (not who)\n- Accountability: Missing (anyone could do anything)\n\n**Use case**: Home networks, small offices, temporary networks\n\n### 802.1X (Enterprise) Authentication\n\n**Setup**: Each user has unique username/password\n- Centralized database (Active Directory, RADIUS)\n- Not shared\n- Individual credentials\n\n**Authentication process**:\n1. Client connects to AP\n2. AP acts as proxy (passes through, doesn't authenticate)\n3. Client sends credentials to RADIUS server\n4. RADIUS server verifies (database lookup)\n5. RADIUS responds: Grant or Deny\n6. AP allows or blocks client\n\n**Benefit**: Individual authentication (track who used network)\n- Logs show: \"User john logged in at 10:00 AM\"\n- Accountability: Know who did what\n- Audit trail: Complete and traceable\n\n**Benefit**: User leaves, revoke single account (not re-do all)\n- Employee fired\n- IT: Disables one account (no longer valid)\n- Network: Automatically denies next login\n- Simple: No password change for others\n\n**Cost**: Requires RADIUS server infrastructure\n- Dedicated server: $3,000-5,000\n- Maintenance: Annual support\n- Complexity: More setup than PSK\n\n### PSK vs 802.1X Decision\n\n**Home network**: **PSK** (Pre-Shared Key)\n- Simplicity: Just password\n- Cost: Free\n- Use: Home users\n\n**Small office (20 people)**: **PSK or 802.1X**\n- PSK: Easier, suitable if turnover low\n- 802.1X: Better if employees change frequently\n- Recommendation: PSK acceptable at this scale\n\n**Corporate (5000 people)**: **802.1X** (Enterprise)\n- Why: Centralized management needed\n- Why: Accountability required (compliance)\n- Why: Employee turnover (frequent)\n- Recommendation: Must use 802.1X\n\n**Retail stores (public WiFi)**: **Open network with encryption** (or 802.1X for employee)\n- Guest WiFi: Open (no password) + encryption (WPA2/3)\n- Employee WiFi: WPA2/3-Enterprise (802.1X)\n- Recommendation: Separate networks\n\n**Temporary network (1 day)**: **PSK** (Pre-Shared Key)\n- Setup: Quick (password only)\n- Teardown: Just stop AP\n- Use: Event, conference, temporary access\n\n## PART 4: WIRELESS ATTACKS AND DEFENSES\n\n### Rogue Access Point (Evil Twin)\n\n**What**: Attacker creates fake WiFi network\n\n**Name**: Often matches legitimate network\n- \"Starbucks\" (actual Starbucks WiFi)\n- \"Airport WiFi\" (actual airport network)\n- \"RetailChain Guest\" (actual retail network)\n\n**Goal**: **INTERCEPT TRAFFIC** (capture credentials, data)\n- Users connect thinking legitimate\n- Actually connecting to attacker\n- All traffic flows through attacker device\n\n**Users connect**: Thinking legitimate, actually attacker\n- User sees: \"RetailChain Guest\" (looks real)\n- User connects: No suspicion\n- User unknowingly connected to attacker\n\n**Traffic captured**:\n- Unencrypted: All plaintext (passwords, emails)\n- Encrypted HTTPS: Cannot read (but see metadata)\n- WiFi password: Captured (for network access)\n\n**Data captured**: Passwords, emails, banking credentials\n- Email account credentials (from email client)\n- Banking: HTTP (if not HTTPS)\n- Social media: Logins\n- Work accounts: VPN credentials\n\n**Detection**: **Multiple APs with same name**\n- Legitimate: 1-2 APs with \"RetailChain Guest\"\n- Attack: 5 APs with \"RetailChain Guest\" (different MAC addresses)\n- Tool: WiFi analyzer app (shows all networks)\n- Signal: Rogue often stronger (attacker very close)\n\n**Defense**: \n- **Warn users**: Only connect to known networks\n- **Disable weak APs**: Remove old APs (easier to spoof)\n- **Use HTTPS**: Encrypt traffic (attacker sees only ciphertext)\n- **Monitor**: Wireless IDS detects rogue APs\n- **Client validation**: Certificate pinning\n\n### Deauthentication Attack\n\n**What**: Attacker sends disconnect frames\n\n**Frame**: 802.11 deauthentication frame\n- Standard wireless frame (normal disconnect)\n- Sent when AP wants to disconnect client\n- Attacker spoofs AP identity\n- Sends fake deauth frames\n\n**Effect**: Client disconnects from legitimate AP\n- Client sees: \"Lost connection to WiFi\"\n- Client auto-reconnects\n- Attacker captures reconnection handshake\n\n**Why**: **FORCE RECONNECTION** to rogue AP\n- Client disconnected from legitimate\n- Client reconnects (auto-reconnect enabled)\n- Connects to attacker's rogue AP (stronger signal)\n- Attack succeeds\n\n**Vulnerable clients**: **ALL devices** (no authentication on management frames)\n- Desktop: Vulnerable\n- Laptop: Vulnerable\n- Phone: Vulnerable\n- Anything with WiFi: Affected\n- No device immune (design flaw)\n\n**Prevention**: **802.11w** (protected management frames)\n- Management frames: Encrypted and authenticated\n- Deauth frames: Signed (cannot be forged)\n- Attacker cannot send fake deauth\n- Blocks attack\n\n**WPA3 benefit**: **Requires protected frames** (mandatory)\n- WPA2: Optional (many don't enable)\n- WPA3: Built-in (always on)\n- Better protection (cannot opt out)\n\n### Key Recovery Attacks\n\n**WEP**: IV collision attacks\n- Break encryption: Minutes (practical attack)\n- Never use\n\n**WPA**: TKIP weaknesses\n- Break encryption: Hours (practical attack)\n- Avoid for security-critical\n- Outdated, use WPA2+\n\n**WPA2**: KRACK (Key Reinstallation Attack)\n- **Vulnerability**: Key reinstalled during 4-way handshake\n- **Result**: Key reuse (weaken encryption)\n- **Attack**: Man-in-the-middle, replay messages\n- **Impact**: Attacker can decrypt WPA2 traffic\n- **Fix**: Patch AP and clients (both need update)\n- **Timeline**: Fixed in patches (2017+)\n- **Current**: WPA2 secure if patched\n\n**WPA3**: Resistant to KRACK and similar attacks\n- New key agreement (SAE) fixes flaw\n- No key reinstallation\n- More robust against known attacks\n\n## PART 5: RETAIL CHAIN WIRELESS DESIGN\n\n### RetailChain POS Network\n\n**Payment processing**: Must be **ENCRYPTED** (absolutely required)\n- Credit card data: PCI DSS compliance\n- Legal: Encryption mandatory\n- Unencrypted: Legal liability\n\n**Compliance**: PCI DSS requires wireless encryption\n- Standard: WPA2 minimum\n- Better: WPA3\n- Never: WEP, WPA\n\n### Guest WiFi Security\n\n**Standard**: WPA2 with **SHARED PASSWORD** or WPA3\n- WPA2-PSK: Everyone knows same password\n- Or: WPA3-Personal (stronger)\n- Recommendation: WPA2 or WPA3 (both acceptable for guest)\n\n**Risk**: Guest network isolated from **EMPLOYEE and POS networks**\n- Separate SSID\n- Separate VLAN\n- Separate encryption key\n- Guests cannot see employee traffic\n\n**VLAN**: Separate network (guests cannot see employee data)\n- VLAN 1: Guest WiFi (internet only)\n- VLAN 2: Employee WiFi (internal access)\n- VLAN 3: POS WiFi (payment processing)\n- Isolation: No traffic between VLANs\n\n### Employee WiFi Security\n\n**Standard**: WPA2-Enterprise with **802.1X / RADIUS**\n- Individual authentication\n- Centralized management\n- Scalable\n- Or: WPA3-Enterprise (more secure)\n\n**Benefit**: Individual authentication (not shared password)\n- Employee credentials (unique)\n- Can revoke per-user\n- Track who accessed\n- Audit trail\n\n**Coverage**: All stores (500 locations)\n- Nationwide rollout\n- Consistent security\n- Same authentication backend\n\n**Centralized**: RADIUS server at headquarters\n- Single authentication source\n- All stores query same server\n- Policy: Consistent across enterprise\n\n**Scalability**: Can manage thousands of users\n- 500 stores × 50 employees = 25,000 users\n- RADIUS handles easily\n- Add users: Simple (add to directory)\n- Remove users: Immediate (revoke account)\n\n### POS WiFi Security\n\n**Most critical**: Payment data (highest value target)\n\n**Standard**: WPA2-Enterprise **with MAXIMUM ENCRYPTION**\n- AES-CCMP encryption\n- 128-bit keys minimum\n- Or: WPA3-Enterprise (best)\n\n**Encryption**: AES-CCMP (WPA2) or AES-GCMP-256 (WPA3)\n- Both very strong\n- Both suitable for payment\n\n**Recommendation**: **WPA3** if possible, **WPA2** minimum\n- WPA3: Newer, stronger\n- WPA2: Current standard (sufficient)\n- Never: WPA or WEP\n\n**Isolation**: Separate network (air-gapped from guests)\n- POS devices: On separate SSID\n- Separate VLAN\n- Firewall rules: Only POS traffic\n- No guest access (physical isolation)\n\n**Monitoring**: **DETECT ROGUE APS, UNAUTHORIZED DEVICES**\n- Wireless IDS: Monitors POS channel\n- Alert: Unknown AP detected\n- Alert: Device not in whitelist\n- Response: Investigate\n\n## PART 6: ROGUE AP DETECTION\n\n### Detecting Rogue Access Points\n\n**Method 1**: **PASSIVE SCANNING** (observe networks)\n- Tool: WiFi analyzer app (passive)\n- Process: Scan for networks\n- Measure: Signal strength, location\n- Find: Unknown APs in area\n- Example: \"RetailChain Guest\" AP found in parking lot (not normal)\n\n**Method 2**: **ACTIVE TESTING** (connect and verify)\n- Tool: Wireless penetration testing\n- Look: For evil twin APs\n- Test: Connect to network\n- Verify: Check if legitimate (server identity)\n- Challenge: Must check certificate, not just SSID match\n\n**Method 3**: **MONITORING** (continuous surveillance)\n- Tool: Wireless IDS (like IDS for WiFi)\n- Monitor: Deauthentication attacks\n- Alert: On suspicious activity\n- Continuous: Always watching\n- Blocks: Can block rogue APs automatically\n\n**Method 4**: Certificate pinning\n- Clients verify: Server certificate is known/trusted\n- Defense: Against rogue AP intercepting HTTPS\n- Example: Browser knows real certificate, rejects fake\n\n### Preventing Rogue AP Connections\n\n**User education**: **NEVER AUTO-CONNECT, VERIFY NETWORK**\n- Training: Tell employees\n- Policy: \"Always ask before connecting\"\n- Awareness: Risks of public WiFi\n- Challenge: Users want convenience (click connect)\n\n**Disable auto-connect**: Turn off for open networks\n- Setting: WiFi auto-join disabled\n- Prevent: Accidental rogue connection\n- Trade-off: Must manually select network each time\n\n**Hide SSID**: **MAKES AP HARDER TO FIND?** (Not really)\n- Myth: Hidden SSID is secure\n- Reality: SSID sent in plaintext (can be discovered)\n- Limited protection: Casual users confused, not real security\n- Recommendation: Not a security measure\n\n**MAC filtering**: **WHITELIST KNOWN MAC ADDRESSES**\n- Setup: Register device MAC addresses\n- Effect: Only whitelisted devices connect\n- Problem: MAC can be spoofed\n- Limited: Works but not foolproof\n- Use case: Retail POS (controlled environment)\n\n**WPA2-Enterprise**: Forces **AUTHENTICATION** (harder to spoof)\n- Rogue AP: Must authenticate users somehow\n- RADIUS requirement: Must know user credentials\n- Defense: Attacker cannot bypass without credentials\n- Challenge: Requires setup (not trivial)\n\n**Certificate validation**: **CLIENT VERIFIES SERVER**\n- Client checks: Server certificate is legitimate\n- Rogue AP: Has self-signed certificate (invalid)\n- Client: Warns user (suspicious)\n- Defense: Prevents transparent MITM\n\n## PART 7: WIRELESS INCIDENT RESPONSE\n\n### Rogue AP Detected in Store\n\n**Incident**: Wireless IDS detects unauthorized AP\n- SSID: \"RetailChain\" (identical to legitimate)\n- Signal: Stronger than legitimate AP in that area\n- Location: Parking lot (unusual, suspicious)\n- Threat level: HIGH (likely evil twin)\n\n**Response steps**:\n\n1. **Capture**: **MAC ADDRESS, CHANNEL, SIGNAL STRENGTH**\n   - MAC: Identify unique device\n   - Channel: What frequency (WiFi channel)\n   - Signal: Strength reading\n   - Location: Physical location (pin on map)\n\n2. **Isolate**: **BLOCK AP FROM NETWORK**\n   - MAC filter: Add to blacklist\n   - APs stop forwarding: Blocks frames from rogue MAC\n   - Immediate: Takes seconds\n   - Effect: Rogue AP cannot connect clients\n\n3. **Investigate**: **WHERE DID IT COME FROM?**\n   - Physical search: Look in parking lot\n   - Find device: (if still there)\n   - Examine: Look for evidence (labels, power source)\n   - Forensics: Preserve for investigation\n\n4. **Remediate**: **REMOVE ROGUE AP**\n   - Physical removal: Recover device\n   - Evidence: Chain of custody\n   - Disposal: Secure wiping if internal device\n   - Unknown: If external (attacker), turn to police\n\n5. **Review**: **PATCH VULNERABILITY THAT ALLOWED IT**\n   - Security audit: How did AP appear?\n   - Was WPA2 enforced? (or WEP?)\n   - Was 802.11w enabled? (prevent deauth)\n   - Patch: Enable protections\n   - Monitor: Prevent repeat\n\n6. **Communicate**: **ALERT OTHER STORES**\n   - Network-wide alert: Other locations watch for similar\n   - Briefing: Managers at all stores\n   - Training: Staff awareness\n   - Vigilance: Report suspicious APs\n\n### Deauthentication Attack Detected\n\n**Incident**: IDS detects 50 deauth frames in 1 minute\n- Pattern: All from same source MAC address\n- Result: 100 customers kicked off guest WiFi\n- Customer impact: WiFi disruption, poor experience\n- Business impact: Service degradation\n\n**Response**:\n\n1. **Block**: **MAC ADDRESS OF ATTACKER**\n   - Immediate: Add to blacklist\n   - Effect: Deauth frames ignored\n   - Immediate relief: No more disconnections\n\n2. **Verify**: Is WPA3 enabled? If not, vulnerable\n   - Check APs: What standard deployed?\n   - If WPA2: Can add 802.11w protection\n   - If WPA3: Already protected\n   - Review: Why not enabled earlier?\n\n3. **Update**: Deploy 802.11w (protected management frames)\n   - APs: Enable protected management frames\n   - Clients: Require support (most modern devices do)\n   - Rollout: Phased (test first)\n   - Effect: Deauth frames must be authenticated\n\n4. **Monitor**: Watch for repeat attacks\n   - IDS: Alert on suspicious patterns\n   - Logging: Track incident\n   - Trend: Is this attacker back?\n   - Escalation: If repeat, investigate further\n\n5. **Response**: **RESTORE CONNECTIVITY**\n   - Communicate: Customers (WiFi back online)\n   - Monitoring: Ensure stability\n   - Support: Help customers reconnect\n\n## PART 8: WIRELESS ENCRYPTION AND PERFORMANCE\n\n### Encryption Overhead\n\n**Unencrypted WiFi**: 150 Mbps theoretical (802.11ac)\n- No encryption (clear)\n- Maximum throughput\n\n**WPA2 encryption**: ~130 Mbps (13% overhead)\n- AES-CCMP: Modest overhead\n- Still very fast\n- Acceptable for most uses\n\n**WPA3 encryption**: ~120 Mbps (20% overhead)\n- GCMP-256: Stronger (more processing)\n- 20% slower than WPA2\n- Still adequate (120 Mbps is fast)\n- Trade-off: Stronger security\n\n**Trade-off**: Performance vs security\n- Unencrypted: Fast but insecure\n- WPA2: Good balance\n- WPA3: Slightly slower, better security\n- Recommendation: WPA2/3 overhead acceptable\n\n**Recommendation**: Accept overhead for security\n- Performance loss: Minimal (13-20%)\n- Security gain: Massive (encryption)\n- Business impact: Worth it\n- No reasonable alternative: Must use encryption\n\n### Legacy Device Compatibility\n\n**Scenario**: Old printer only supports WEP\n- Device: Network printer (10 years old)\n- Support: WEP only (no WPA)\n- Problem: WEP is broken, cannot use\n\n**Options**:\n\n**1. Use WPA2** (printer won't connect)\n- Printer: Unsupported (no WPA2 ability)\n- Result: Cannot connect to network\n- Usable: No\n\n**2. Use WEP anyway** (security risk)\n- Printer: Can connect (WEP supported)\n- Network: Compromised (WEP broken)\n- Risk: Attacker breaks encryption in minutes\n- Recommendation: Unacceptable\n\n**3. Replace printer** (expensive)\n- Cost: $500-2,000\n- Benefit: Modern equipment (WPA2/3)\n- Lifetime: 5-10 years\n- ROI: Worth it (security + lifespan)\n\n**4. Isolate on separate AP** (backup solution)\n- Setup: Old AP with WEP for legacy device\n- Isolation: Not on main network\n- Risk: Limited (only old device vulnerable)\n- Temporary: Until device replaced\n\n**Best**: Option 3 (replace) or Option 4 (isolate)\n- Replace: Best long-term (modern equipment)\n- Isolate: Temporary (until replacement\n\n## PART 9: WIRELESS SECURITY BEST PRACTICES\n\n### RetailChain Wireless Security Roadmap\n\n**Current state**: WPA2 PSK (all locations)\n- 500 stores\n- Shared password (retail customer password)\n- No enterprise auth\n- Legacy setup\n\n**Phase 1 (Months 1-3)**: **UPGRADE TO WPA2-ENTERPRISE**\n- Deploy: RADIUS servers (HQ + backup)\n  - Primary: Headquarters\n  - Backup: Secondary location (DR)\n  - Capacity: Support 25,000 users\n- Rollout: Stores (10 per week, 50 weeks)\n  - Phased approach\n  - Training at each location\n  - Minimal disruption\n- Training: Store staff on new network\n  - Credentials: Employee username/password\n  - Support: Help desk for issues\n  - Documentation: Setup guides\n\n**Phase 2 (Months 4-6)**: **ADD WIRELESS IDS**\n- Detect: Rogue APs\n  - Continuous scanning\n  - Alert on unknown APs\n  - Geographic mapping\n- Monitor: Deauth attacks\n  - Alert on suspicious patterns\n  - Block attacking MACs\n- Alert: Suspicious activity\n  - SIEM integration\n  - Email alerts to security team\n\n**Phase 3 (Year 2)**: **UPGRADE TO WPA3 WHEN AVAILABLE**\n- Stronger: Encryption (GCMP-256)\n  - Better protection\n  - Resists known attacks\n- Better: Protection against attacks\n  - SAE key agreement\n  - Protections against brute-force\n- Upgrade: APs and clients\n  - Phased rollout\n  - Ensure device support\n  - Timeline: 6-12 months\n\n**Timeline**: **18-24 months total**\n- Phase 1: 3 months\n- Phase 2: 2 months (parallel to Phase 1 end)\n- Phase 3: 6-12 months (devices available)\n\n**Cost**: $**300,000-500,000**\n- RADIUS infrastructure: $50,000\n- AP upgrades: $200,000 (500 locations × ~$400)\n- Wireless IDS: $100,000\n- Professional services: $50,000\n- Training and support: $25,000\n\n### Wireless Security Checklist\n\n- [x] **WPA2 minimum** (no WEP or WPA) - REQUIRED\n- [x] **Strong password or enterprise auth** (not default) - REQUIRED\n- [x] **Encryption enabled** (AES-CCMP minimum) - REQUIRED\n- [x] **Guest network isolated** from employee - REQUIRED\n- [ ] **SSID broadcast disabled** (optional, adds little security)\n- [ ] **MAC filtering configured** (optional, limited value)\n- [x] **Firmware updated** on APs (patch vulnerabilities) - REQUIRED\n- [x] **802.11w enabled** (protected management frames) - REQUIRED for deauth protection\n- [x] **Monitoring enabled** (detect rogue APs) - REQUIRED\n- [x] **Incident response plan** documented - REQUIRED\n- [x] **User training** provided (phishing awareness) - REQUIRED\n- [x] **Regular audits** (quarterly) - REQUIRED\n- [ ] **WPA3 roadmap** planned (future upgrade) - RECOMMENDED",
  "hints": [
    "WEP completely broken (broken in minutes), WPA weak, WPA2 good, WPA3 best",
    "PSK: shared password, 802.1X: individual auth (choose 802.1X for enterprise)",
    "Rogue AP (evil twin) intercepts traffic; detection via WiFi scanner or IDS",
    "Deauthentication attack kicks users off; 802.11w (protected frames) prevents",
    "Guest network must be isolated from employee/POS networks (separate VLANs)",
    "POS systems need strongest encryption (WPA3-Enterprise or WPA2-Enterprise minimum)",
    "Certificate validation defends against rogue AP interception",
    "Encryption overhead (13-20%) acceptable trade-off for security",
    "Legacy device support: replace or isolate, never use WEP",
    "Wireless IDS detects rogue APs and deauthentication attacks continuously"
  ],
  "testCases": [
    {"id": "tc1-standards", "description": "Wireless standards comparison", "input": "WEP vs WPA vs WPA2 vs WPA3", "expected": "WEP broken, WPA weak, WPA2 good, WPA3 best", "assert": "assert ('wep' in solution.lower() or 'wpa' in solution.lower() or 'standard' in solution.lower())"},
    {"id": "tc2-authentication", "description": "PSK vs Enterprise", "input": "Authentication methods", "expected": "PSK shared, 802.1X individual", "assert": "assert ('psk' in solution.lower() or '802.1x' in solution.lower() or 'authentication' in solution.lower())"},
    {"id": "tc3-rogue", "description": "Rogue AP detection", "input": "Evil twin recognition", "expected": "Multiple APs with same SSID, stronger signal", "assert": "assert ('rogue' in solution.lower() or 'evil' in solution.lower() or 'ap' in solution.lower())"},
    {"id": "tc4-deauth", "description": "Deauthentication defense", "input": "802.11w protection", "expected": "Protected management frames prevent deauth", "assert": "assert ('deauth' in solution.lower() or '802.11w' in solution.lower() or 'frame' in solution.lower())"},
    {"id": "tc5-segmentation", "description": "Network isolation", "input": "Guest, employee, POS", "expected": "Separate networks with VLANs", "assert": "assert ('vlan' in solution.lower() or 'isolat' in solution.lower() or 'segment' in solution.lower())"},
    {"id": "tc6-encryption", "description": "Encryption requirements", "input": "AES-CCMP minimum", "expected": "WPA2/3 with strong cipher", "assert": "assert ('aes' in solution.lower() or 'encryption' in solution.lower() or 'ccmp' in solution.lower())"},
    {"id": "tc7-monitoring", "description": "Wireless monitoring", "input": "IDS for WiFi", "expected": "Detect rogue APs and attacks", "assert": "assert ('monitor' in solution.lower() or 'ids' in solution.lower() or 'detect' in solution.lower())"},
    {"id": "tc8-pci", "description": "Payment compliance", "input": "PCI DSS wireless", "expected": "Encryption required, WPA2 minimum", "assert": "assert ('pci' in solution.lower() or 'payment' in solution.lower() or 'encrypt' in solution.lower())"},
    {"id": "tc9-legacy", "description": "Legacy device handling", "input": "Old WEP device", "expected": "Replace or isolate, never use WEP", "assert": "assert ('replace' in solution.lower() or 'isolat' in solution.lower() or 'legacy' in solution.lower())"},
    {"id": "tc10-roadmap", "description": "Upgrade timeline", "input": "Phase 1,2,3", "expected": "Enterprise, IDS, WPA3 progression", "assert": "assert ('phase' in solution.lower() or 'upgrade' in solution.lower() or ('enterprise' in solution.lower() and 'wpa3' in solution.lower()))"}
  ]
}
