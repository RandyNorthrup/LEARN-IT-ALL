{
  "id": "exercise-018-static-routing",
  "lessonId": "lesson-018-static-routing",
  "title": "Static Routing Configuration, Use Cases, and Troubleshooting",
  "description": "You are a network administrator managing both dynamic and static routing scenarios. Complete realistic static routing configuration, troubleshooting, and decision-making tasks that test your understanding of when to use static routes, proper configuration methods, default gateway setup, and resolving common static routing problems in production environments.",
  "difficulty": "intermediate",
  "points": 100,
  "language": "cisco-ios",
  "starterCode": "# ============================================================================\n# NETWORK TOPOLOGY - MIXED STATIC AND DYNAMIC ROUTING\n# ============================================================================\n# Your company has a hybrid network with both static and dynamic routing:\n#\n#    Corporate HQ               ISP A Router              ISP B Router\n#    R1 Backbone               (ISP-A)                   (ISP-B)\n#    |                           |                          |\n#    192.168.1.0/24          10.0.1.0/30              10.0.2.0/30\n#    |                           |                          |\n# GigE0/0                   GigE0/0                    GigE0/0\n#    |                           |                          |\n#    GigE0/1---10.0.1.1-------10.0.1.2               10.0.2.2\n#      |            (Primary WAN)  |                    (Backup WAN)\n#      |                            |                        |\n#      +--------GigE0/2---10.0.3.1--+-----10.0.3.0/30------+\n#                (Secondary Link)   ISP-Backup Router\n#                                   (ISP-C)\n#\n# Network Details:\n# - R1 (HQ Backbone): 192.168.1.1 (local), 10.0.1.1 (ISP-A), 10.0.3.1 (ISP-C)\n# - ISP-A: 10.0.1.2 to Corporate, 10.0.1.3 to ISP-C\n# - ISP-B: 10.0.2.2 (backup)\n# - ISP-C: 10.0.3.2 to Corporate, 10.0.3.3 to ISP-A\n# - Internet represented by ISP routers\n# - No OSPF/EIGRP running - Static Routes Only\n#\n# Requirement: Configure R1 for Internet access, internal routing, and backup paths\n# ============================================================================\n\n# ============================================================================\n# SCENARIO 1: DEFAULT GATEWAY CONFIGURATION FOR INTERNET ACCESS\n# ============================================================================\n# Corporate HQ (R1) needs Internet access. Currently has NO default route.\n# All Internet-destined traffic (anything outside private networks) should go to ISP-A.\n# Users report: \"We can reach our branch offices but NOT the Internet\"\n#\n# TASK 1.1: Configure default route on R1 to ISP-A (primary)\n# Your command:\n# ip route ___.___.___.___ ___.___.___.__ ___.___.___.___ \n#\n# TASK 1.2: Explain your command\n# - Destination network being routed:\n# - Subnet mask meaning:\n# - Next-hop is:\n#\n# TASK 1.3: Test connectivity to Internet\n# Command to verify route is installed:\n# \n# Command to test path to 8.8.8.8:\n# \n# If ping fails, what would be your troubleshooting steps? (List 3)\n# Step 1:\n# Step 2:\n# Step 3:\n#\n\n# ============================================================================\n# SCENARIO 2: MULTIPLE DEFAULT ROUTES AND FLOATING STATIC BACKUP\n# ============================================================================\n# Internet reliability is critical. Configure backup default route to ISP-B if ISP-A fails.\n# PRIMARY: ISP-A at 10.0.1.2 (preferred, AD=1)\n# BACKUP: ISP-B at 10.0.2.2 (only if ISP-A down, AD=5)\n#\n# TASK 2.1: Configure backup floating static default route\n# Your command:\n# ip route ___.___.___.___ ___.___.___.__ ___.___.___.___ ___ \n#\n# TASK 2.2: Verify both routes\n# Command to show default routes:\n# \n# Expected output shows:\n# S*    0.0.0.0/0 [___/0] via 10.0.1.2          (primary, active)\n# S     0.0.0.0/0 [___/0] via 10.0.2.2          (backup, standby)\n#\n# TASK 2.3: Failover scenario\n# ISP-A link goes down (R1's GigE0/1 interface down).\n# What happens to traffic destined to 8.8.8.8?\n# \n# Immediately after failure (step-by-step):\n# Step 1:\n# Step 2:\n# Step 3:\n#\n\n# ============================================================================\n# SCENARIO 3: USE CASE DECISION - STATIC VS DYNAMIC ROUTING\n# ============================================================================\n# Your company is evaluating routing strategy for its WAN.\n# Currently 5 branch offices (Branches A-E), planning to grow to 20 branches.\n# Each branch has 1 connection back to HQ.\n#\n# TASK 3.1: Current state (5 branches, 1 connection each)\n# Is static or dynamic routing better? Why?\n# Your recommendation:\n# Justification:\n#\n# TASK 3.2: Future state (20 branches, considering redundancy)\n# Each branch will have 2 connections (primary and backup to different HQ links).\n# Manually managing 20*2 = 40 routes, plus failover logic, seems complex.\n# Should you switch to OSPF/EIGRP? Why/why not?\n# Your recommendation:\n# Justification:\n#\n# TASK 3.3: Hybrid approach\n# Your company decides: Keep HQ-Branch routing static, but add OSPF for internal HQ networks.\n# Why would this make sense?\n# Your explanation:\n#\n\n# ============================================================================\n# SCENARIO 4: STATIC ROUTES TO INTERNAL NETWORKS\n# ============================================================================\n# HQ has multiple internal networks managed by different departments:\n# - Finance LAN: 192.168.10.0/24 via Finance Router at 10.0.5.1\n# - Engineering LAN: 192.168.11.0/24 via Engineering Router at 10.0.6.1\n# - Operations LAN: 192.168.12.0/24 via Operations Router at 10.0.7.1\n#\n# Branch offices need to reach all three LANs through HQ.\n# R1 (HQ backbone) is not directly connected to these networks.\n# Each has a separate router that needs configuration.\n#\n# TASK 4.1: Configure routes on R1 to internal corporate networks\n# Command 1 (Finance):\n# ip route ___.___.___.___ ___.___.___.__ ___.___.___.___ \n#\n# Command 2 (Engineering):\n# ip route ___.___.___.___ ___.___.___.__ ___.___.___.___ \n#\n# Command 3 (Operations):\n# ip route ___.___.___.___ ___.___.___.__ ___.___.___.___ \n#\n# TASK 4.2: Route aggregation opportunity\n# Finance, Engineering, Operations all in 192.168.x.0/24\n# Could you summarize these three routes into ONE route?\n# Your summary route:\n# ip route ___.___.___.0 ___.___.___.__ ___.___.___.___ \n#\n# Issues with summarization:\n# - Pro: Fewer routes in table, simpler configuration\n# - Con: What problems might it cause?\n#\n\n# ============================================================================\n# SCENARIO 5: TROUBLESHOOTING - ASYMMETRIC ROUTING AND RETURN PATHS\n# ============================================================================\n# Branch A manager reports: \"We can SEND data to Finance LAN but CAN'T RECEIVE anything!\"\n# TCP connections timeout, ping fails one direction.\n# Finance can ping Branch A fine.\n#\n# You check:\n# - R1 has route to Finance LAN: CONFIGURED ✓\n# - Finance Router has route back to Branch A: MISSING ✗\n#\n# TASK 5.1: Identify the problem\n# Problem name:\n# Why is this happening?\n# Your explanation:\n#\n# TASK 5.2: Solution - What needs to be configured?\n# Location 1 - Finance Router needs:\n# Command:\n#\n# Destination should be: (Where is Branch A connected?)\n# Next-hop should be: (What is R1's IP toward Finance Router?)\n#\n\n# ============================================================================\n# SCENARIO 6: NEXT-HOP VS EXIT INTERFACE\n# ============================================================================\n# Configure routes on R1 for two different scenarios.\n# One connection is Ethernet (broadcast network with multiple routers).\n# One connection is Serial (point-to-point link to single remote router).\n#\n# TASK 6.1: For Serial0/0/0 (point-to-point to Branch-A)\n# Destination Branch-A networks: 172.16.0.0/16\n# Remote router IP: 10.0.10.1\n#\n# Which is BETTER configuration for Serial link?\n# A) ip route 172.16.0.0 255.255.0.0 10.0.10.1          (next-hop)\n# B) ip route 172.16.0.0 255.255.0.0 Serial0/0/0        (exit interface)\n# C) Both work equally well\n# D) Depends on protocol\n#\n# Your answer: \n# Why:\n#\n# TASK 6.2: For GigabitEthernet0/0 (Ethernet to Finance LAN)\n# Multiple routers on the Ethernet switch: Finance, Engineering, Operations\n# Destination Finance LAN: 192.168.10.0/24\n# Finance Router IP: 10.0.5.1\n#\n# Which is REQUIRED for Ethernet?\n# A) ip route 192.168.10.0 255.255.255.0 10.0.5.1       (next-hop REQUIRED)\n# B) ip route 192.168.10.0 255.255.255.0 GigE0/0        (exit interface only)\n# C) Either works\n# D) Can't route on Ethernet\n#\n# Your answer: \n# Why:\n#\n\n# ============================================================================\n# SCENARIO 7: STATIC ROUTING WITH SUBNET MASKS (CIDR VS DOTTED DECIMAL)\n# ============================================================================\n# You need to configure routes and understand subnet masks.\n# CIDR notation (slash notation) vs Dotted Decimal notation\n#\n# TASK 7.1: Convert subnet masks\n# /24 = ___.___.___.___\n# /25 = ___.___.___.___\n# /30 = ___.___.___.___\n# /32 = ___.___.___.___\n#\n# 255.255.255.0 = /___\n# 255.255.255.128 = /___\n# 255.255.255.252 = /___\n# 255.255.255.255 = /___\n#\n# TASK 7.2: Longest prefix match with different masks\n# R1 routing table:\n# S   192.168.0.0/16 via 10.0.10.1\n# S   192.168.1.0/24 via 10.0.11.1\n# S   192.168.1.128/25 via 10.0.12.1\n#\n# Packet destined to 192.168.1.150:\n# Which route is used?\n# Your answer: \n# Why? (Longest prefix match)\n#\n\n# ============================================================================\n# SCENARIO 8: TROUBLESHOOTING - ROUTE NOT IN ROUTING TABLE\n# ============================================================================\n# You configured:\n# ip route 10.0.0.0 255.255.0.0 172.16.50.1\n#\n# But when you run \"show ip route static\", this route does NOT appear!\n# Error message: \"172.16.50.1 is not a directly connected network\"\n#\n# TASK 8.1: Identify the problem\n# What is happening?\n# Your explanation:\n#\n# TASK 8.2: Propose 3 solutions\n# Solution 1:\n#\n# Solution 2:\n#\n# Solution 3:\n#\n\n# ============================================================================\n# SCENARIO 9: STATIC ROUTING BEST PRACTICES\n# ============================================================================\n# Your manager asks: \"What are best practices for static routing?\"\n#\n# TASK 9.1: When SHOULD you use static routing?\n# List 4 scenarios where static is appropriate:\n# 1.\n# 2.\n# 3.\n# 4.\n#\n# TASK 9.2: When should you NOT use static routing?\n# List 3 scenarios where dynamic routing is better:\n# 1.\n# 2.\n# 3.\n#\n# TASK 9.3: Static routing operational challenges\n# You manage 50 branch routers, each with multiple connections.\n# What operational challenges exist with static routing at scale?\n# Challenge 1:\n# Challenge 2:\n# Challenge 3:\n#\n",
  "solution": "# ============================================================================\n# SCENARIO 1: DEFAULT GATEWAY CONFIGURATION (SOLUTIONS)\n# ============================================================================\n\n# TASK 1.1: Configure default route\n# ANSWER:\n# ip route 0.0.0.0 0.0.0.0 10.0.1.2\n#\n# TASK 1.2: Explanation\n# - Destination network: 0.0.0.0 (all IP addresses - the catch-all)\n# - Subnet mask: 0.0.0.0 (matches any destination)\n# - Next-hop: 10.0.1.2 (ISP-A router)\n# - Purpose: Any traffic NOT in specific routes goes to ISP-A for Internet routing\n#\n# TASK 1.3: Testing\n# Command to verify default route installed:\n# show ip route\n# or\n# show ip route 0.0.0.0\n#\n# Output expected:\n# S*    0.0.0.0/0 [1/0] via 10.0.1.2, GigabitEthernet0/1\n# (S* means static default route, [1/0] means AD=1 metric=0)\n#\n# Command to test path to 8.8.8.8:\n# ping 8.8.8.8\n# or\n# traceroute 8.8.8.8\n#\n# Troubleshooting if ping fails:\n# Step 1: Verify interface is up/up\n#         show ip interface brief\n#         Look for GigabitEthernet0/1 - must show \"up up\"\n#\n# Step 2: Verify next-hop is reachable\n#         ping 10.0.1.2  (test direct neighbor)\n#         Must succeed for route to be useful\n#\n# Step 3: Check ISP-A router is operational\n#         If ping to 10.0.1.2 fails, ISP link is down\n#         May need to use backup ISP-B\n#\n\n# ============================================================================\n# SCENARIO 2: FLOATING STATIC BACKUP ROUTES (SOLUTIONS)\n# ============================================================================\n\n# TASK 2.1: Configure backup floating default route\n# ANSWER:\n# ip route 0.0.0.0 0.0.0.0 10.0.2.2 5\n#\n# Explanation:\n# - Same destination: 0.0.0.0 0.0.0.0 (default route)\n# - Next-hop: 10.0.2.2 (ISP-B backup)\n# - AD: 5 (higher than primary AD=1, so only active if primary fails)\n# - This creates redundancy without complex protocols\n#\n# TASK 2.2: Verify both routes\n# Command:\n# show ip route\n# or more specifically:\n# show ip route static\n#\n# Expected output:\n# S*    0.0.0.0/0 [1/0] via 10.0.1.2               ← Primary (ACTIVE, marked with *)\n# S     0.0.0.0/0 [5/0] via 10.0.2.2               ← Backup (STANDBY, no *)\n#\n# The asterisk (*) indicates the active route currently in use\n# Backup route sits dormant until primary fails\n#\n# TASK 2.3: Failover scenario when ISP-A link down\n# When R1's GigE0/1 (ISP-A link) goes down:\n#\n# Step 1: Interface status changes to down/down\n#         Router detects connectivity loss immediately\n#         Primary default route becomes INVALID\n#\n# Step 2: Primary route removed from routing table\n#         Static route with unreachable next-hop is removed\n#         Routing table now has ONLY backup route\n#\n# Step 3: Backup floating static route ACTIVATES\n#         Backup route at AD=5 now becomes best route (only option)\n#         Traffic to 8.8.8.8 redirects to ISP-B via 10.0.2.2\n#         Convergence: IMMEDIATE (no protocols to wait for)\n#\n# Result: Internet connectivity maintained via ISP-B\n# Automatic failover with static routes!\n#\n# TASK 2.4: Failover timing\n# Convergence time: < 1 second\n# Why: Floating static routes don't need protocol convergence\n# Direct interface status change triggers route installation\n# Compare to OSPF: 2-3 seconds typical, RIP: 5+ minutes\n#\n\n# ============================================================================\n# SCENARIO 3: USE CASE DECISION (SOLUTIONS)\n# ============================================================================\n\n# TASK 3.1: Current state (5 branches, 1 connection each)\n# ANSWER: STATIC ROUTING is better\n#\n# Justification:\n# - 5 branches * 1 connection = 5 routes to manage (very simple)\n# - Topology is stable (no frequent changes)\n# - OSPF/EIGRP overhead not justified for 5 simple hub-and-spoke routes\n# - Configuration: Just 5 static route commands on HQ\n# - No routing protocol CPU/memory overhead\n# - Better for simple, predictable topologies\n# - This is CLASSIC hub-and-spoke use case for static routing\n#\n# TASK 3.2: Future state (20 branches, 2 connections each)\n# ANSWER: CONSIDER SWITCHING TO OSPF or EIGRP\n#\n# Justification:\n# - 20 branches * 2 connections = 40 routes + return paths = complex\n# - Manual management of 40+ routes becomes error-prone\n# - Redundancy requires floating static (complicates configuration)\n# - If topology changes (add branch, connection fails), manual updates needed\n# - OSPF/EIGRP automatically:\n#   * Discovers new routers\n#   * Adjusts to failures automatically\n#   * Converges quickly\n#   * Reduces manual configuration\n# - At 20 branches: Dynamic routing ROI becomes positive\n#\n# Inflection point: Where static becomes impractical\n# - Small networks (< 10 sites): Static is fine\n# - Medium networks (10-50 sites): Hybrid approach\n# - Large networks (> 50 sites): Dynamic only\n# - Your company at 20 branches is at the inflection point\n#\n# TASK 3.3: Hybrid approach (static branches + dynamic internal)\n# Explanation: This makes SENSE for several reasons:\n#\n# 1. Branch connectivity is predictable\n#    - Each branch has dedicated connection(s) to HQ\n#    - No need for dynamic discovery\n#    - Static routes work well\n#\n# 2. Internal HQ networks change frequently\n#    - Multiple internal subnets\n#    - Frequent LANs added/removed\n#    - Frequent changes in internal routing\n#    - OSPF automatically adapts\n#\n# 3. Separation of concerns\n#    - WAN (to branches): Stable, static\n#    - Internal (HQ): Dynamic for flexibility\n#    - Simpler than running OSPF across entire enterprise\n#\n# Example configuration:\n# HQ Router:\n#   - Static routes to each branch (via branch connections)\n#   - OSPF for internal Finance/Eng/Ops networks\n#   - Advertise summarized internal networks via static to branches\n#\n# This is very common in enterprise networks!\n#\n\n# ============================================================================\n# SCENARIO 4: STATIC ROUTES TO INTERNAL NETWORKS (SOLUTIONS)\n# ============================================================================\n\n# TASK 4.1: Routes to internal corporate networks\n# Command 1 (Finance):\n# ip route 192.168.10.0 255.255.255.0 10.0.5.1\n#\n# Command 2 (Engineering):\n# ip route 192.168.11.0 255.255.255.0 10.0.6.1\n#\n# Command 3 (Operations):\n# ip route 192.168.12.0 255.255.255.0 10.0.7.1\n#\n# Each route:\n# - Defines path to specific departmental LAN\n# - Next-hop is the department's local router\n# - Allows all users (branches + HQ) to reach departments\n#\n# TASK 4.2: Route summarization\n# Summary route:\n# ip route 192.168.10.0 255.255.252.0 10.0.5.1\n#\n# Explanation:\n# /24 = 255.255.255.0 = specific networks\n# /22 = 255.255.252.0 = summarized (covers .10 through .13)\n# - 192.168.10.0/24 ✓ (Finance)\n# - 192.168.11.0/24 ✓ (Engineering)\n# - 192.168.12.0/24 ✓ (Operations)\n# - 192.168.13.0/24 ✓ (unused)\n#\n# Reduction: 3 routes → 1 route (1/3 size)\n#\n# Issues with summarization:\n# Problem 1: ALL traffic for 192.168.x.0/22 goes to Finance router (10.0.5.1)\n#   - If Engineering network unreachable from Finance router, packets drop\n#   - Requires all three networks reachable from same next-hop\n#   - Usually true in hub-and-spoke, breaks in complex topologies\n#\n# Problem 2: No specific path selection\n#   - Engineering traffic goes to Finance router (wrong!)\n#   - Finance router must forward to Engineering (inefficient)\n#   - Causes unnecessary traffic through Finance network\n#\n# Problem 3: Harder to troubleshoot\n#   - Can't tell which specific network has problem\n#   - \"192.168.12.0 via Finance router\" hides routing decision\n#\n# Best practice: Use summarization only when:\n# - All summarized networks are truly reachable via same path\n# - Performance impact is acceptable\n# - Operational simplicity outweighs loss of granularity\n#\n\n# ============================================================================\n# SCENARIO 5: ASYMMETRIC ROUTING (SOLUTIONS)\n# ============================================================================\n\n# TASK 5.1: Identify the problem\n# Problem name: ASYMMETRIC ROUTING\n# (Also called \"return path failure\" or \"routing loop\"/\"black hole\")\n#\n# Why happening:\n# Branch A can send to Finance:\n#   Request path: Branch A → R1 (HQ) → Finance Router → Finance LAN ✓\n#   But Finance cannot send back:\n#   Response path: Finance LAN → Finance Router → ? → ? → Branch A ✗\n#\n# Finance Router doesn't know how to reach Branch A\n# Responses are dropped (blackholed)\n# From Finance perspective: \"We got request but can't find sender\"\n#\n# TASK 5.2: Solution\n# Finance Router needs return route to Branch A:\n#\n# Location 1 - Finance Router needs:\n# Command:\n# ip route <branch-a-network> <subnet-mask> 10.0.5.1\n#\n# (Where is Branch A connected?)\n# Branch A networks: Typically 10.1.X.0/24 or 172.16.X.0/24 (depends on setup)\n# In this topology: Assume Branch A LAN is 10.1.0.0/24\n#\n# So Finance Router needs:\n# ip route 10.1.0.0 255.255.255.0 10.0.5.1\n#\n# (What is R1's IP toward Finance Router?)\n# R1's IP on link to Finance: 10.0.5.0/30 network\n# Specifically: R1 uses 10.0.5.1 (next-hop)\n# Wait - R1's IP is 10.0.5.1, so:\n#   Actually: Finance Router needs\n#   ip route 10.1.0.0 255.255.255.0 10.0.5.1 \n#   (This is incorrect - R1 IP should be different on that link)\n#\n# CORRECTION: If R1 is at 10.0.5.1 and Finance Router at 10.0.5.2:\n# Finance Router:\n# ip route 10.1.0.0 255.255.255.0 10.0.5.1 (return to R1)\n#\n# This completes the path:\n# Branch A → R1 → Finance (request ✓)\n# Finance → R1 → Branch A (response ✓)\n#\n# Key lesson: BIDIRECTIONAL ROUTING REQUIRED\n# All communication needs paths in BOTH directions\n# Verify return paths when troubleshooting connectivity issues\n#\n\n# ============================================================================\n# SCENARIO 6: NEXT-HOP VS EXIT INTERFACE (SOLUTIONS)\n# ============================================================================\n\n# TASK 6.1: Serial (point-to-point) link\n# ANSWER: B) exit interface is BETTER\n#\n# Why:\n# - Serial links are point-to-point: Only ONE device at other end (Branch-A)\n# - Sending out Serial0/0/0 = definitely going to Branch-A\n# - No ambiguity, no need to specify next-hop IP\n# - Exit interface method: Faster (no recursive lookup)\n#\n# Best configuration:\n# ip route 172.16.0.0 255.255.0.0 Serial0/0/0\n#\n# TASK 6.2: Ethernet (broadcast network)\n# ANSWER: A) next-hop IP is REQUIRED\n#\n# Why:\n# - Ethernet has MULTIPLE routers: Finance, Engineering, Operations\n# - Exit interface GigE0/0 is ambiguous\n#   \"Send out GigE0/0\" = but to WHICH router?\n# - Need next-hop IP to specify: Finance router at 10.0.5.1\n#\n# Must use:\n# ip route 192.168.10.0 255.255.255.0 10.0.5.1\n#\n# Using exit interface only would fail:\n# ip route 192.168.10.0 255.255.255.0 GigE0/0\n# Problem: Packet goes out GigE0/0 but router doesn't know WHO to send to\n#\n# Summary:\n# ┌─────────────────────┬──────────────────────┬─────────────────────┐\n# │ Link Type           │ Next-Hop             │ Exit Interface      │\n# ├─────────────────────┼──────────────────────┼─────────────────────┤\n# │ Serial (point-point)│ Works but suboptimal │ ✓ BEST PRACTICE     │\n# │ Ethernet (multi)    │ ✓ REQUIRED           │ Doesn't work        │\n# └─────────────────────┴──────────────────────┴─────────────────────┘\n#\n\n# ============================================================================\n# SCENARIO 7: SUBNET MASKS AND CIDR CONVERSION (SOLUTIONS)\n# ============================================================================\n\n# TASK 7.1: Subnet mask conversions\n# ANSWER:\n# /24 = 255.255.255.0\n# /25 = 255.255.255.128\n# /30 = 255.255.255.252\n# /32 = 255.255.255.255\n#\n# 255.255.255.0 = /24\n# 255.255.255.128 = /25\n# 255.255.255.252 = /30\n# 255.255.255.255 = /32\n#\n# Concept:\n# - Each /1 = one bit in mask\n# - /24 = first 24 bits all 1s (255.255.255.0)\n# - /25 = first 25 bits (255.255.255.128)\n# - /30 = first 30 bits (255.255.255.252 - common for WAN links)\n# - /32 = all 32 bits (host route, single IP)\n#\n# TASK 7.2: Longest prefix match\n# Routing table:\n# S   192.168.0.0/16 via 10.0.10.1         (/16 match)\n# S   192.168.1.0/24 via 10.0.11.1        (/24 match)\n# S   192.168.1.128/25 via 10.0.12.1      (/25 match)\n#\n# Packet to 192.168.1.150:\n# - Matches /16? YES (entire 192.168.x.x is /16)\n# - Matches /24? YES (192.168.1.0 is /24)\n# - Matches /25? YES (192.168.1.128-255 is /25, 150 is in range)\n#\n# Longest match (most specific): /25\n#\n# ANSWER: /25 route via 10.0.12.1\n#\n# Why:\n# - More specific routes always win (longest prefix match)\n# - /25 is more specific than /24, which is more specific than /16\n# - Allows traffic engineering:\n#   * 192.168.1.0-127 via one path (/25)\n#   * 192.168.1.128-255 via different path (/25)\n#   * Other 192.168.x.x via general route (/16)\n#\n\n# ============================================================================\n# SCENARIO 8: ROUTE NOT IN TABLE - UNRESOLVABLE NEXT-HOP (SOLUTIONS)\n# ============================================================================\n\n# TASK 8.1: Identify the problem\n# ANSWER: Unresolvable next-hop (recursion failure)\n#\n# Explanation:\n# Router cannot install route because next-hop 172.16.50.1 is not reachable:\n# - Not in any directly connected interface\n# - Not in any existing route in routing table\n# - Router: \"I can't reach 172.16.50.1, so how do I forward packets there?\"\n#\n# Static routes require recursive lookup:\n# 1. To send packet to 10.0.0.0/16\n# 2. I need to send it to 172.16.50.1\n# 3. To send it to 172.16.50.1, where do I send IT?\n# 4. 172.16.50.1 not in my routing table = PROBLEM\n#\n# TASK 8.2: Three solutions\n#\n# Solution 1: Add route to next-hop network FIRST\n# ip route 172.16.50.0 255.255.255.0 GigabitEthernet0/1\n# ip route 10.0.0.0 255.255.0.0 172.16.50.1\n#\n# Now 172.16.50.1 is reachable (via GigE0/1)\n# So route to 10.0.0.0 can be installed\n# Requires knowing the topology and adding prerequisite route\n#\n# Solution 2: Use exit interface instead\n# ip route 10.0.0.0 255.255.0.0 GigabitEthernet0/1\n#\n# No recursion needed - directly specifies interface\n# Works for point-to-point links\n# Note: GigabitEthernet0/1 must be up/up\n#\n# Solution 3: Use fully specified route (next-hop + interface)\n# ip route 10.0.0.0 255.255.0.0 GigabitEthernet0/1 172.16.50.1\n#\n# Specifies both interface and next-hop\n# Modern routers prefer this (combines best of both)\n# No recursion needed (interface specified)\n#\n# Best practice:\n# - If next-hop is reachable (in routing table), use next-hop only\n# - If using exit interface, verify interface is always up\n# - Modern configs use interface + next-hop for clarity\n#\n\n# ============================================================================\n# SCENARIO 9: STATIC ROUTING BEST PRACTICES (SOLUTIONS)\n# ============================================================================\n\n# TASK 9.1: When to USE static routing\n# Answer (4 scenarios):\n#\n# 1. Hub-and-spoke WAN topology\n#    - Single connection from each branch to HQ\n#    - Stable topology, no frequent changes\n#    - Static routes perfect for this\n#    - Example: 5-20 branch offices\n#\n# 2. Default routes to ISP\n#    - Internet connection (catch-all route)\n#    - \"Everything else goes to ISP\"\n#    - 0.0.0.0 0.0.0.0 static route is standard\n#    - Single command, rock-solid\n#\n# 3. Backup/redundancy with floating statics\n#    - Primary path dynamic (OSPF)\n#    - Backup path static (higher AD)\n#    - Activates if primary fails\n#    - No complexity of full dynamic routing\n#\n# 4. Lab environments and testing\n#    - Predictable, simple topologies\n#    - Need to understand how routing works\n#    - Static forces you to manually specify each path\n#    - Great for learning\n#\n# TASK 9.2: When NOT to use (need dynamic routing)\n#\n# 1. Large networks (50+ routers)\n#    - Manually managing 50+ routes = impractical\n#    - Changes require manual updates on many routers\n#    - Dynamic protocols handle automatically\n#    - OSPF/EIGRP designed for scalability\n#\n# 2. Frequent topology changes\n#    - New networks added regularly\n#    - Existing networks removed\n#    - Links fail and restore frequently\n#    - Static routes become maintenance nightmare\n#    - Dynamic protocols adapt automatically\n#\n# 3. Complex multi-path topologies\n#    - Multiple paths to same destination\n#    - Need automatic failover and load balancing\n#    - Static requires floating statics and manual management\n#    - Dynamic routes automatically find best paths\n#\n# TASK 9.3: Operational challenges at scale\n#\n# Challenge 1: Configuration management\n#   - 50 branch routers * multiple routes each = hundreds of commands\n#   - Each change requires updating multiple routers\n#   - Risk: Typos cause unreachable networks\n#   - Manual tracking needed (which routes on which routers?)\n#   - Version control of configurations critical\n#\n# Challenge 2: Failure and redundancy\n#   - Link failure = manual intervention needed\n#   - Floating statics help but still manual\n#   - OSPF/EIGRP converges in seconds automatically\n#   - Static routes require administrator to reconfigure backup paths\n#   - Outage duration = time for human to respond\n#\n# Challenge 3: Troubleshooting and documentation\n#   - Why isn't this network reachable?\n#   - Must manually trace through all routers checking routes\n#   - \"show ip route\" doesn't show why route is configured this way\n#   - Dynamic routing shows learned routes (easier to verify logic)\n#   - Historical changes lost (why was this route added?)\n#\n# Challenge 4: Growth and scalability\n#   - Adding new branch = configure static routes on EVERY router\n#   - With dynamic routing: New router announces itself\n#   - Configuration explosion as network grows\n#   - Becomes unmaintainable beyond ~20-30 sites\n#\n# INFLECTION POINT: Where static routing stops scaling\n# - 1-5 sites: Static is perfect\n# - 5-15 sites: Static still manageable\n# - 15-30 sites: Consider hybrid (static+dynamic)\n# - 30+ sites: Dynamic routing required for operational efficiency\n#\n",
  "hints": [
    "Default route 0.0.0.0 0.0.0.0 is the catch-all for any unmatched destination",
    "Floating static routes use higher AD than primary routes to provide automatic backup",
    "Hub-and-spoke topology (single connection per branch) is ideal for static routing",
    "Asymmetric routing breaks bidirectional communication - always verify return paths",
    "On point-to-point links (Serial): use exit interface. On Ethernet: use next-hop IP",
    "Unresolvable next-hop occurs when next-hop IP doesn't exist in routing table",
    "Static routing best for small, stable networks. Dynamic routing for large/changing networks",
    "Longest prefix match: /32 beats /24 beats /16 for same destination",
    "Recursive lookup: Router must be able to reach the next-hop IP to install the route",
    "Static routes require manual updates for topology changes - this is the scalability limit",
    "At 50+ routers, manual static route management becomes impractical and error-prone",
    "Test connectivity after configuration: ping neighbors, then test remote networks"
  ],
  "testCases": [
    {
      "id": "tc1",
      "description": "Configures default route to ISP (0.0.0.0 0.0.0.0)",
      "validation": "assert ('0.0.0.0 0.0.0.0' in code and '10.0.1.2' in code) or ('default' in code.lower() and 'route' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc2",
      "description": "Understands floating static routes with higher AD for backup",
      "validation": "assert ('floating' in code.lower() or 'backup' in code.lower()) and ('5' in code or 'higher' in code.lower() or 'ad' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc3",
      "description": "Identifies hub-and-spoke as appropriate use case for static routing",
      "validation": "assert ('hub' in code.lower() or 'spoke' in code.lower() or 'branch' in code.lower()) and ('small' in code.lower() or 'predictable' in code.lower() or 'static' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc4",
      "description": "Explains asymmetric routing problem and return path requirement",
      "validation": "assert ('asymmetric' in code.lower() or 'return' in code.lower() or 'bidirection' in code.lower()) and ('path' in code.lower() or 'route back' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc5",
      "description": "Understands next-hop vs exit interface for different link types",
      "validation": "assert ('next-hop' in code.lower() or 'exit interface' in code.lower() or 'serial' in code.lower() or 'ethernet' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc6",
      "description": "Converts between CIDR and dotted decimal subnet masks",
      "validation": "assert ('/24' in code or '255.255.255.0' in code) and ('/30' in code or '255.255.255.252' in code)",
      "isHidden": false
    },
    {
      "id": "tc7",
      "description": "Identifies unresolvable next-hop as troubleshooting issue",
      "validation": "assert ('unresolv' in code.lower() or 'next-hop' in code.lower() or 'recursive' in code.lower()) and ('172.16.50' in code or 'not reachable' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc8",
      "description": "Explains scalability limits of static routing (when to switch to dynamic)",
      "validation": "assert ('50' in code or '30' in code or 'large' in code.lower() or 'scalab' in code.lower()) and ('dynamic' in code.lower() or 'ospf' in code.lower() or 'eigrp' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc9",
      "description": "Uses show ip route commands for verification",
      "validation": "assert ('show ip route' in code.lower() or 'ping' in code.lower() or 'traceroute' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc10",
      "description": "Total file size meets 10,000+ character minimum",
      "validation": "assert len(code) >= 10000",
      "isHidden": true
    },
    {
      "id": "tc11",
      "description": "Covers major lesson 018 concepts: configuration, use cases, troubleshooting, scalability",
      "validation": "assert code.count('task') >= 8 and ('scenario' in code.lower() or 'static' in code.lower()) and ('troubleshoot' in code.lower() or 'problem' in code.lower())",
      "isHidden": true
    }
  ]
}
