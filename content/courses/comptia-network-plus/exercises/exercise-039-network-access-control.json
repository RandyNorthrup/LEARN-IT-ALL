{
  "id": "exercise-039-network-access-control",
  "lessonId": "lesson-039-network-access-control",
  "title": "Network Access Control and Device Management",
  "description": "Implement Network Access Control (NAC) to enforce security policies on endpoint devices. Manage device compliance, quarantine non-compliant devices, and integrate with network infrastructure.",
  "difficulty": "intermediate",
  "points": 100,
  "language": "text",
  "starterCode": "# NETWORK ACCESS CONTROL (NAC) EXERCISE\n# Enforce endpoint security policies network-wide\n\n## SCENARIO: HealthCare Plus network security\n## - Environment: 10 hospitals, 5,000 employees + contractors\n## - Devices: Desktops, laptops, phones, tablets, medical equipment\n## - Compliance: HIPAA (patient data protection)\n## - Threats: \n##   * Unpatched systems with vulnerabilities\n##   * Personal devices on corporate network\n##   * Contractors connecting without security controls\n##   * Medical devices (old, unmaintainable) with weak security\n##   * Malware spreading via infected devices\n\n## PART 1: NAC FUNDAMENTALS\n## Q1: Network Access Control (NAC) definition:\n##     - What: System that _______ devices before network access\n##     - Controls: What _______ can connect\n##     - Enforces: _______ on all endpoints\n##     - Goal: Ensure minimum security posture\n##     - Example: Block device without updated patches\n##\n## Q2: NAC decision points:\n##     - Before connection: Device attempts to join network\n##     - Check: Is device _______ (evaluated against policy)\n##     - Checks performed: _______ (firmware version, antivirus, patches)\n##     - Decision: Allow full access, quarantine, or deny\n##     - Enforcement: Via _______ (VLAN assignment, ACLs)\n##\n## Q3: NAC components:\n##     - Supplicant: _______ (client software on endpoint)\n##     - Authenticator: _______ (network device, usually switch)\n##     - Authentication server: _______ (RADIUS, evaluates posture)\n##     - Policy server: _______ (stores rules, evaluates compliance)\n##     - Remediation server: _______ (fixes issues, patches)\n\n## PART 2: DEVICE CLASSIFICATION\n## Q4: Device categories:\n##     - Managed devices: Company-owned, _______ (IT managed)\n##     - Examples: Desktop, laptop (with standard image)\n##     - Control: Full (can enforce policies)\n##     - Compliance: Easy (company controls)\n##     \n##     - BYOD (Bring Your Own Device): _______ (personal devices)\n##     - Examples: Personal laptop, smartphone\n##     - Control: Limited (user owns device)\n##     - Compliance: Challenging (user not IT)\n##     \n##     - Contractor devices: _______ (third-party owned)\n##     - Examples: Contractor's laptop, vendor equipment\n##     - Control: Very limited\n##     - Compliance: Difficult (external party)\n##     \n##     - Medical devices/IoT: _______ (specialized equipment)\n##     - Examples: Patient monitor, ventilator (WiFi connected)\n##     - Control: Minimal (manufacturer firmware)\n##     - Compliance: Very difficult (cannot patch)\n\n## Q5: Device inventory and discovery:\n##     - Inventory: What devices are on network?\n##     - Discovery: Automatic via _______ (ARP, DHCP, 802.1X)\n##     - MAC address: Unique _______ (physical address)\n##     - Hostname: Device name (\"johnsmith-laptop\")\n##     - OS: Operating system (Windows, macOS, Linux)\n##     - Software: Installed applications, versions\n##     - Purpose: Track and inventory all devices\n\n## PART 3: COMPLIANCE CHECKING\n## Q6: Endpoint security checks:\n##     - Antivirus: _______ (running, updated?)\n##     - Firewall: OS firewall enabled? _______\n##     - Patches: Windows/macOS/Linux up to date? _______\n##     - Disk encryption: BitLocker/FileVault enabled? _______\n##     - Password policy: Strong passwords enforced? _______\n##     - Antimalware: Real-time scanning enabled? _______\n##     - Full disk encryption: Prevents data theft if lost\n\n## Q7: Health check results:\n##     - Compliant: _______ (passes all checks)\n##     - Partially compliant: _______ (fails some checks)\n##     - Non-compliant: _______ (fails major checks)\n##     - Action: Depending on result, grant or restrict access\n\n## Q8: HealthCare Plus baseline policy:\n##     Device MUST have:\n##     - [ ] Antivirus (enabled, updated)\n##     - [ ] Windows Defender or equivalent\n##     - [ ] Firewall enabled (Windows or OS native)\n##     - [ ] OS patches (within 30 days of release)\n##     - [ ] Screen lock (5-minute timeout)\n##     - [ ] Strong password (12+ characters, complex)\n##     - [ ] Disk encryption (BitLocker for Windows)\n##     - [ ] No unauthorized software\n##     - [ ] Mobile device management (MDM) enrolled\n##     - [ ] HIPAA privacy notice accepted\n##     \n##     Failure: Device quarantined to remediation network\n\n## PART 4: NETWORK SEGMENTS AND VLANs\n## Q9: NAC-enforced network segments:\n##     - Trusted network: _______ (full access)\n##     - Example: Compliant company laptops\n##     - Restrictions: Normal (firewall rules apply)\n##     \n##     - Untrusted/Guest network: _______ (limited access)\n##     - Example: Contractor devices, BYOD\n##     - Restrictions: Internet only (cannot access corporate systems)\n##     \n##     - Quarantine/Remediation network: _______ (isolated)\n##     - Example: Non-compliant devices\n##     - Restrictions: Access to patch/AV servers only\n##     - Goal: Fix device, then move to trusted\n##     \n##     - Medical/IoT network: _______ (specialized)\n##     - Example: Patient monitors, medical equipment\n##     - Restrictions: Limited (cannot patch, special handling)\n##     - Monitoring: Extra scrutiny (critical infrastructure)\n\n## Q10: VLAN assignment based on compliance:\n##      Device connects to network switch\n##      - MAC address captured\n##      - Health check performed (via NAC)\n##      - Result: Compliant or non-compliant\n##      - Action: Assign VLAN based on result\n##      \n##      Example:\n##      - Compliant device: VLAN 100 (Corporate network)\n##      - Non-compliant device: VLAN 200 (Quarantine)\n##      - Contractor device: VLAN 300 (Guest)\n##      - Medical equipment: VLAN 400 (Medical)\n##      \n##      Why VLANs: _______ (enforce network isolation)\n\n## PART 5: QUARANTINE AND REMEDIATION\n## Q11: Device detected non-compliant:\n##      Scenario: Employee laptop missing Windows patches\n##      \n##      Detection:\n##      - NAC check: \"Windows not patched in 45 days\" (exceeds 30-day policy)\n##      - Status: Non-compliant\n##      - Action: Quarantine\n##      \n##      Quarantine process:\n##      - Move device to VLAN 200 (quarantine network)\n##      - Restrict: Only to patch server\n##      - Alert: Employee and IT about non-compliance\n##      - Cause: Which check failed? (patches, AV, firewall)\n##      \n##      Remediation:\n##      - Patch server: Provides updates automatically\n##      - Employee experiences: Slow downloads (restricted bandwidth)\n##      - Incentive: Get patched to rejoin trusted network\n##      - Timeline: Patches download (hours to days)\n##      \n##      Re-check:\n##      - After patches applied: Re-run health check\n##      - Pass: Move back to trusted VLAN 100\n##      - Fail: Continue quarantine (other issues)\n\n## Q12: Contractor device onboarding:\n##      Scenario: Contractor arrives with personal laptop\n##      \n##      Process:\n##      - Register: MAC address, hostname, ownership\n##      - Policy: Contractor network policies (more restrictive)\n##      - Baseline: What baseline applies? (lower than company devices?)\n##      - Check: Health check against contractor policy\n##      - Result: May not pass company baseline\n##      - Decision: Allow to Guest network (VLAN 300)\n##      - Access: Internet only, cannot access internal systems\n##      - Duration: Limited (contractor end date)\n##      \n##      Advantage: Security (limited access) vs usability (contractor can work)\n\n## PART 6: DEVICE NON-COMPLIANCE ISSUES\n## Q13: Medical device dilemma:\n##      Scenario: Patient monitor WiFi module (10 years old)\n##      \n##      Reality:\n##      - OS: Unknown (proprietary firmware)\n##      - Patches: None available (manufacturer stopped support)\n##      - Antivirus: No (embedded device)\n##      - Firewall: No\n##      - Password: Default (\"admin\")\n##      - Security: Multiple vulnerabilities known\n##      - Patching: Impossible (manufacturer support ended)\n##      \n##      NAC dilemma:\n##      - Policy: Would block (non-compliant)\n##      - Reality: Critical medical device (cannot block)\n##      - Trade-off: Critical business need vs security risk\n##      \n##      Solution:\n##      - Exception: Create special policy for medical devices\n##      - Isolation: Put on separate VLAN (medical network)\n##      - Monitoring: Extra scrutiny (IDS/IPS monitoring)\n##      - Mitigation: Network-level controls (not device-level)\n##      - Document: Risk accepted, mitigation in place\n\n## Q14: BYOD complications:\n##      Employee personal laptop (macOS, 3 years old)\n##      \n##      Issues:\n##      - Antivirus: Not installed (thinks not needed)\n##      - Patches: Outdated (6 months behind)\n##      - Disk encryption: Not enabled (personal preference)\n##      - Password: Weak (\"Welcome123\")\n##      - Policy: Fails NAC checks\n##      \n##      Options:\n##      1. Block completely (employee cannot work, bad experience)\n##      2. Quarantine (employee fixes issues)\n##      3. Guest network (limited access, not useful)\n##      4. Exception (risk accepted)\n##      \n##      Recommendation: Quarantine + support\n##      - Provide: Patches, AV installation help\n##      - Timeline: 2-3 days (employee can remediate)\n##      - Re-check: After fixes applied\n\n## PART 7: NAC POLICY EXAMPLES\n## Q15: Access policies:\n##      For each device type, define policy\n##      \n##      Company Desktop (most strict):\n##      - Antivirus: Required, updated\n##      - Patches: Within 30 days\n##      - Encryption: Required (BitLocker)\n##      - Firewall: Enabled\n##      - Access: Full corporate network\n##      \n##      Company Laptop (strict):\n##      - Same as desktop\n##      - Mobile: Can roam (not always connected)\n##      - VPN: Required when remote\n##      \n##      BYOD/Contractor (moderate):\n##      - Antivirus: Required\n##      - Patches: Within 60 days\n##      - Encryption: Recommended (optional)\n##      - Firewall: Enabled\n##      - Access: Guest network (internet only)\n##      \n##      Guest WiFi (least strict):\n##      - No checks\n##      - Open WiFi (anyone can connect)\n##      - Access: Internet only\n##      - Isolation: Cannot see corporate network\n\n## Q16: Policy enforcement:\n##      How are policies enforced?\n##      \n##      At connection time:\n##      - Device connects to network\n##      - NAC triggered\n##      - Health check performed\n##      - Policy applied (VLAN assignment)\n##      - Enforcement: Immediate\n##      \n##      Continuous monitoring:\n##      - Periodic re-checks (every 24 hours?)\n##      - Malware detected: Quarantine device\n##      - Firewall disabled: Alert and restrict\n##      - New software: Detect and respond\n\n## PART 8: NAC IMPLEMENTATION CHALLENGES\n## Q17: Legacy systems:\n##      Old server running Windows Server 2003\n##      \n##      Problem:\n##      - No NAC support (very old)\n##      - Cannot update (critical application depends on 2003)\n##      - Must stay on network (production system)\n##      - Cannot meet security baseline\n##      \n##      Solution options:\n##      1. Exception: Accept risk\n##      2. Network segmentation: Isolate on special VLAN\n##      3. Manual approval: IT manually verifies and grants access\n##      4. Air-gap: Disconnect from network entirely\n##      \n##      Recommendation: Segment + monitor\n##      - Put on isolated VLAN\n##      - Extra monitoring\n##      - Firewall rules (only needed services)\n##      - Plan replacement\n\n## Q18: Non-compliant by design:\n##      Scenario: Industrial control system (temperature sensor network)\n##      \n##      Reality:\n##      - Embedded Linux (cannot patch)\n##      - Default password (cannot change)\n##      - No firewall (not supported)\n##      - Critical system (cannot disconnect)\n##      \n##      NAC approach:\n##      - Exception: Create custom policy for control systems\n##      - Isolation: Separate VLAN\n##      - Network controls: Firewall rules (not device level)\n##      - Monitoring: Extra scrutiny\n##      - Security: Defense in depth (network + physical)\n\n## PART 9: IMPLEMENTATION ROADMAP\n## Q19: NAC deployment phases:\n##      For HealthCare Plus (10 hospitals, 5,000 devices)\n##      \n##      Phase 1 (Months 1-2): Pilot\n##      - Scope: _______ (one department/hospital)\n##      - Devices: _______ (50-100 devices)\n##      - Goal: Test and refine policies\n##      - Learn: What devices break? What policies too strict?\n##      \n##      Phase 2 (Months 3-6): Gradual rollout\n##      - Scope: _______ (one hospital at a time)\n##      - Devices: _______ (all employees at hospital)\n##      - Support: Help desk trained (issues will occur)\n##      - Feedback: Collect issues, tune policies\n##      \n##      Phase 3 (Months 7-12): Full deployment\n##      - Scope: _______ (all 10 hospitals)\n##      - Devices: _______ (all 5,000 devices)\n##      - Ongoing: Monitoring and tuning\n##      \n##      Timeline: _______ (months total?)\n\n## Q20: Cost and resources:\n##      - NAC platform: $_______ (software + hardware)\n##      - Professional services: $_______ (implementation)\n##      - Training: $_______ (IT staff)\n##      - Ongoing support: $_______ (annual)\n##      - Total Year 1: $_______ (equipment + setup)\n##      - Year 2+: $_______ (support + maintenance)\n##\n## Q21: Compliance verification:\n##      NAC helps with compliance (HIPAA for healthcare)\n##      \n##      HIPAA requirement: Ensure access controls\n##      - NAC enforces: Devices must meet baseline\n##      - Patch management: Automatic enforcement\n##      - Antivirus: Required, monitored\n##      - Encryption: Mandatory\n##      \n##      Audit trail:\n##      - Log: What devices connected\n##      - Log: Policy check results\n##      - Log: Remediation actions\n##      - Evidence: Proof of compliance\n\n## Q22: Endpoint Detection and Response (EDR) integration:\n##      EDR tool: Advanced threat detection on endpoints\n##      \n##      Integration:\n##      - EDR detects: Malware, suspicious behavior\n##      - Signal to NAC: \"Device compromised\"\n##      - NAC action: Quarantine device immediately\n##      - Workflow: EDR → NAC → isolation\n##      \n##      Benefit: Automated response\n##      - No human delay\n##      - Infected device removed immediately\n##      - Prevents spread\n##      - Faster incident response",
  "solution": "# NETWORK ACCESS CONTROL (NAC) SOLUTION\n\n## PART 1: NAC FUNDAMENTALS\n\n### Network Access Control Definition\n\n**What**: System that **EVALUATES/CHECKS** devices before network access\n\n**Controls**: What **DEVICES/ENDPOINTS** can connect\n\n**Enforces**: **SECURITY POLICIES** on all endpoints\n\n**Goal**: Ensure minimum security posture\n- Block vulnerable devices\n- Require patches\n- Demand encryption\n- Verify compliance\n\n**Example**: Block device without updated patches\n- Device attempts to join network\n- NAC checks: \"When was this patched?\"\n- Result: 90 days old → block\n- Action: Quarantine for patching\n\n### NAC Decision Points\n\n**Before connection**: Device attempts to join network\n\n**Check**: Is device **COMPLIANT** (evaluated against policy)\n\n**Checks performed**:\n- Firmware version (is current?)\n- Antivirus status (running, updated?)\n- Patches (up to date?)\n- Disk encryption (enabled?)\n- Firewall (enabled?)\n- Password policy (strong?)\n- Mobile device management (enrolled?)\n\n**Decision**: \n- Allow full access (compliant)\n- Quarantine (fix issues)\n- Deny (critical issues)\n\n**Enforcement**: Via **VLAN ASSIGNMENT** (network segmentation)\n- Compliant: VLAN 100 (corporate, full access)\n- Non-compliant: VLAN 200 (quarantine, limited access)\n- Guest: VLAN 300 (internet only)\n\n### NAC Components\n\n**Supplicant**: **CLIENT SOFTWARE** on endpoint\n- Installed on device\n- Runs security checks locally\n- Reports compliance status\n\n**Authenticator**: **NETWORK DEVICE** (usually switch)\n- Access point or switch\n- Acts as gateway\n- Enforces policy\n- Assigns VLAN\n\n**Authentication server**: **RADIUS** (evaluates posture)\n- Receives health check\n- Evaluates against policy\n- Grants or denies access\n- 802.1X protocol\n\n**Policy server**: **STORES RULES** (evaluates compliance)\n- Stores policies\n- Updates baselines\n- Evaluates device against policy\n- Central management\n\n**Remediation server**: **FIXES ISSUES, PATCHES**\n- Provides patches\n- Delivers AV definitions\n- Auto-remediates\n- Updates OS\n\n## PART 2: DEVICE CLASSIFICATION\n\n### Device Categories\n\n**Managed devices**: Company-owned, **IT MANAGED**\n- Examples: Desktop, laptop (standard image)\n- Control: Full (IT manages entirely)\n- Compliance: Easy (company controls)\n- Standards: Highest baseline\n- Examples: Desktop, company laptop\n\n**BYOD** (Bring Your Own Device): **PERSONAL DEVICES**\n- Examples: Personal laptop, smartphone\n- Control: Limited (user owns device)\n- Compliance: Challenging (user not IT)\n- Standards: Lower baseline\n- Tradeoff: Less strict vs security concerns\n\n**Contractor devices**: **THIRD-PARTY OWNED**\n- Examples: Contractor's laptop, vendor equipment\n- Control: Very limited\n- Compliance: Difficult (external party)\n- Standards: Guest network baseline\n- Access: Limited (internet only)\n\n**Medical devices/IoT**: **SPECIALIZED EQUIPMENT**\n- Examples: Patient monitor, ventilator (WiFi connected)\n- Control: Minimal (manufacturer firmware)\n- Compliance: Very difficult (cannot patch)\n- Standards: Custom policy (exception)\n- Monitoring: Extra scrutiny (critical infrastructure)\n\n### Device Inventory and Discovery\n\n**Inventory**: What devices are on network?\n\n**Discovery**: Automatic via **ARP, DHCP, 802.1X**\n- ARP: Address Resolution Protocol (finds devices)\n- DHCP: Assigns IP, reveals device info\n- 802.1X: Authentication reveals identity\n\n**MAC address**: Unique **PHYSICAL ADDRESS**\n- Example: 00:1A:2B:3C:4D:5E\n- Identifies device\n- Used to track device\n\n**Hostname**: Device name\n- Example: \"johnsmith-laptop\"\n- Identifies owner/purpose\n\n**OS**: Operating system\n- Windows, macOS, Linux\n- Affects policy baseline\n\n**Software**: Installed applications, versions\n- Inventory: What's running\n- Security: Check for prohibited software\n\n**Purpose**: Track and inventory all devices\n- Know what's on network\n- Detect unauthorized devices\n- Track compliance\n\n## PART 3: COMPLIANCE CHECKING\n\n### Endpoint Security Checks\n\n**Antivirus**: **RUNNING AND UPDATED?**\n- Real-time scanning enabled\n- Signatures up to date\n- Running (not disabled)\n\n**Firewall**: OS firewall enabled? **YES**\n- Windows Firewall or equivalent\n- Enabled for all profiles\n- Not disabled by user\n\n**Patches**: Windows/macOS/Linux up to date? **YES**\n- Within 30-60 days of release\n- Security updates applied\n- No critical patches pending\n\n**Disk encryption**: BitLocker/FileVault enabled? **YES**\n- Prevents data theft if lost\n- Device recovered: Data still encrypted\n- HIPAA requirement\n\n**Password policy**: Strong passwords enforced? **YES**\n- 12+ characters\n- Complex (uppercase, numbers, symbols)\n- Not dictionary words\n\n**Antimalware**: Real-time scanning enabled? **YES**\n- Active protection\n- Quarantine threats\n- Behavioral analysis\n\n### Health Check Results\n\n**Compliant**: **PASSES ALL CHECKS**\n- All security checks pass\n- Device allowed full access\n- VLAN assignment: Corporate network\n\n**Partially compliant**: **FAILS SOME CHECKS**\n- Some security issues\n- Quarantine recommended\n- Example: Patches missing, but AV enabled\n\n**Non-compliant**: **FAILS MAJOR CHECKS**\n- Critical security issues\n- Quarantine mandatory\n- Example: No antivirus, no patches\n- Action: Prevent network access until fixed\n\n**Action**: Depending on result, grant or restrict access\n\n### HealthCare Plus Baseline Policy\n\n**Device MUST have**:\n- [x] Antivirus (enabled, updated)\n- [x] Windows Defender or equivalent\n- [x] Firewall enabled (Windows or OS native)\n- [x] OS patches (within 30 days of release)\n- [x] Screen lock (5-minute timeout)\n- [x] Strong password (12+ characters, complex)\n- [x] Disk encryption (BitLocker for Windows)\n- [x] No unauthorized software\n- [x] Mobile device management (MDM) enrolled\n- [x] HIPAA privacy notice accepted\n\n**Failure**: Device quarantined to remediation network\n- Access restricted\n- Only patch/AV servers reachable\n- Automatic remediation attempted\n- Re-check after fixes\n\n## PART 4: NETWORK SEGMENTS AND VLANs\n\n### NAC-Enforced Network Segments\n\n**Trusted network**: **FULL ACCESS**\n- Compliant company laptops\n- Company desktops\n- Restrictions: Normal firewall rules\n- Access to: All corporate systems\n\n**Untrusted/Guest network**: **LIMITED ACCESS**\n- Contractor devices, BYOD\n- Example: Personal laptop, contractor laptop\n- Restrictions: Internet only (cannot access corporate systems)\n- Access: Outside-only (web, email)\n\n**Quarantine/Remediation network**: **ISOLATED**\n- Non-compliant devices\n- Example: Device with missing patches\n- Restrictions: Access to patch/AV servers only\n- Goal: Fix device, then move to trusted\n- Remediation: Automatic patching, AV updates\n\n**Medical/IoT network**: **SPECIALIZED**\n- Patient monitors, medical equipment\n- Example: Old monitor (no patches possible)\n- Restrictions: Limited (cannot patch, special handling)\n- Monitoring: Extra scrutiny (critical infrastructure)\n- Exception: Custom policy (not standard baseline)\n\n### VLAN Assignment Based on Compliance\n\n**Process**:\n1. Device connects to network switch\n2. MAC address captured\n3. Health check performed (via NAC)\n4. Result: Compliant or non-compliant\n5. Action: Assign VLAN based on result\n\n**VLAN assignment example**:\n- Compliant device: **VLAN 100** (Corporate network)\n  - Full access\n  - All systems reachable\n- Non-compliant device: **VLAN 200** (Quarantine)\n  - Limited access\n  - Only patch servers\n- Contractor device: **VLAN 300** (Guest)\n  - Internet only\n  - No corporate access\n- Medical equipment: **VLAN 400** (Medical)\n  - Specialized policy\n  - Extra monitoring\n\n**Why VLANs**: **ENFORCE NETWORK ISOLATION**\n- Separate networks\n- Prevent lateral movement\n- Control traffic between VLANs\n- Firewall rules per VLAN\n\n## PART 5: QUARANTINE AND REMEDIATION\n\n### Device Detected Non-Compliant\n\n**Scenario**: Employee laptop missing Windows patches\n\n**Detection**:\n- NAC check: \"Windows not patched in 45 days\" (exceeds 30-day policy)\n- Status: **Non-compliant**\n- Action: **Quarantine**\n\n**Quarantine process**:\n- Move device to **VLAN 200** (quarantine network)\n- Restrict: Only to patch server\n- Alert: Employee and IT about non-compliance\n- Cause: Which check failed? (patches, AV, firewall)\n\n**Remediation**:\n- Patch server: Provides updates automatically\n- Employee experiences: Slow downloads (restricted bandwidth)\n- Incentive: Get patched to rejoin trusted network\n- Timeline: Patches download (hours to days)\n- Automatic: Windows Update downloads patches\n\n**Re-check**:\n- After patches applied: Re-run health check\n- Pass: Move back to **trusted VLAN 100**\n- Fail: Continue quarantine (other issues need fixing)\n- Timeline: Re-check within 24 hours\n\n### Contractor Device Onboarding\n\n**Scenario**: Contractor arrives with personal laptop\n\n**Process**:\n- Register: MAC address, hostname, ownership\n- Policy: Contractor network policies (more restrictive)\n- Baseline: Lower baseline (what baseline applies?)\n  - Antivirus required (but older versions OK)\n  - Patches within 60 days (vs 30 for company)\n  - Encryption optional (vs required for company)\n- Check: Health check against contractor policy\n- Result: May not pass company baseline\n- Decision: Allow to **Guest network (VLAN 300)**\n- Access: Internet only, cannot access internal systems\n- Duration: Limited (contractor end date)\n\n**Advantage**: Security (limited access) vs usability (contractor can work)\n- Security: Device isolated (cannot harm company systems)\n- Usability: Contractor can access internet, email\n- Compromise: Both sides benefit\n\n## PART 6: DEVICE NON-COMPLIANCE ISSUES\n\n### Medical Device Dilemma\n\n**Scenario**: Patient monitor WiFi module (10 years old)\n\n**Reality**:\n- OS: Unknown (proprietary firmware)\n- Patches: None available (manufacturer stopped support)\n- Antivirus: No (embedded device)\n- Firewall: No\n- Password: Default (\"admin\")\n- Security: Multiple vulnerabilities known\n- Patching: Impossible (manufacturer support ended)\n\n**NAC dilemma**:\n- Policy: Would block (non-compliant)\n- Reality: Critical medical device (cannot block)\n- Trade-off: Critical business need vs security risk\n\n**Solution**:\n- Exception: Create special policy for medical devices\n- Isolation: Put on separate VLAN (medical network)\n- Monitoring: Extra scrutiny (IDS/IPS monitoring)\n- Mitigation: Network-level controls (not device-level)\n- Document: Risk accepted, mitigation in place\n- Firewall: Restrict device to only needed ports\n- Network segmentation: Prevents lateral movement\n- Future: Plan for replacement (5-year roadmap)\n\n### BYOD Complications\n\n**Employee personal laptop** (macOS, 3 years old)\n\n**Issues**:\n- Antivirus: Not installed (thinks not needed)\n- Patches: Outdated (6 months behind)\n- Disk encryption: Not enabled (personal preference)\n- Password: Weak (\"Welcome123\")\n- Policy: Fails NAC checks\n\n**Options**:\n1. Block completely (employee cannot work, bad experience)\n2. Quarantine (employee fixes issues)\n3. Guest network (limited access, not useful for work)\n4. Exception (risk accepted)\n\n**Recommendation**: **Quarantine + support**\n- Provide: Patches, AV installation help\n- Timeline: 2-3 days (employee can remediate)\n- Re-check: After fixes applied\n- Support: Help desk assists (not employee's responsibility)\n- Incentive: Get patched to join trusted network\n\n## PART 7: NAC POLICY EXAMPLES\n\n### Access Policies\n\n**Company Desktop** (most strict):\n- Antivirus: Required, updated ✓\n- Patches: Within 30 days ✓\n- Encryption: Required (BitLocker) ✓\n- Firewall: Enabled ✓\n- Access: Full corporate network ✓\n\n**Company Laptop** (strict):\n- Same as desktop ✓\n- Mobile: Can roam (not always connected) ✓\n- VPN: Required when remote ✓\n- Network: Full access when connected ✓\n\n**BYOD/Contractor** (moderate):\n- Antivirus: Required ✓\n- Patches: Within 60 days ✓\n- Encryption: Recommended (optional) ✓\n- Firewall: Enabled ✓\n- Access: Guest network (internet only) ✓\n\n**Guest WiFi** (least strict):\n- No checks (open) ✓\n- Open WiFi (anyone can connect) ✓\n- Access: Internet only ✓\n- Isolation: Cannot see corporate network ✓\n\n### Policy Enforcement\n\n**At connection time**:\n- Device connects to network\n- NAC triggered\n- Health check performed\n- Policy applied (VLAN assignment)\n- Enforcement: Immediate\n\n**Continuous monitoring**:\n- Periodic re-checks (every 24 hours)\n- Malware detected: Quarantine device\n- Firewall disabled: Alert and restrict\n- New software: Detect and respond\n- Automatic: Re-evaluation on network change\n\n## PART 8: NAC IMPLEMENTATION CHALLENGES\n\n### Legacy Systems\n\n**Old server running Windows Server 2003**\n\n**Problem**:\n- No NAC support (very old)\n- Cannot update (critical application depends on 2003)\n- Must stay on network (production system)\n- Cannot meet security baseline\n\n**Solution options**:\n1. Exception: Accept risk\n2. Network segmentation: Isolate on special VLAN\n3. Manual approval: IT manually verifies and grants access\n4. Air-gap: Disconnect from network entirely\n\n**Recommendation**: **Segment + monitor**\n- Put on isolated VLAN\n- Extra monitoring (IDS on that VLAN)\n- Firewall rules (only needed services)\n- Plan replacement (5-year roadmap)\n- Accept risk: Documented and monitored\n\n### Non-Compliant by Design\n\n**Industrial control system** (temperature sensor network)\n\n**Reality**:\n- Embedded Linux (cannot patch)\n- Default password (cannot change)\n- No firewall (not supported)\n- Critical system (cannot disconnect)\n\n**NAC approach**:\n- Exception: Create custom policy for control systems\n- Isolation: Separate VLAN\n- Network controls: Firewall rules (not device level)\n- Monitoring: Extra scrutiny\n- Security: Defense in depth (network + physical)\n- Manual verification: IT approves access\n- Physical security: Limit access to device room\n\n## PART 9: IMPLEMENTATION ROADMAP\n\n### NAC Deployment Phases\n\n**Phase 1** (Months 1-2): **Pilot**\n- Scope: **ONE DEPARTMENT/HOSPITAL**\n- Devices: **50-100 DEVICES**\n- Goal: Test and refine policies\n- Learn: What devices break? What policies too strict?\n- Outcome: Refined policies, lessons learned\n\n**Phase 2** (Months 3-6): **Gradual rollout**\n- Scope: **ONE HOSPITAL AT A TIME**\n- Devices: **ALL EMPLOYEES AT HOSPITAL** (~500-1,000 devices per hospital)\n- Support: Help desk trained (issues will occur)\n- Feedback: Collect issues, tune policies\n- Timeline: 2 hospitals per month\n\n**Phase 3** (Months 7-12): **Full deployment**\n- Scope: **ALL 10 HOSPITALS**\n- Devices: **ALL 5,000 DEVICES**\n- Ongoing: Monitoring and tuning\n- Operations: Steady-state NAC enforcement\n- Support: Mature help desk processes\n\n**Timeline**: **12 MONTHS TOTAL**\n\n### Cost and Resources\n\n- NAC platform: **$150,000-250,000** (software + hardware)\n- Professional services: **$50,000-100,000** (implementation)\n- Training: **$25,000-50,000** (IT staff)\n- Ongoing support: **$30,000-50,000** (annual)\n- **Total Year 1**: **$255,000-450,000** (equipment + setup)\n- **Year 2+**: **$80,000-150,000** (support + maintenance + upgrades)\n\n### Compliance Verification\n\n**HIPAA requirement**: Ensure access controls\n- NAC enforces: Devices must meet baseline\n- Patch management: Automatic enforcement\n- Antivirus: Required, monitored\n- Encryption: Mandatory\n\n**Audit trail**:\n- Log: What devices connected\n- Log: Policy check results\n- Log: Remediation actions\n- Evidence: Proof of compliance\n- Retention: Multi-year archive\n- Compliance report: Available for auditors\n\n### EDR Integration\n\n**EDR tool**: Advanced threat detection on endpoints\n\n**Integration**:\n- EDR detects: Malware, suspicious behavior\n- Signal to NAC: \"Device compromised\"\n- NAC action: Quarantine device immediately\n- Workflow: EDR → NAC → isolation\n\n**Benefit**: Automated response\n- No human delay\n- Infected device removed immediately\n- Prevents spread\n- Faster incident response\n- Reduced damage from malware\n\n**Example workflow**:\n1. Malware detected on laptop (EDR alert)\n2. EDR sends signal to NAC\n3. NAC quarantines device (VLAN 200)\n4. Device isolated: Cannot communicate\n5. Incident team: Investigates offline\n6. Device: Cleaned and re-checked\n7. If clean: Return to trusted network",
  "hints": [
    "NAC evaluates compliance before allowing network access; determines VLAN assignment",
    "Device classification: managed (strict), BYOD (moderate), contractor (guest), medical (exception)",
    "Quarantine network: isolated, limited access, automatic remediation",
    "VLAN assignment enforces isolation: compliant on trusted, non-compliant on quarantine",
    "Medical devices often cannot meet baseline; create exceptions with network-level mitigations",
    "BYOD devices support worker mobility but need baseline enforcement",
    "Continuous monitoring: periodic re-checks, alert on firewall disable, detect malware",
    "EDR integration: malware detection → NAC quarantine (automated response)",
    "Legacy systems may need exceptions; segment with network controls",
    "Phased rollout: pilot → gradual rollout → full deployment over 12 months"
  ],
  "testCases": [
    {"id": "tc1-nac-basics", "description": "NAC fundamentals", "input": "Device compliance evaluation", "expected": "Check against policy, assign VLAN", "assert": "assert ('nac' in solution.lower() or 'access' in solution.lower() or 'compliance' in solution.lower())"},
    {"id": "tc2-classification", "description": "Device types", "input": "Managed vs BYOD vs contractor", "expected": "Different policies for each", "assert": "assert ('managed' in solution.lower() or 'byod' in solution.lower() or 'contractor' in solution.lower())"},
    {"id": "tc3-quarantine", "description": "Quarantine process", "input": "Non-compliant device", "expected": "Isolated, limited access, remediation", "assert": "assert ('quarantine' in solution.lower() or 'remediat' in solution.lower() or 'isolat' in solution.lower())"},
    {"id": "tc4-vlan", "description": "VLAN assignment", "input": "Network segmentation", "expected": "Compliant/non-compliant VLANs", "assert": "assert ('vlan' in solution.lower() or 'segment' in solution.lower() or 'assign' in solution.lower())"},
    {"id": "tc5-medical", "description": "Medical device exception", "input": "Non-compliant device required", "expected": "Create exception policy, isolate, monitor", "assert": "assert ('medical' in solution.lower() or 'exception' in solution.lower() or 'isolat' in solution.lower())"},
    {"id": "tc6-checks", "description": "Compliance checks", "input": "Antivirus, patches, encryption", "expected": "Multiple checks performed", "assert": "assert ('antivirus' in solution.lower() or 'patch' in solution.lower() or 'encrypt' in solution.lower())"},
    {"id": "tc7-byod", "description": "BYOD handling", "input": "Personal device", "expected": "Lower baseline, guest network", "assert": "assert ('byod' in solution.lower() or 'personal' in solution.lower() or 'guest' in solution.lower())"},
    {"id": "tc8-remediation", "description": "Auto-remediation", "input": "Patch servers, AV updates", "expected": "Automatic fixes in quarantine", "assert": "assert ('remediat' in solution.lower() or 'patch' in solution.lower() or 'automatic' in solution.lower())"},
    {"id": "tc9-edr", "description": "EDR integration", "input": "Malware detection", "expected": "EDR alerts NAC, device quarantined", "assert": "assert ('edr' in solution.lower() or 'malware' in solution.lower() or 'alert' in solution.lower())"},
    {"id": "tc10-phases", "description": "Implementation roadmap", "input": "Deployment timeline", "expected": "Pilot, gradual, full deployment", "assert": "assert ('phase' in solution.lower() or 'pilot' in solution.lower() or 'rollout' in solution.lower())"}
  ]
}
