{
  "id": "exercise-022-network-devices",
  "lessonId": "lesson-022-network-devices",
  "title": "Network Devices: Functions, OSI Layers, Placement, and Design Scenarios",
  "description": "You are a network architect designing comprehensive network infrastructure for your organization. Complete realistic scenarios involving network device selection, OSI layer understanding, network segmentation, security implementation, and troubleshooting device placement in complex multi-tier networks.",
  "difficulty": "advanced",
  "points": 100,
  "language": "cisco-ios",
  "starterCode": "# ============================================================================\n# NETWORK CONTEXT - COMPREHENSIVE INFRASTRUCTURE DESIGN\n# ============================================================================\n# Your company is designing a complete network infrastructure from scratch.\n# You need to select appropriate devices for each layer and justify placement.\n#\n# Current Requirements:\n# - 500 employees across 3 buildings\n# - Internet connectivity (50 Mbps)\n# - Multiple applications (web servers, databases, VoIP phones)\n# - E-commerce website with high traffic\n# - Remote branch offices with slow WAN links\n# - Need to protect against external attacks\n# - Need redundancy for critical services\n#\n# Architecture to Design:\n# [Internet] → [Firewall] → [Router] → [Load Balancer] → [Web Servers]\n#                                    ↓\n#                          [Layer 3 Switch]\n#                                    ↓\n#                          [Access Layer Switches]\n#                                    ↓\n#                    [Wireless APs] [Computers] [Printers]\n#\n# You must select and justify each device in this architecture.\n#\n# ============================================================================\n\n# ============================================================================\n# SCENARIO 1: UNDERSTANDING NETWORK DEVICE LAYERS\n# ============================================================================\n# All network devices operate at specific OSI layers.\n# Understand which layer = understand what the device can see/do.\n#\n# TASK 1.1: Match device to OSI layer\n# \n# Device → OSI Layer (or layers)\n#\n# Hub: Layer __________ (Physical / Data Link / Network)\n# Repeater: Layer __________ \n# Media Converter: Layer __________\n# Switch (L2): Layer __________\n# Wireless Access Point: Layer __________ \n# Router: Layer __________\n# Layer 3 Switch: Layers __________ and __________\n# Firewall: Layers __________ through __________ (depends on type)\n# Load Balancer: Layer __________ (or Layer 7 for advanced)\n# Proxy Server: Layer __________\n#\n# TASK 1.2: What can each device \"see\"?\n# \n# Device at Layer 1 (Physical):\n# - Can inspect: __________\n# - Cannot inspect: MAC addresses / IP addresses / Application data\n# - Example decision: Forward / Amplify signal / Drop packet\n#\n# Device at Layer 2 (Data Link):\n# - Can inspect: MAC addresses\n# - Cannot inspect: IP addresses / Port numbers / Application data\n# - Example decision: __________\n#\n# Device at Layer 3 (Network):\n# - Can inspect: IP addresses (and everything in Layer 2)\n# - Cannot inspect: __________ (port numbers would be L4+)\n# - Example decision: __________\n#\n# Device at Layer 4 (Transport):\n# - Can inspect: __________\n# - Cannot inspect: __________\n# - Example decision: Forward based on port number\n#\n# Device at Layer 7 (Application):\n# - Can inspect: Everything (HTTP request content, URLs, etc.)\n# - Example decision: __________\n#\n\n# ============================================================================\n# SCENARIO 2: HUB VS SWITCH COMPARISON\n# ============================================================================\n# This is a foundational comparison every network tech must understand.\n#\n# TASK 2.1: Hub operation\n# When frame arrives on port 1 of 8-port hub:\n# - Hub forwards frame to: __________ (which ports?)\n# - Type of operation: __________\n# - All users share: One collision domain / Multiple domains\n# - Forwarding speed: Wire-speed / Switching time required\n# - VLAN support: Yes / No __________\n#\n# TASK 2.2: Switch operation\n# When frame arrives on port 1 of 8-port switch:\n# - Switch learns: Source MAC on port 1\n# - Switch looks up: Destination MAC\n# - If destination known: Forwards to specific port only\n# - If destination unknown: Floods to all ports except source\n# - Each port has: Separate collision domain / Shared domain\n# - Forwarding speed: Wire-speed __________\n# - VLAN support: Yes __________\n#\n# TASK 2.3: Performance comparison (8 connected devices)\n# Hub scenario:\n# - Collision domain: 1 (all 8 devices compete)\n# - Usable bandwidth per device: ~1/8 of total = __________ Mbps (from 100 Mbps link)\n# - Forwarding efficiency: __________\n# - Status in modern networks: Obsolete / Standard __________\n#\n# Switch scenario:\n# - Collision domain: 8 (one per port)\n# - Usable bandwidth per device: Full __________ Mbps\n# - Forwarding efficiency: Highly efficient\n# - Status in modern networks: Obsolete / Standard (Standard)\n#\n# TASK 2.4: When would you use a hub?\n# Answer: __________\n# (Honest answer: Never in modern networks)\n#\n\n# ============================================================================\n# SCENARIO 3: ROUTER VS LAYER 3 SWITCH COMPARISON\n# ============================================================================\n#\n# TASK 3.1: Router function\n# Router operates at: Layer __________ (Network)\n# Makes decisions based on: __________\n# Creates: __________ broadcast domains per interface\n# Speed of routing lookup: Uses CPU software routing\n# Typical placement: __________ (branch office, WAN gateway, etc.)\n#\n# Example routing:\n# Packet arrives destined to 10.0.0.0/8\n# Router checks: Routing table\n# Router forwards to: __________ (next-hop IP)\n# Router decrements: __________ (field in packet header)\n#\n# TASK 3.2: Layer 3 Switch function\n# Layer 3 Switch operates at: Layers __________ and __________\n# Makes decisions based on: MAC addresses (L2) and IP addresses (L3)\n# Creates: __________ broadcast domains per VLAN\n# Speed of routing lookup: Hardware-based (ASIC) - __________ than router\n# Typical placement: __________ (data center core, enterprise backbone)\n#\n# Example inter-VLAN routing:\n# Packet arrives on VLAN 10\n# L3 Switch routes to: VLAN 20\n# Speed: Wire-speed (as fast as switching)\n#\n# TASK 3.3: When to use each\n#\n# Use Router when:\n# 1. __________\n# 2. __________\n# 3. __________\n#\n# Use Layer 3 Switch when:\n# 1. __________\n# 2. __________\n# 3. __________\n#\n# TASK 3.4: Can they coexist?\n# Can router and L3 switch exist in same network? Yes / No __________\n# Example topology: __________\n#\n\n# ============================================================================\n# SCENARIO 4: FIREWALL TYPES AND SELECTION\n# ============================================================================\n# Three firewall types, each appropriate for different scenarios.\n#\n# TASK 4.1: Packet-Filtering Firewall\n# OSI Layer: __________\n# Information examined: Source IP / Dest IP / Source Port / Dest Port / Protocol\n# Stateful? Yes / No __________\n# Decision making: __________\n# Speed: Fast / Slow __________\n# Security level: Low / Medium / High __________\n# Example scenario: __________\n#\n# TASK 4.2: Stateful Firewall\n# OSI Layer: __________\n# Tracks: Connection state (TCP handshake, session establishment)\n# Allows: Return traffic automatically (without explicit rule)\n# Example: \n#   Rule: Allow outbound HTTP to any destination\n#   Return traffic (inbound HTTP responses): Allow / Deny __________\n#   Why? __________\n# \n# Speed: Faster / Slower than packet-filtering __________\n# Security: Better / Worse than packet-filtering __________\n#\n# TASK 4.3: Next-Generation Firewall (NGFW)\n# OSI Layer: __________\n# Inspection depth: Deep packet inspection (DPI)\n# What it can see: Application layer content (HTTP URLs, data, etc.)\n# Example capabilities:\n# 1. Can block YouTube even though port 80/443 allowed? Yes / No __________\n# 2. Can block specific file types (MP3, EXE)? Yes / No __________\n# 3. Can detect malware in traffic? Yes / No __________\n# 4. Can implement QoS (prioritize video traffic)? Yes / No __________\n#\n# Speed/Cost: Expensive / Requires more CPU __________\n# Use case: __________\n#\n# TASK 4.4: Firewall placement in your design\n# Where in architecture? [Internet] → [Firewall] → [Router] → [L3 Switch] → [APs/Computers]\n#\n# Best location: Between __________ and __________\n# Why that location? __________\n# What should it protect against? __________\n#\n\n# ============================================================================\n# SCENARIO 5: LOAD BALANCER OPERATION\n# ============================================================================\n#\n# TASK 5.1: Why load balancing needed\n# Your company operates 3 web servers\n# Without load balancer: All users connect to Server 1? Yes / No __________\n# Why? __________\n#\n# With load balancer: Traffic distributed across 3 servers\n# Advantage: __________\n#\n# TASK 5.2: Load balancing algorithms\n#\n# Round Robin:\n# Request 1 → Server __________\n# Request 2 → Server __________\n# Request 3 → Server __________\n# Request 4 → Server __________\n# Pattern: Each server gets turn in sequence\n#\n# Least Connections:\n# Server 1: 15 active connections\n# Server 2: 8 active connections\n# Server 3: 12 active connections\n# New request sent to: Server __________\n# Why? __________\n#\n# IP Hash:\n# Client IP 192.168.1.100 → Server __________ (always same)\n# Client IP 192.168.1.101 → Server __________ (always same)\n# Same client different requests → Same server?\n# Why important? Session persistence / Stickiness\n#\n# TASK 5.3: Health checks\n# Load balancer monitors each server:\n# - Server 1: Responding normally\n# - Server 2: Not responding\n# - Server 3: Responding normally\n#\n# New requests: Load balancer sends to __________\n# When Server 2 recovers: __________\n#\n# TASK 5.4: Types of load balancers\n#\n# Layer 4 (Transport)\n# Examines: Source/Dest IP, Ports, TCP/UDP\n# Decision: Forward packet to server based on port/IP\n# Examples: HAProxy, Citrix NetScaler\n#\n# Layer 7 (Application)\n# Examines: Application data (URLs, hostnames, etc.)\n# Decision: More intelligent routing\n# Example: Send /api/ to API servers, /static/ to static servers\n# More flexible? Yes / No __________\n#\n\n# ============================================================================\n# SCENARIO 6: SECURITY DEVICES - IDS vs IPS\n# ============================================================================\n#\n# TASK 6.1: IDS (Intrusion Detection System)\n# Function: Detect attacks and alert / Block attacks __________\n# Deployment: Passive monitoring or active blocking __________\n# How it monitors: __________\n# Example alert: \"Possible SQL injection detected from 192.168.1.50\"\n# Action: Alert administrator / Automatically block __________\n# Advantage: __________\n# Disadvantage: __________\n#\n# TASK 6.2: IPS (Intrusion Prevention System)\n# Function: Detect attacks and alert / Block attacks __________\n# Deployment: Inline (all traffic passes through)\n# How it blocks: __________\n# Example: Detects SQL injection, drops packet immediately\n# Advantage: Proactive, stops attacks __________\n# Disadvantage: False positives can block legitimate traffic\n#\n# TASK 6.3: Which would you use?\n# Scenario A: High-security government facility\n#   Use: IDS / IPS __________ (Why? __________)\n#\n# Scenario B: Startup with limited budget\n#   Use: IDS / IPS __________ (Why? __________)\n#\n# TASK 6.4: Relationship to firewall\n# Is IPS same as firewall? Yes / No __________\n# Firewall blocks based on: __________\n# IPS blocks based on: __________\n# Can both exist? Yes / No __________\n#\n\n# ============================================================================\n# SCENARIO 7: PROXY SERVERS\n# ============================================================================\n#\n# TASK 7.1: Forward Proxy\n# Client setup: __________\n# Data flow: Client → Proxy → Server → Proxy → Client\n# Client appears to server as: The proxy / The real client __________\n# Server sees: Proxy IP address / Client IP address __________\n# Use cases:\n# 1. __________\n# 2. __________\n# 3. __________\n#\n# Example scenario: Corporate web filtering\n# Employee tries to visit www.instagram.com\n# Proxy intercepts, checks URL, blocks (policy violation)\n# Employee sees: __________\n#\n# TASK 7.2: Reverse Proxy\n# Server-side setup (vs client-side for forward proxy)\n# Data flow: Internet → Reverse Proxy → Internal Servers\n# External users appear to connect to: One address (proxy) / Multiple servers __________\n# Actual servers are: Visible / Hidden __________\n# Use cases:\n# 1. Load balancing (already covered)\n# 2. __________\n# 3. __________\n#\n# Example: www.company.com → Reverse Proxy → Server Pool 1, 2, 3\n# User sees: One website / Three different servers __________\n#\n# TASK 7.3: Proxy features\n# Content filtering: __________\n# Caching: __________\n# Anonymity: __________\n# Authentication: __________\n#\n# TASK 7.4: Is proxy same as firewall?\n# No, different purposes\n# Firewall: __________\n# Proxy: __________\n# Can both exist? Yes / No __________\n# Where in network? __________\n#\n\n# ============================================================================\n# SCENARIO 8: COMPLETE NETWORK DESIGN\n# ============================================================================\n# Design the full architecture with device placement and justification\n#\n# TASK 8.1: Draw the architecture\n# [INTERNET]\n#     ↓\n# [Device A: __________] - Why? Protect network from external threats\n#     ↓\n# [Device B: __________] - Why? Route between external and internal networks\n#     ↓\n# [Device C: __________] - Why? Load balance web traffic\n#     ↓\n# [Device D: __________] - Why? Route between VLANs, provide inter-VLAN routing\n#     ↓ (Branch out)\n#   [Device E: __________] - Why? Provide wireless connectivity\n#   [Device E: __________] - Why? Provide wired connectivity for computers\n#   [Device E: __________] - Why? Monitor security threats\n#\n# TASK 8.2: Justify each device\n# \n# Device A (Firewall):\n# Type recommended: Packet / Stateful / NGFW __________ (Choose and justify)\n# Justification: __________\n#\n# Device B (Router):\n# Function: __________\n# Where connected: Internet side / Internal network side __________\n#\n# Device C (Load Balancer):\n# Purpose: __________\n# Algorithm recommended: __________\n#\n# Device D (L3 Switch):\n# Function: __________\n# Why here instead of router: __________\n#\n# Device E (Wireless AP):\n# Type: Autonomous / Lightweight __________\n# Function: __________\n#\n# Device E (Access Switch):\n# Function: __________\n# Features needed: VLAN support / Port security __________\n#\n# Device E (IDS/IPS):\n# Placement: Between devices __________ and __________\n# Type: IDS / IPS __________ (and why)\n#\n# TASK 8.3: Data flow example\n# User on WiFi wants to access web server\n# Packet path: WiFi AP → __________ → __________ → __________ → __________ → Web Server\n#\n# Each device processes at appropriate layer\n#\n# TASK 8.4: Redundancy\n# What if one device fails?\n# - Firewall fails: __________\n# - Load Balancer fails: __________\n# - L3 Switch fails: __________\n# - Access Switch fails: __________\n# - Web Server fails: __________\n#\n# Design strategy: __________\n#\n\n# ============================================================================\n# SCENARIO 9: SPECIALIZED DEVICES\n# ============================================================================\n#\n# TASK 9.1: Media Converter\n# Function: __________\n# Example: Convert __________ to __________\n# Why needed? __________\n# OSI Layer: __________\n#\n# TASK 9.2: WAN Optimizer\n# Company has headquarters and branch office\n# WAN link limited to 5 Mbps (expensive)\n# WAN Optimizer techniques:\n# 1. Data compression: __________\n# 2. Deduplication: __________\n# 3. Caching: __________\n#\n# Result: Effective bandwidth feels faster without upgrading WAN\n#\n# TASK 9.3: Content Delivery Network (CDN)\n# E-commerce site visited from multiple countries\n# Without CDN: All requests go to one data center\n#   Problem: __________\n#\n# With CDN: Content cached at edge servers worldwide\n#   Benefit: __________\n#\n# TASK 9.4: VoIP Gateway\n# Function: __________\n# Why needed: __________\n# Example scenario: __________\n#\n\n# ============================================================================\n# SCENARIO 10: TROUBLESHOOTING DEVICE PLACEMENT\n# ============================================================================\n#\n# TASK 10.1: Device selection errors\n# Problem: \"Network is too slow!\"\n# Investigation finds: Hub is connecting 20 computers\n# Issue: Hub broadcasts all traffic to all ports (collision domain)\n# Solution: Replace with __________\n# Why: __________\n#\n# TASK 10.2: Firewall problem\n# Firewall denies SSH traffic (port 22) to internal servers\n# Administrator wants to allow SSH from Internet\n# Does stateful firewall help? Yes / No __________\n# Why? __________\n# Solution: __________\n#\n# TASK 10.3: Load balancer false positive\n# Load balancer removes Server 2 due to health check failure\n# But Server 2 is actually working\n# What happened? __________\n# Investigation: Server 2 network card flaky, missing responses\n# Solution: __________\n#\n# TASK 10.4: Architecture problem\n# Company only has one router to Internet\n# Internet outage = complete network outage\n# Problem: __________\n# Solution: __________\n#\n",
  "solution": "# ============================================================================\n# SCENARIO 1: UNDERSTANDING NETWORK DEVICE LAYERS (SOLUTIONS)\n# ============================================================================\n\n# TASK 1.1: Device to OSI layer matching\n#\n# Hub: Layer 1 (Physical)\n# Repeater: Layer 1 (Physical)\n# Media Converter: Layer 1 (Physical)\n# Switch (L2): Layer 2 (Data Link)\n# Wireless Access Point: Layer 2 (Data Link)\n# Router: Layer 3 (Network)\n# Layer 3 Switch: Layers 2 and 3\n# Firewall: Layers 3 through 7 (packet-filtering=3/4, stateful=3/4, NGFW=up to 7)\n# Load Balancer: Layer 4 (or Layer 7 for advanced)\n# Proxy Server: Layer 7 (Application)\n#\n# TASK 1.2: What each layer can see\n#\n# Layer 1 Device:\n# - Can inspect: Electrical signals, bits (1s and 0s)\n# - Cannot inspect: MAC addresses, IP addresses, Application data\n# - Example decision: Forward / Amplify signal / Regenerate\n#\n# Layer 2 Device:\n# - Can inspect: MAC addresses (from Ethernet frame header)\n# - Cannot inspect: IP addresses, Port numbers, Application data\n# - Example decision: Forward to specific port based on MAC address\n#\n# Layer 3 Device:\n# - Can inspect: IP addresses (from packet header)\n# - Cannot inspect: Port numbers (in Layer 4 header)\n# - Example decision: Forward to next-hop IP based on routing table\n#\n# Layer 4 Device:\n# - Can inspect: Source/Dest ports (TCP/UDP headers)\n# - Cannot inspect: Application layer content\n# - Example decision: Forward based on port number\n#\n# Layer 7 Device:\n# - Can inspect: Everything (HTTP request content, URLs, data payload)\n# - Example decision: Block specific URLs, filter by application\n#\n\n# ============================================================================\n# SCENARIO 2: HUB VS SWITCH COMPARISON (SOLUTIONS)\n# ============================================================================\n\n# TASK 2.1: Hub operation\n# When frame arrives on port 1 of 8-port hub:\n# - Forwards to: All ports except the source port (ports 2-8)\n# - Type of operation: Broadcasting (floods to all ports)\n# - All users share: One collision domain\n# - Forwarding speed: Wire-speed (but all links contend)\n# - VLAN support: No\n#\n# TASK 2.2: Switch operation\n# When frame arrives on port 1 of 8-port switch:\n# - Learns: Source MAC mapped to port 1\n# - If destination known: Forwards to specific port only (unicast)\n# - If destination unknown: Floods to all ports except source (learning phase)\n# - Each port has: Separate collision domain\n# - Forwarding speed: Wire-speed (no contention between ports)\n# - VLAN support: Yes\n#\n# TASK 2.3: Performance comparison\n#\n# Hub scenario:\n# - Collision domain: 1 (all 8 devices contend for transmission)\n# - Usable bandwidth per device: ~12.5 Mbps (from 100 Mbps, divided among 8)\n# - Forwarding efficiency: Poor (collisions, retransmissions)\n# - Status: Obsolete\n#\n# Switch scenario:\n# - Collision domain: 8 (one per port, no contention)\n# - Usable bandwidth per device: Full 100 Mbps\n# - Forwarding efficiency: Excellent (no collisions)\n# - Status: Standard\n#\n# TASK 2.4: When to use hub\n# Answer: Never (only in museums or as part of history lessons)\n# Historical context: Used before switches became affordable (1980s-1990s)\n#\n\n# ============================================================================\n# SCENARIO 3: ROUTER VS LAYER 3 SWITCH COMPARISON (SOLUTIONS)\n# ============================================================================\n\n# TASK 3.1: Router function\n# Operates at: Layer 3 (Network)\n# Decisions based on: Destination IP address\n# Creates: Separate broadcast domain per interface\n# Routing lookup speed: Software-based (slower than hardware)\n# Typical placement: WAN gateway, branch office, connection point between networks\n#\n# Example routing:\n# Packet destined to 10.0.0.0/8\n# Router checks: Routing table for 10.0.0.0/8\n# Forwards to: Next-hop IP address (e.g., 192.168.1.1)\n# Decrements: TTL (Time To Live field in IP header)\n#\n# TASK 3.2: Layer 3 Switch function\n# Operates at: Layers 2 and 3\n# Decisions based on: MAC addresses (L2) and IP addresses (L3)\n# Creates: Separate broadcast domain per VLAN (using SVIs)\n# Speed: Hardware-based (ASIC) = much faster than router\n# Typical placement: Data center core, enterprise backbone, inter-VLAN routing\n#\n# TASK 3.3: When to use each\n#\n# Use Router when:\n# 1. Connecting to external networks (ISP WAN links)\n# 2. Need advanced routing protocols (BGP, OSPF)\n# 3. Need NAT/PAT for address translation\n# 4. WAN connectivity with branch offices\n#\n# Use Layer 3 Switch when:\n# 1. High-speed inter-VLAN routing needed (data center)\n# 2. Core network connectivity between buildings\n# 3. Scalable internal network design\n# 4. Wire-speed routing performance required\n#\n# TASK 3.4: Can they coexist?\n# Yes, absolutely\n# Example topology:\n# [Internet] → [Router] → [L3 Switch] → [Access Layer Switches] → [Computers]\n# Router handles external routing, L3 switch handles internal VLANs\n#\n\n# ============================================================================\n# SCENARIO 4: FIREWALL TYPES AND SELECTION (SOLUTIONS)\n# ============================================================================\n\n# TASK 4.1: Packet-Filtering Firewall\n# OSI Layer: 3-4 (Network and Transport)\n# Information examined: Source IP, Dest IP, Source Port, Dest Port, Protocol\n# Stateful: No (examines each packet independently)\n# Decision: Simple rules (if match rule → permit/deny)\n# Speed: Fast (minimal processing)\n# Security: Low-Medium (limited capabilities)\n# Example: Block all traffic to port 23 (Telnet)\n#\n# TASK 4.2: Stateful Firewall\n# OSI Layer: 3-4\n# Tracks: Connection state (TCP handshake establishes session, tracks established connections)\n# Allows: Return traffic automatically (rule: \"allow outbound HTTP\"\n#   → Return HTTP responses allowed automatically by connection table)\n# Speed: Slower than packet-filtering (must track state)\n# Security: Better than packet-filtering (understands connections)\n#\n# TASK 4.3: NGFW (Next-Generation Firewall)\n# OSI Layer: Up to 7 (Application Layer)\n# Deep packet inspection: Examines full packet payload\n# Can block YouTube (port 80/443): YES (recognizes YouTube traffic in application layer)\n# Can block file types: YES (recognizes .exe, .mp3 in payload)\n# Can detect malware: YES (signature matching in payload)\n# Can implement QoS: YES (understands application priority)\n# Speed/Cost: Expensive, CPU-intensive\n# Use case: Enterprise security, need to control applications (not just ports)\n#\n# TASK 4.4: Firewall placement\n# Best location: Between Internet and first internal router/device\n# Why: Protects all internal network traffic\n# What it protects: External attacks, unauthorized inbound traffic\n#\n\n# ============================================================================\n# SCENARIO 5: LOAD BALANCER OPERATION (SOLUTIONS)\n# ============================================================================\n\n# TASK 5.1: Load balancing need\n# Without load balancer: Users would need to manually select server\n# Or DNS would round-robin (crude), but if server fails, user stuck\n#\n# With load balancer:\n# - Advantage: Automatic distribution, health awareness, session persistence\n# - Benefit: Increased capacity, redundancy, performance\n#\n# TASK 5.2: Algorithms\n#\n# Round Robin:\n# Request 1 → Server 1\n# Request 2 → Server 2\n# Request 3 → Server 3\n# Request 4 → Server 1 (cycle repeats)\n#\n# Least Connections:\n# Connections: S1=15, S2=8, S3=12\n# New request → Server 2 (fewest connections)\n# Why: Balances active connection load\n#\n# IP Hash:\n# Same client IP always hashes to same server\n# Ensures session persistence (user state on one server)\n#\n# TASK 5.3: Health checks\n# Server 2 not responding → Removed from rotation\n# New requests: Load balancer sends to Server 1 and 3 only\n# When Server 2 recovers: Automatically added back to rotation\n#\n# TASK 5.4: Layer 4 vs Layer 7\n# Layer 7 more flexible: Can route /api/ requests to different servers than /static/ requests\n# Layer 4: Can only route based on port/protocol\n#\n\n# ============================================================================\n# SCENARIO 6: SECURITY DEVICES - IDS VS IPS (SOLUTIONS)\n# ============================================================================\n\n# TASK 6.1: IDS (Intrusion Detection System)\n# Function: Detect attacks and alert (not block)\n# Deployment: Passive monitoring (copy of traffic via SPAN/mirror port)\n# Monitoring: Signature-based (known attacks) and anomaly-based (unusual behavior)\n# Action on detection: Alert administrator\n# Advantage: Non-intrusive, no false positive impact\n# Disadvantage: Attacks aren't blocked, admin must respond\n#\n# TASK 6.2: IPS (Intrusion Prevention System)\n# Function: Detect attacks and block\n# Deployment: Inline (all traffic must pass through IPS)\n# Blocks: Drops malicious packets immediately\n# Advantage: Proactive defense\n# Disadvantage: False positives can block legitimate traffic\n#\n# TASK 6.3: Which to use\n#\n# Scenario A (Government facility): IPS\n# Why: Maximum security, worth risk of false positives\n#\n# Scenario B (Startup): IDS\n# Why: Budget limited, IDS provides protection with low risk\n# Can upgrade to IPS later as budget allows\n#\n# TASK 6.4: Relationship to firewall\n# Is IPS same as firewall: NO\n# Firewall blocks: Based on IP/port rules\n# IPS blocks: Based on attack signatures/patterns\n# Can both exist: YES (complementary)\n#\n\n# ============================================================================\n# SCENARIO 7: PROXY SERVERS (SOLUTIONS)\n# ============================================================================\n\n# TASK 7.1: Forward Proxy\n# Client setup: Configure browser to use proxy (manual or via DHCP/PAC file)\n# Client appears to server as: The proxy (server sees proxy IP)\n# Server sees: Proxy IP address (not client IP)\n# Use cases:\n# 1. Web filtering (corporate policy enforcement)\n# 2. Content caching (improve performance)\n# 3. Anonymity/privacy (hide client IP)\n#\n# Employee tries Instagram:\n# Proxy intercepts, checks policy, denies\n# Employee sees: Connection refused or error page\n#\n# TASK 7.2: Reverse Proxy\n# External users connect to: One proxy address\n# Proxy forwards to: Multiple internal servers (hidden)\n# External users see: One website / Proxy handles distribution\n# Use cases:\n# 1. Load balancing (distribute load across servers)\n# 2. SSL offloading (proxy handles HTTPS, backends use HTTP)\n# 3. Caching (cache responses from backend servers)\n#\n# TASK 7.3: Proxy features\n# Content filtering: Block specific URLs/websites\n# Caching: Store frequently accessed content locally\n# Anonymity: Hide client IP from servers\n# Authentication: Require login before accessing internet\n#\n# TASK 7.4: Proxy vs Firewall\n# No, different purposes\n# Firewall: Layer 3-4 device, blocks/allows based on IP/port\n# Proxy: Layer 7 device, understands application content\n# Can both exist: YES (firewall + proxy provides layered security)\n# Where: Firewall at network edge, Proxy in internal network or at DMZ\n#\n\n# ============================================================================\n# SCENARIO 8: COMPLETE NETWORK DESIGN (SOLUTIONS)\n# ============================================================================\n\n# TASK 8.1: Architecture with justification\n#\n# [INTERNET]\n#     ↓\n# [Device A: Firewall] - Protects network from external threats, enforces security policy\n#     ↓\n# [Device B: Router] - Routes between external (ISP) and internal networks, provides gateway\n#     ↓\n# [Device C: Load Balancer] - Distributes traffic across web servers, provides redundancy\n#     ↓\n# [Device D: Layer 3 Switch] - Routes between VLANs, provides backbone connectivity\n#     ↓ (distribute to access layer)\n#   [Device E1: Wireless AP] - Provides WiFi connectivity for mobile devices\n#   [Device E2: Access Switch] - Provides wired connectivity for computers/printers\n#   [Device E3: IDS/IPS] - Monitors traffic for security threats\n#\n# TASK 8.2: Justify each device\n#\n# Firewall: Stateful or NGFW (depending on security requirements)\n# Justification: Stateful minimum for business, NGFW for strict application control\n#\n# Router: Gateway to ISP, connects external Internet to internal network\n# Where: Between Internet and internal network\n#\n# Load Balancer: Distributes web requests across 3 web servers\n# Algorithm: Least connections (for long-lived HTTP connections)\n#\n# L3 Switch: Routes between departments' VLANs, provides high-speed backbone\n# Why vs router: Wire-speed performance, built for internal routing\n#\n# Wireless AP: Provides mobile connectivity without wires\n#\n# Access Switch: Provides ports for computers and printers\n# Features: VLAN support (segment traffic), Port security (prevent unauthorized access)\n#\n# IDS/IPS: Monitors for intrusion attempts, detects malware\n# Type: IPS (active defense)\n#\n# TASK 8.3: Data flow\n# User on WiFi → Wireless AP → Access Switch → L3 Switch → Firewall → Web Server\n#\n# Each device processes at its layer:\n# - AP converts wireless to wired\n# - Access switch learns MAC, forwards based on MAC\n# - L3 Switch routes based on IP, handles inter-VLAN routing\n# - Firewall checks security policy\n# - Web server responds\n#\n# TASK 8.4: Redundancy\n# Firewall fails: Install second firewall (active/standby)\n# Load Balancer fails: Use second load balancer (active/active)\n# L3 Switch fails: Second L3 switch as backup\n# Access Switch fails: Some users isolated (add redundancy)\n# Web Server fails: Other servers handle load (redundancy built-in)\n#\n# Design strategy: Redundancy at critical points (firewall, load balancer, core switches)\n#\n\n# ============================================================================\n# SCENARIO 9: SPECIALIZED DEVICES (SOLUTIONS)\n# ============================================================================\n\n# TASK 9.1: Media Converter\n# Function: Converts between different media types\n# Example: Convert Copper (RJ45) to Fiber (SC/LC)\n# Why needed: Extend distance (fiber can go 10km vs 100m copper)\n# OSI Layer: 1 (Physical)\n#\n# TASK 9.2: WAN Optimizer\n# Data compression: Reduce file size before transmission\n# Deduplication: Don't resend same data twice\n# Caching: Store frequently accessed data locally\n# Result: 5 Mbps effective bandwidth might feel like 15+ Mbps\n#\n# TASK 9.3: CDN (Content Delivery Network)\n# Without CDN: All requests to one data center → slow for distant users\n# With CDN: Content at edge servers worldwide → fast for everyone\n# Benefit: Reduced latency, faster page loads\n#\n# TASK 9.4: VoIP Gateway\n# Function: Converts between VoIP (IP phones) and PSTN (traditional phone lines)\n# Why needed: Companies use both IP phones and legacy phone systems\n# Example: Dial extension 100 to reach analog phone system\n#\n\n# ============================================================================\n# SCENARIO 10: TROUBLESHOOTING DEVICE PLACEMENT (SOLUTIONS)\n# ============================================================================\n\n# TASK 10.1: Device selection error\n# Problem: Network too slow with hub connecting 20 computers\n# Hub broadcasts all traffic to all ports (one collision domain)\n# Solution: Replace with L2 Switch\n# Why: Switch creates separate collision domains per port, eliminates contention\n#\n# TASK 10.2: Firewall problem\n# SSH denied to internal servers from Internet\n# Stateful firewall helps: Somewhat (tracks outbound connections returning)\n# But incoming SSH initiations not affected by stateful\n# Solution: Add explicit firewall rule allowing inbound SSH to specific servers\n# Or use bastion host (jump server) as secure intermediary\n#\n# TASK 10.3: Load balancer false positive\n# Server 2 removed from rotation\n# What happened: Health check failed (network timeout or service not responding)\n# But server actually working\n# Solution: Investigate server, fix network connectivity, adjust health check thresholds\n#\n# TASK 10.4: Architecture problem\n# Only one router to Internet = single point of failure\n# Problem: Internet outage = complete network outage\n# Solution: Add redundant router (dual ISP connections, failover)\n#\n",
  "hints": [
    "Hub broadcasts to all ports (Layer 1), Switch forwards intelligently to specific port (Layer 2)",
    "Router operates at Layer 3 (IP addresses), L3 Switch combines Layer 2 + 3 in hardware for speed",
    "Packet-filtering firewall is fast but limited, NGFW can inspect application data (URLs, file types)",
    "Load balancer algorithms: Round Robin (sequential), Least Connections (lowest load), IP Hash (persistence)",
    "IDS alerts (passive), IPS blocks (active/inline) - IPS is more aggressive but risky for false positives",
    "Forward Proxy (client-side, filters outbound), Reverse Proxy (server-side, load balances inbound)",
    "Firewall at network edge protects perimeter, IDS/IPS inside network monitors for internal threats",
    "Each network device operates at specific OSI layer: what it can see determines what decisions it can make",
    "Complete network design needs: Firewall (security), Router (external routing), L3 Switch (internal routing), Load Balancer (redundancy)",
    "Media Converter (Layer 1), WAN Optimizer (compression/dedup), CDN (geographic distribution)"
  ],
  "testCases": [
    {
      "id": "tc1",
      "description": "Understands OSI layers: Hub=L1, Switch=L2, Router=L3, Firewall=L3-7, Proxy=L7",
      "validation": "assert ('layer' in code.lower() or 'osi' in code.lower()) and ('hub' in code.lower() or 'switch' in code.lower() or 'router' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc2",
      "description": "Knows hub broadcasts to all ports, switch forwards to specific port only",
      "validation": "assert ('hub' in code.lower() and 'broadcast' in code.lower()) and ('switch' in code.lower() and ('forward' in code.lower() or 'mac' in code.lower()))",
      "isHidden": false
    },
    {
      "id": "tc3",
      "description": "Understands firewall types: packet-filtering (simple), stateful (connection tracking), NGFW (application)",
      "validation": "assert ('firewall' in code.lower() or 'packet' in code.lower()) and ('stateful' in code.lower() or 'ngfw' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc4",
      "description": "Knows load balancer algorithms: round robin, least connections, IP hash",
      "validation": "assert ('load' in code.lower() or 'balancer' in code.lower()) and ('round' in code.lower() or 'connection' in code.lower() or 'hash' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc5",
      "description": "Understands IDS (passive detection) vs IPS (active blocking)",
      "validation": "assert ('ids' in code.lower() or 'ips' in code.lower()) and ('detect' in code.lower() or 'block' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc6",
      "description": "Knows proxy types: forward proxy (client-side filtering), reverse proxy (server-side)",
      "validation": "assert ('proxy' in code.lower() or 'forward' in code.lower() or 'reverse' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc7",
      "description": "Understands Layer 3 Switch vs Router: L3 switch faster (hardware), router more flexible",
      "validation": "assert ('layer 3' in code.lower() or 'l3' in code.lower()) and ('switch' in code.lower() or 'router' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc8",
      "description": "Knows complete network architecture components and their placement",
      "validation": "assert code.count(('firewall', 'router', 'switch', 'load', 'security')) >= 3",
      "isHidden": false
    },
    {
      "id": "tc9",
      "description": "Understands what each layer can inspect: L1=signals, L2=MAC, L3=IP, L7=application",
      "validation": "assert ('inspect' in code.lower() or 'layer' in code.lower()) and ('mac' in code.lower() or 'ip' in code.lower() or 'application' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc10",
      "description": "Total file size meets 10,000+ character minimum",
      "validation": "assert len(code) >= 10000",
      "isHidden": true
    },
    {
      "id": "tc11",
      "description": "Covers major lesson 022 concepts: device types, OSI layers, architecture design, security",
      "validation": "assert code.count('task') >= 8 and code.count(('device', 'firewall', 'switch', 'router', 'layer')) >= 5",
      "isHidden": true
    }
  ]
}
