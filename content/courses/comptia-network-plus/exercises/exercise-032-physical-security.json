{
  "id": "exercise-032-physical-security",
  "lessonId": "lesson-032-physical-security",
  "title": "Physical Security Design and Implementation",
  "description": "Design comprehensive physical security for a financial data center. Address access control, environmental monitoring, surveillance, fire suppression, and disaster recovery. Evaluate security controls at multiple facility locations and respond to security incidents.",
  "difficulty": "intermediate",
  "points": 100,
  "language": "text",
  "starterCode": "# PHYSICAL SECURITY EXERCISE - Financial Data Center Design\n# Design and implement multi-layered physical security controls\n\n## SCENARIO: Your company operates 3 data centers:\n## - Primary DC: Manhattan (High-rise, shared building, 50 staff)\n## - Secondary DC: New Jersey (Suburban, owned facility, 10 staff)\n## - Tertiary DR site: Pennsylvania (Remote, automated, 2 staff)\n\n## Current Issues:\n## - Unauthorized person tailgated into primary DC (found in server room)\n## - Environmental sensor malfunction caused server overheating (2 hours downtime)\n## - Server theft from secondary DC (drives with customer data)\n## - Fire suppression system false alarm damaged equipment\n\n## PART 1: PERIMETER SECURITY\n## Q1: Design perimeter access control for each location:\n##     Manhattan High-rise:\n##     - Ground floor lobby: Public area vs secured area separation? _____\n##     - Building entry: Card readers only? Badge+PIN? MFA? Biometric?\n##     - Data center entrance: _______________\n##     - Server room access: _______________\n##     - Cost estimate: $_____\n##\n##     New Jersey Owned Facility:\n##     - Exterior fence: _______________\n##     - Gate access: _______________\n##     - Building entrance: _______________\n##     - Cost estimate: $_____\n##\n##     Pennsylvania DR Site:\n##     - Remote location access: _______________\n##     - Emergency access procedures: _______________\n##     - Cost estimate: $_____\n\n## PART 2: ACCESS CONTROL POLICIES\n## Q2: Badge system design:\n##     - Badge type: Photo ID only? RFID only? Both? Smart card?\n##     - Information on badge: Name, photo, department, access level, expiration\n##     - Access levels: How many? (e.g., Facility, Zone A, Zone B, Server Room)\n##     - Badge issuance: Centralized or by site? Approval process?\n##     - Badge revocation: Immediate or end-of-week? Chain of custody?\n##     - Lost/stolen badge procedure: _______________\n##     - Cost per badge: $_____\n##     - Annual card replacement budget: $_____\n\n## Q3: Access logs and investigation:\n##     - Access point: Attempted unauthorized entry at server room door 2am\n##     - Badge: Employee John Smith (Network Admin)\n##     - Event log: Badge swiped 2:05am, 2:07am, 2:12am (3 attempts, all denied)\n##     - Time of incident: 2:05-2:12am (7 minutes)\n##     - Questions:\n##       a) Why were attempts denied?\n##       b) What policy was violated?\n##       c) What should happen to this employee?\n##       d) What system improvement prevents this?\n\n## PART 3: VISITOR MANAGEMENT\n## Q4: Design visitor access procedures:\n##     - Visitor badge: Temporary badge, what duration? (1 day, 8 hours, 4 hours?)\n##     - Visitor escort: Required or not? If required, staff ratio? (1:1? 1:2?)\n##     - Visitor areas: Restricted zones? (e.g., no server room access)\n##     - Sign-in/sign-out: Electronic or paper log? Retained how long?\n##     - Contractor access: Same as visitor or different? Vetting required?\n##     - Cost: $_____\n##\n##     Scenario: Contractor walks into building with visitor badge, goes directly\n##     to maintenance room (not their assigned area). What went wrong?\n\n## PART 4: ENVIRONMENTAL CONTROLS\n## Q5: Environmental monitoring and redundancy:\n##     - Temperature monitoring: Sensors every __ feet? Alarms at __ and __ degrees?\n##     - Humidity monitoring: Target __%? Alarms at __%?\n##     - Power monitoring: UPS capacity __% above peak demand\n##     - Cooling redundancy: N+1 redundancy? N+2? Cost impact?\n##     - Monitoring system: Manual observation, local alerts, or remote SMS/email alerts?\n##     - Sensor failure plan: How to detect failed sensor? Backup sensor?\n\n## Q6: Environmental failure scenario:\n##     - Time: 3:30am Saturday morning\n##     - Event: Temperature rises to 95°F in server room (critical hardware limit is 86°F)\n##     - Cause: HVAC system #1 failure, HVAC #2 taking longer to compensate\n##     - Detected by: Automated SMS alert to on-call engineer (received 3:42am)\n##     - Response time: Engineer arrives 1.5 hours later (4:45am)\n##     - Actual outage: 1 server failed at 3:58am (28 minutes elapsed)\n##     - Questions:\n##       a) What control failures led to this incident?\n##       b) How should redundancy be improved?\n##       c) What alert thresholds prevent server damage?\n##       d) What automated response prevents outage?\n\n## PART 5: SURVEILLANCE AND MONITORING\n## Q7: Camera system design:\n##     - Location: Which areas need cameras? (Perimeter, lobby, access points, server room?)\n##     - Resolution: Standard def (720p) or HD (1080p) or 4K? Cost difference?\n##     - Coverage: All angles of access point? Blind spots?\n##     - Recording: 24/7 or motion-triggered? Retention: 30 days? 90 days? 1 year?\n##     - Monitoring: Real-time security guard or AI-based analytics?\n##     - Cost estimate: $_____\n\n## Q8: Incident review scenario:\n##     - Incident: Server theft from secondary DC at 11:15pm\n##     - Investigation: Review security camera footage\n##     - Camera evidence:\n##       * 11:10pm: One person entered facility (appeared authorized, had badge)\n##       * 11:15pm: Person accessed server room (door opened)\n##       * 11:20pm: Person carried item resembling hard drive rack out of facility\n##       * 11:22pm: Person loaded item into personal vehicle\n##     - Question: Identify security gaps and required improvements\n\n## PART 6: FIRE SUPPRESSION AND SAFETY\n## Q9: Fire suppression system:\n##     - Suppression type: Water sprinklers? Halon? FM-200? CO2?\n##     - Justification for data center: _______________\n##     - Automatic activation: When? (Temp > 160°F? Smoke detected?)\n##     - Manual activation: Emergency buttons where? How many?\n##     - Post-suppression: Can you salvage servers? Data? Equipment damage?\n##     - Emergency procedures: Building evacuation? Containment? System recharge?\n\n## Q10: False alarm scenario:\n##      - Time: 3:15pm Friday\n##      - Cause: Dust accumulation triggered smoke detector (non-critical area)\n##      - System response: Automatic FM-200 discharge into server room\n##      - Damage: $50K in equipment damage, chemical residue, 2 hours cleanup\n##      - Recovery: Full data verification needed (4 hours)\n##      - Total downtime: 6 hours\n##      - Q: How to prevent false alarms without compromising fire protection?\n\n## PART 7: DISASTER RECOVERY AND EMERGENCY PROCEDURES\n## Q11: Emergency response procedures:\n##      - Building evacuation: Where do staff go? Communication plan?\n##      - Emergency contacts: Who is notified? Chain of command?\n##      - Emergency access: If systems fail, how do authorized personnel enter?\n##      - Emergency shutdown: How to safely power down equipment?\n##      - Recovery procedures: Time to restore? Dependencies?\n\n## Q12: Scenario: Building power loss (hurricane)\n##      - Time: 7:30pm Thursday evening\n##      - Event: Complete power loss, building evacuation ordered\n##      - UPS status: Sufficient for 4 hours of operation\n##      - Generator status: Failed to start (fuel line issue)\n##      - Decision: Shutdown servers gracefully or attempt to continue?\n##      - Q: What procedures prevent data loss or corruption?\n\n## PART 8: COST-BENEFIT ANALYSIS\n## Q13: Security investment priorities:\n##      - Perimeter security (fences, gates, guards): $150K setup, $100K/year\n##      - Access control (badges, readers, logs): $80K setup, $30K/year\n##      - Environmental monitoring: $50K setup, $20K/year\n##      - Surveillance system: $120K setup, $40K/year\n##      - Fire suppression: $100K setup, $15K/year\n##      - Emergency procedures/training: $30K setup, $15K/year\n##      - Total Year 1: $530K setup + $220K operations\n##      - Total Year 2-5: $220K/year operations\n##\n##      - Incident costs (recent):\n##        * Unauthorized access: Risk of data theft = $10M\n##        * Environmental failure: 1 hour downtime = $20K revenue + $50K investigation\n##        * Server theft: $200K equipment + $5M data compromise + compliance fines\n##        * Fire suppression false alarm: $50K damage + 6 hours downtime = $20K\n##      - Total recent incident costs: ~$5.3M\n##\n##      - Questions:\n##        a) ROI of physical security investment: _____\n##        b) Which controls are highest priority? (Rank by risk reduction)\n##        c) Can budget be reduced to $300K? What's eliminated?",
  "solution": "# PHYSICAL SECURITY SOLUTION\n\n## PART 1: PERIMETER SECURITY DESIGN\n\n### Manhattan High-Rise Facility\n- **Ground floor lobby**: SEPARATE - Public lobby vs. secure elevator/datacenter area\n  - Security barrier/turnstile prevents unauthorized access to secure elevator\n  - Lobby has badge reader control\n- **Building entry**: Badge readers + PIN (two-factor)\n  - RFID badge verifies identity\n  - PIN adds second factor (something you know vs something you have)\n  - Prevents tailgating (badge alone can be shared)\n- **Data center entrance**: Badge + PIN + Biometric (fingerprint or iris)\n  - Three-factor authentication (what you have, what you know, who you are)\n  - Prevents badge theft/sharing attacks\n- **Server room access**: Same as data center (badge + PIN + biometric)\n  - Most restricted area = most controls\n  - Manual override in case of biometric reader failure\n- **Cost estimate**: $150K setup (readers, badges, installation) + $30K/year maintenance\n\n### New Jersey Owned Facility (Suburban)\n- **Exterior fence**: 8-foot chain-link fence with gates\n  - Deters casual trespassing\n  - Defines secure perimeter\n  - Cost: $30K\n- **Gate access**: Automated gate with intercom\n  - Vehicle arrival triggers intercom to security\n  - Gate opens only after verification\n  - Option: Proximity reader for employees\n- **Building entrance**: Badge reader + keypads\n  - Less stringent than Manhattan (smaller facility, lower risk)\n  - Keypads allow facility access without badge\n- **Cost estimate**: $80K setup (fence, gate, readers) + $20K/year\n\n### Pennsylvania DR Site (Remote)\n- **Remote location access**: Badge + physical key lock\n  - Automated site, minimal staff (2 people)\n  - Badge reader on door\n  - Mechanical key lock as backup\n- **Emergency access procedures**: Master key held in bank safety deposit box\n  - Authorized personnel can retrieve in emergency\n  - Procedures documented, tested\n- **Cost estimate**: $40K setup + $10K/year\n\n## PART 2: ACCESS CONTROL POLICIES\n\n### Badge System Design\n- **Badge type**: Photo ID + RFID chip\n  - Visual identification (human security guard verification)\n  - RFID allows automated readers at doors\n  - Combined provides both automation and human verification\n- **Information on badge**: \n  - Name, photo, department\n  - Access level code (numeric: 1=Facility, 2=Data Center, 3=Server Room)\n  - Badge number and expiration date\n  - Emergency contact number on back\n- **Access levels (4 levels)**:\n  - Level 1: Building access only (public areas)\n  - Level 2: Data center floors (core infrastructure)\n  - Level 3: Server room (restricted)\n  - Level 4: Security/management (all areas, audit trails)\n- **Badge issuance**: Centralized security office\n  - Employee submits request + manager approval\n  - Background check completed (financial sector)\n  - Badge printed with photo, activated in system\n  - Employee signs badge receipt\n- **Badge revocation**: Immediate upon termination\n  - Security notified same day\n  - Badge disabled in system within 1 hour\n  - Physical badge collected from employee\n- **Lost/stolen badge procedure**:\n  - Employee notifies security immediately\n  - Badge disabled in system within 15 minutes\n  - Replacement badge issued next day ($50 fee to employee)\n  - Investigation of access logs between loss and report\n- **Cost per badge**: $45 (card + RFID + personalization)\n- **Annual replacement budget**: 50 badges × $45 = $2,250 (3% turnover + replacements)\n\n### Access Investigation Scenario\n**Badge attempt at 2am - Employee John Smith (Network Admin)**\n\na) **Why were attempts denied?**\n   - Access control list restricted server room to scheduled maintenance windows\n   - 2am is outside allowed hours (typically 8am-6pm)\n   - System rejected access based on time-of-day policy\n\nb) **What policy was violated?**\n   - After-hours access policy: Server room requires pre-approval for access outside 8am-6pm\n   - Employee did not request/receive approval for 2am access\n   - Supervisor not notified of maintenance work\n\nc) **What should happen to this employee?**\n   - Investigation required: Why was access attempted?\n   - If approved maintenance: Policy compliance training needed\n   - If unauthorized: Disciplinary action (reprimand, termination possible)\n   - If compromised badge: Revoke badge, issue new badge, investigate other access\n\nd) **System improvement**:\n   - Two-factor authentication (PIN) prevents badge reuse\n   - Badge + PIN prevents this incident\n   - After-hours requests must be logged and pre-approved\n   - Notification system alerts manager when employee attempts after-hours access\n\n## PART 3: VISITOR MANAGEMENT\n\n### Visitor Access Procedures\n- **Visitor badge**: 1-day duration (expires at end of business day)\n  - Clearly marked as temporary\n  - Must be returned before leaving\n  - Prevents badges left behind or misused\n- **Visitor escort**: Required 1:1 ratio\n  - Every visitor must be escorted by authorized employee\n  - Escort responsible for visitor's actions\n  - Escort sees all areas visitor can access\n- **Visitor areas**: \n  - RESTRICTED: Server rooms, secure network areas, backup storage\n  - ALLOWED: Conference rooms, office areas, specified work areas\n  - Documented on visitor badge\n- **Sign-in/sign-out**: Electronic log (tablet at entrance)\n  - Time in, time out, escort name, purpose\n  - Retained 1 year minimum (compliance requirement)\n  - Data analyzed for badge system updates\n- **Contractor access**: Different from visitor\n  - Background check required (financial sector)\n  - Multi-day badge if project extends beyond 1 day\n  - Specific areas pre-approved by management\n  - Security briefing on data protection policies\n  - NDA signed before access granted\n- **Cost**: $10K setup (tracking system) + $5K/year (background check service)\n\n### Contractor Scenario Analysis\n**Problem**: Contractor with visitor badge entered maintenance room (not assigned area)\n\n**Security Failures**:\n1. Visitor escort not present (escort requirement violated)\n2. Visitor badge had no area restrictions enforced\n3. No badge reader on maintenance room door\n4. No one questioned contractor walking alone\n\n**Improvements**:\n- Electronic access control on ALL restricted doors\n- Visitor badges have specific area codes\n- Access readers reject badge if area not pre-authorized\n- Security patrol checks for unescorted visitors\n- Training: All staff challenge unknown persons (\"May I help you?\")\n\n## PART 4: ENVIRONMENTAL CONTROLS\n\n### Environmental Monitoring Design\n- **Temperature monitoring**:\n  - Sensor placement: Every 100-150 sq ft (catches hot spots)\n  - Alert thresholds: \n    - Warning: 75°F (time to investigate)\n    - Critical: 80°F (activate emergency cooling)\n    - Shutdown threshold: 86°F (emergency server shutdown)\n  - Hardware limit: 95°F (permanent damage begins)\n- **Humidity monitoring**:\n  - Target: 45-55% relative humidity\n  - Warning: 60% or 35% (static electricity risk)\n  - Critical: 70% or 20% (equipment damage risk)\n- **Power monitoring**:\n  - UPS capacity: 120% of peak demand\n  - If peak = 500kW, UPS = 600kW\n  - Provides 20% safety margin for surges\n- **Cooling redundancy**: N+1 minimum (2 HVAC systems for backup)\n  - N+1: If 1 fails, 1 remains operational\n  - Cost: $50K additional for second system\n  - Alternative N+2 (3 systems) costs $100K more but safer\n- **Monitoring system**: Remote SMS/email alerts + on-site display\n  - Automated alerts reach on-call engineer in seconds\n  - Local display for staff awareness\n  - SMS allows response from anywhere (not just office)\n- **Sensor failure plan**: \n  - Backup sensors on each critical point\n  - If sensor reads outside physical possibility (e.g., 200°F), mark as failed\n  - Manual verification when sensor fails\n  - Monthly calibration checks\n\n### Environmental Failure Scenario Analysis\n**Time: 3:30am Saturday, Temperature rises to 95°F**\n\na) **Control failures**:\n   - Single HVAC system failed (N+1 redundancy should have prevented this)\n   - Second HVAC system too slow to compensate\n   - No automated emergency cooling (e.g., emergency fan)\n   - Alert threshold too high (95°F is hardware damage level, not warning level)\n   - On-call response took 1.5 hours (too long for critical alert)\n\nb) **Redundancy improvements**:\n   - Deploy N+2 (3 HVAC systems) for data center\n   - Add supplemental fans triggered at 75°F\n   - Upgrade alert system to reach multiple technicians (not just one)\n   - SLA: Engineer must arrive within 30 minutes for critical alert\n   - Cost: $100K additional setup + $20K/year increased staffing\n\nc) **Alert thresholds to prevent damage**:\n   - 72°F: Informational (monitor, investigate)\n   - 78°F: Warning (start investigation, prepare response)\n   - 84°F: Critical (emergency activation, immediate technician response)\n   - 86°F: Emergency shutdown (automatic server graceful shutdown)\n   - Hardware limit: 95°F (damage threshold)\n   - Response must occur BEFORE 84°F to prevent shutdown\n\nd) **Automated response**:\n   - At 78°F alert: Automatically engage second HVAC system\n   - At 84°F critical: Reduce server workload (suspend non-critical services)\n   - At 86°F emergency: Graceful shutdown sequence\n   - Prevents server failure from overheating\n\n## PART 5: SURVEILLANCE AND MONITORING\n\n### Camera System Design\n- **Location (7 areas)**:\n  1. Exterior perimeter (gate, fence)  \n  2. Building entrance (entry/exit point)\n  3. Lobby security checkpoint\n  4. Data center entrance\n  5. Server room entrance\n  6. Backup storage area\n  7. Parking lot (vehicle identification)\n- **Resolution**: 1080p HD (balanced cost vs quality)\n  - Sufficient to identify individuals (faces, badges)\n  - 720p would miss badge details\n  - 4K adds $2K per camera but excessive for this use\n- **Coverage**: 100% angle coverage at each location\n  - Pan-tilt-zoom cameras at perimeter (follow movement)\n  - Fixed cameras at access points (full door coverage)\n  - No blind spots\n  - Overlap cameras for reliability\n- **Recording**: \n  - 24/7 continuous recording (cannot miss access times)\n  - Retention: 90 days (compliance + incident investigation window)\n  - Redundant storage (primary + backup)\n- **Monitoring**: AI-based analytics\n  - Detect unusual patterns (same person accessing multiple times, or at odd hours)\n  - Alert security for immediate investigation\n  - More efficient than live guards (one analyst can monitor 20+ cameras)\n  - Cost: $5K initial + $2K/year AI software\n- **Cost estimate**: \n  - 7 cameras × $500 = $3,500\n  - Recording system + storage: $8,000\n  - Installation: $5,000\n  - AI analytics software: $5,000\n  - **Total setup**: $21,500\n  - **Annual**: $3,000 maintenance + $2,000 software\n\n### Incident Review: Server Theft\n**11:15pm theft from secondary DC**\n\n**Camera evidence analysis**:\n- 11:10pm: Person entered with badge (appeared authorized)\n- 11:15pm: Server room access (door opened)\n- 11:20pm: Person carried hard drive rack\n- 11:22pm: Loaded into personal vehicle\n\n**Security gaps identified**:\n1. **Access control gap**: Badge was valid at 11:15pm (no after-hours restrictions)\n   - Server room access should require after-hours approval\n   - Time-of-day access policies not enforced\n\n2. **Camera gap**: No camera inside server room\n   - Interior camera would capture removal\n   - Would provide evidence of what was stolen\n\n3. **Physical asset tracking gap**: No inventory system\n   - Cannot determine which servers stolen\n   - No receipt/checkout process\n   - No alarm when device leaves building\n\n4. **Access log gap**: No correlation between badge access + surveillance\n   - Badge logs should match video records\n   - Discrepancies should trigger investigation\n\n**Required improvements (Priority order)**:\n1. **Immediate**: Require pre-approval for after-hours access\n   - Time-of-day access restriction in badge system\n   - Estimated cost: Configuration only ($0)\n   \n2. **Short-term**: Add camera inside server room (discrete, privacy-friendly)\n   - Captures physical removals\n   - Cost: $1,000\n   \n3. **Medium-term**: Implement asset tracking system\n   - RFID tags on servers\n   - Alarm if tagged device moves without authorization\n   - Cost: $15,000\n   \n4. **Long-term**: Correlate access logs with surveillance\n   - Automated analysis for anomalies\n   - Cost: $10,000 integration project\n\n## PART 6: FIRE SUPPRESSION AND SAFETY\n\n### Fire Suppression System\n- **Suppression type**: FM-200 (Heptafluoropropane)\n  - **Justification for data center**:\n    - Water-based sprinklers would destroy all equipment (electronics + water = short circuit)\n    - CO2 would suffocate occupants (need evacuation)\n    - Halon is ozone-depleting (EPA restricted)\n    - FM-200 extinguishes by cooling + molecular disruption\n    - Leaves no residue (servers operational after discharge)\n    - Safe for occupied spaces (staff can remain during discharge)\n    - Industry standard for data centers\n\n- **Automatic activation**: \n  - Triggered when smoke + heat detected (dual detection)\n  - Temperature threshold: 160°F (well above normal operating)\n  - Prevents accidental discharge from normal operations\n  - Requires BOTH smoke AND heat (eliminates false alarms from dust alone)\n  \n- **Manual activation**: \n  - Emergency pull stations at server room entrance + exit\n  - Manual override for situations automatic system fails\n  - Clearly marked \"PULL FOR FIRE SUPPRESSION\"\n  \n- **Post-suppression**:\n  - Servers: Often salvageable (FM-200 doesn't damage electronics)\n  - Data: No data loss (system was operational when discharged)\n  - Equipment damage: Minimal (discharge damage < fire damage)\n  - Cost: $5K-10K cleanup after discharge\n  \n- **Emergency procedures**:\n  - Building evacuation: YES (even though FM-200 is safe, people evacuate per fire code)\n  - System recharge: 24-48 hours (FM-200 refill from certified vendor)\n  - Equipment verification: Before restoring to service\n  - Fire investigation: Required by fire department\n\n### False Alarm Scenario Analysis\n**3:15pm Friday - Dust triggers smoke detector**\n\n**Failures**:\n- Single smoke detector in non-critical area triggered\n- No secondary verification before discharge\n- System discharged full FM-200 into server room (unnecessary)\n- Cost: $50K equipment damage + chemical residue\n- Lost productivity: 2 hours cleanup + 4 hours verification = 6 hours\n\n**Prevention methods**:\n1. **Smoke detector intelligence** (dual-sensor)\n   - Heat sensor + smoke sensor required (not just smoke)\n   - Dust alone triggers smoke sensor\n   - Heat sensor prevents false trigger\n   - Cost: $5K upgrade\n\n2. **Zoned detection**\n   - Separate zones for critical areas vs non-critical\n   - Single smoke detector in non-critical zone doesn't trigger discharge\n   - Only server room sensors trigger FM-200 discharge\n   - Cost: $10K system reconfiguration\n\n3. **Graduated response**\n   - Alert (30-second delay) instead of immediate discharge\n   - Allows operator to cancel false alarm\n   - Manual discharge still available for real fire\n   - Cost: Software upgrade only\n\n4. **Preventive maintenance**\n   - Monthly sensor cleaning (remove dust accumulation)\n   - Quarterly sensor calibration\n   - Annual full system test (with FM-200 supply isolated)\n   - Cost: $5K/year maintenance service\n\n## PART 7: DISASTER RECOVERY AND EMERGENCY PROCEDURES\n\n### Emergency Response Procedures\n- **Building evacuation**:\n  - Assembly point: Parking lot (defined location, minimum distance from building)\n  - Headcount: Security verifies all staff evacuated\n  - Communication: Text/phone notification to off-site incident commander\n  - Estimated assembly time: <5 minutes\n\n- **Emergency contacts** (escalation chain):\n  1. On-call facility manager\n  2. IT director\n  3. Chief information security officer (CISO)\n  4. CEO/executive on-call\n  5. External emergency services (fire, police)\n\n- **Emergency access** (if systems fail):\n  - Master key in bank safety deposit box\n  - Authorized for facility manager + backup\n  - Procedures: Call bank, retrieve key, enter facility\n  - Time estimate: 30 minutes\n\n- **Emergency shutdown** (graceful power-down):\n  - Identify critical services (which must stay running vs which can stop)\n  - Graceful shutdown sequence: Stop applications → Close databases → Shutdown OS\n  - Prevents data corruption from sudden power loss\n  - Time estimate: 5-15 minutes depending on workloads\n\n- **Recovery procedures**:\n  - Restore from backup (automated process)\n  - Verify data integrity after restore\n  - Bring systems online gradually (not all at once)\n  - Monitor for issues during startup\n  - Time estimate: 1-4 hours depending on failure severity\n\n### Hurricane Scenario: Complete Power Loss\n**7:30pm Thursday - Power loss + building evacuation ordered**\n\n**Situation**:\n- Power gone completely\n- UPS has 4 hours runtime\n- Generator failed to start (fuel line issue)\n- Decision: Shutdown or attempt to continue?\n\n**Data preservation procedures**:\n- **Option A: Graceful Shutdown** (Recommended)\n  - Continue on UPS for 30 minutes\n  - Complete all in-flight transactions\n  - Stop accepting new transactions\n  - Close databases cleanly\n  - Shutdown servers (preserves data integrity)\n  - Time to safe state: 30-45 minutes\n  - Data loss: None\n  - Recovery: Manual startup after power restored\n\n- **Option B: Attempt to Continue**\n  - Run on UPS for full 4 hours\n  - Risk: Generator doesn't recover, UPS dies mid-transaction\n  - Result: Database corruption, data loss\n  - Recovery: Database repair, potential 1-2 days downtime\n  - NOT RECOMMENDED\n\n**Procedures to prevent data loss/corruption**:\n1. Monitor UPS runtime: If <30 minutes remaining, initiate graceful shutdown\n2. Transaction logging: Write transaction to persistent log before acknowledging\n3. Database recovery: Automatic recovery from logs on restart\n4. Backup power: Two independent backup generators (N+1)\n5. Fuel reserves: Monthly fuel testing + full tank minimum\n6. Alternative: Contract with mobile generator vendor (4-hour response time)\n\n## PART 8: COST-BENEFIT ANALYSIS\n\n### Security Investment ROI\n**Annual costs**:\n- Year 1: $530K setup + $220K operations = $750K total\n- Year 2-5: $220K/year operations\n- 5-year total: $530K + (5 × $220K) = $1.63M\n\n**Recent incident costs prevented**:\n- Unauthorized access → Data theft: $10M risk prevented\n- Environmental failure: $70K incident cost\n- Server theft: $5.2M cost (equipment + data compromise + fines)\n- Fire suppression false alarm: $50K cost\n- Total mitigated risk: $15.3M\n\n**ROI calculation**:\n- 5-year investment: $1.63M\n- Prevented losses: $15.3M (conservative, single incidents)\n- **ROI: 839%** (or 9.4x return)\n- **Payback period**: <2 months (if even one major incident prevented)\n\n### Priority Ranking (by risk reduction)\n**Tier 1 (Implement immediately)**:\n1. **Access control** (badges + PIN): Risk reduction 40%, Cost $110K\n   - Prevents unauthorized access, data theft\n2. **Environmental monitoring**: Risk reduction 35%, Cost $70K\n   - Prevents equipment failure, data loss\n3. **Surveillance**: Risk reduction 25%, Cost $21.5K\n   - Deters theft, enables forensics\n\n**Tier 2 (Implement within 6 months)**:\n4. **Fire suppression**: Risk reduction 20%, Cost $115K\n   - Prevents facility loss\n5. **Visitor management**: Risk reduction 15%, Cost $15K\n   - Prevents unauthorized access by contractors\n\n**Tier 3 (Implement within 12 months)**:\n6. **Emergency procedures/training**: Risk reduction 10%, Cost $45K\n   - Ensures business continuity\n7. **Redundant cooling**: Risk reduction 8%, Cost $100K\n   - Prevents environmental failures\n\n### Budget Reduction Scenario ($300K target)\n**Cuts to reach $300K** (NOT RECOMMENDED - trades safety for cost):\n\n- **Cut environmental monitoring**: Save $20K (HIGH RISK)\n  - Without monitoring, environmental failures undetected\n  - Cost of missed failure: $70K+ per incident\n  - NOT RECOMMENDED\n\n- **Cut surveillance**: Save $21.5K (MODERATE RISK)\n  - Removes forensic capability\n  - Deters fewer thieves\n  - Affordable to cut: Less critical than monitoring\n  - Impact: Can't investigate theft/access incidents\n\n- **Reduce coverage areas**: Save $50K\n  - Only critical access points (entrance, server room)\n  - Skip parking lot + lobby\n  - Reduces visibility but acceptable\n\n- **Defer Tier 2 fire suppression**: Save $115K\n  - High risk (no fire protection)\n  - NOT RECOMMENDED\n\n- **Reduce redundancy**: Save $50K\n  - Single HVAC system instead of N+1\n  - Single ISP instead of dual\n  - High risk of extended downtime\n  - NOT RECOMMENDED\n\n**Realistic $300K option**:\n- Access control system: $110K (non-negotiable)\n- Basic environmental monitoring: $30K (core sensors only)\n- Essential surveillance: $50K (access points only)\n- Training/procedures: $30K (minimal)\n- Infrastructure: $80K\n- **Total**: $300K\n- **Trade-off**: Less redundancy, deferred fire suppression, limited surveillance\n- **Risk**: Significantly higher vulnerability to theft + environmental issues",
  "hints": [
    "Multi-factor authentication prevents badge sharing/theft attacks",
    "N+1 redundancy means if one system fails, operations continue uninterrupted",
    "Access logs provide forensic evidence - essential for investigating security breaches",
    "After-hours access should be restricted and require pre-approval",
    "Environmental sensors need multiple detection methods to prevent false alarms",
    "Fire suppression for data centers differs from buildings - water destroys electronics",
    "Visitor escorts are critical - never allow unescorted movement in restricted areas",
    "RTO (Recovery Time Objective) and RPO (Recovery Point Objective) drive redundancy decisions",
    "Physical security is foundation - even encrypted data can be stolen if physical security weak",
    "Defense in depth applies to physical security too - multiple layers prevent breaches"
  ],
  "testCases": [
    {
      "id": "tc1-access-control",
      "description": "Multi-factor authentication design",
      "input": "Access control measures",
      "expected": "At least 2 factors (badge + PIN, badge + biometric, etc)",
      "assert": "assert ('badge' in solution.lower() or 'rfid' in solution.lower()) and ('pin' in solution.lower() or 'biometric' in solution.lower() or 'fingerprint' in solution.lower())"
    },
    {
      "id": "tc2-redundancy",
      "description": "N+1 or N+2 redundancy implementation",
      "input": "High availability design",
      "expected": "Backup systems for critical infrastructure (HVAC, power, cooling)",
      "assert": "assert 'n+1' in solution.lower() or 'redundan' in solution.lower() or 'backup' in solution.lower()"
    },
    {
      "id": "tc3-monitoring",
      "description": "Environmental and security monitoring",
      "input": "Alert systems",
      "expected": "Temperature, humidity, power monitoring with alert thresholds",
      "assert": "assert ('temperature' in solution.lower() or 'hvac' in solution.lower()) and ('alert' in solution.lower() or 'monitor' in solution.lower())"
    },
    {
      "id": "tc4-procedures",
      "description": "Emergency response procedures",
      "input": "Disaster recovery",
      "expected": "Evacuation, shutdown, recovery procedures documented",
      "assert": "assert ('evacuation' in solution.lower() or 'emergency' in solution.lower()) and ('shutdown' in solution.lower() or 'recovery' in solution.lower())"
    },
    {
      "id": "tc5-visitor-control",
      "description": "Visitor access management",
      "input": "Access policies",
      "expected": "Visitor badges, escort requirements, restricted areas defined",
      "assert": "assert 'visitor' in solution.lower() and ('escort' in solution.lower() or 'badge' in solution.lower() or 'restricted' in solution.lower())"
    },
    {
      "id": "tc6-fire-suppression",
      "description": "Fire suppression system selection",
      "input": "Fire protection",
      "expected": "Data center appropriate system (FM-200 or equivalent, not water sprinklers)",
      "assert": "assert ('fm-200' in solution.lower() or 'halon' in solution.lower() or 'gas' in solution.lower()) and 'water' not in solution.lower().split('sprinkler')[0]"
    },
    {
      "id": "tc7-cost-benefit",
      "description": "ROI and cost-benefit analysis",
      "input": "Financial justification",
      "expected": "Security cost compared against incident costs and ROI calculated",
      "assert": "assert ('cost' in solution.lower() or 'roi' in solution.lower() or 'investm' in solution.lower()) and ('benefit' in solution.lower() or 'loss' in solution.lower())"
    },
    {
      "id": "tc8-forensics",
      "description": "Access logs and investigation capability",
      "input": "Incident investigation",
      "expected": "Access logs enabling forensic analysis of security breaches",
      "assert": "assert ('log' in solution.lower() or 'audit' in solution.lower()) and ('forensic' in solution.lower() or 'investigate' in solution.lower() or 'evidence' in solution.lower())"
    },
    {
      "id": "tc9-rto-rpo",
      "description": "Recovery objectives definition",
      "input": "Availability targets",
      "expected": "RTO and RPO defined with business justification",
      "assert": "assert ('rto' in solution.lower() or 'recovery time' in solution.lower()) and ('rpo' in solution.lower() or 'recovery point' in solution.lower())"
    },
    {
      "id": "tc10-threats",
      "description": "Identified physical security threats",
      "input": "Risk analysis",
      "expected": "Multiple specific threats addressed (unauthorized access, theft, environmental, fire)",
      "assert": "assert ('threat' in solution.lower() or 'risk' in solution.lower()) and len([s for s in solution.lower().split() if s in ['theft', 'fire', 'access', 'environmental', 'failure']]) >= 3"
    }
  ]
}
