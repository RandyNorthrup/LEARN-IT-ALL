{
  "id": "exercise-021-power-over-ethernet",
  "lessonId": "lesson-021-power-over-ethernet",
  "title": "Power over Ethernet: Standards, Power Budgeting, and Troubleshooting",
  "description": "You are a network engineer designing and maintaining PoE deployments across your organization. Complete realistic scenarios involving PoE standard selection, power budget calculations, device power requirement analysis, infrastructure planning, and troubleshooting PoE-related outages in complex multi-device networks.",
  "difficulty": "advanced",
  "points": 100,
  "language": "cisco-ios",
  "starterCode": "# ============================================================================\n# NETWORK CONTEXT - POE INFRASTRUCTURE DESIGN\n# ============================================================================\n# Your company is rolling out VoIP phones, wireless access points, and IP\n# cameras across its three office buildings. Currently powered by separate\n# power supplies. Goal: Migrate to Power over Ethernet for cost reduction\n# and easier management.\n#\n# Building A (Headquarters) - 48-port switch\n#   - 40 VoIP phones (IP phones + 40 sets of headsets)\n#   - 20 wireless access points (high-density WiFi 6)\n#   - 4 PTZ surveillance cameras (pan/tilt/zoom)\n#   - 2 door access control readers\n#\n# Building B (Branch Office) - 24-port switch\n#   - 16 VoIP phones\n#   - 8 wireless access points\n#   - 2 static IP cameras (non-PTZ)\n#\n# Building C (Warehouse) - 48-port switch\n#   - 8 VoIP phones\n#   - 16 wireless access points\n#   - 12 IoT environmental sensors\n#   - 4 LED lighting controllers\n#   - 2 PTZ cameras for loading dock\n#\n# Current Problems:\n# - Complex power distribution (separate circuits everywhere)\n# - No centralized power management\n# - Cannot remotely manage power to devices\n# - High installation and maintenance costs\n#\n# Goal: Use PoE for all devices, calculate power budgets, select appropriate\n# switch models, and plan migration.\n#\n# ============================================================================\n\n# ============================================================================\n# SCENARIO 1: POE STANDARDS FUNDAMENTALS\n# ============================================================================\n# Your company asks: \"What PoE standard do we need?\"\n# You must understand different standards and recommend appropriate one.\n#\n# TASK 1.1: Name the main PoE standards (IEEE 802.3)\n# Oldest standard (2003): 802.3________\n# Name: __________ (abbrev: __________)\n# Power: __________ W (at PSE)\n#\n# Middle standard (2009): 802.3________\n# Name: __________ (abbrev: __________)\n# Power: __________ W (at PSE)\n# Backward compatible with 802.3af: Yes / No __________\n#\n# Newest standard (2018): 802.3________\n# Name: __________ (abbrev: __________)\n# Power Type 3: __________ W (at PSE)\n# Power Type 4: __________ W (at PSE)\n#\n# TASK 1.2: Fill in the standard comparison table\n#\n# | Standard | Year | Power (PSE) | Power (PD) | Voltage | Pairs Used | Typical Devices |\n# |----------|------|-------------|------------|---------|------------|                 |\n# | 802.3af  | ____ | ____ W      | 12.95 W    | 48V     | 2 pairs    | ________________ |\n# | 802.3at  | ____ | ____ W      | 25.5 W     | 48V     | 2 pairs    | ________________ |\n# | 802.3bt-3| ____ | ____ W      | 51 W       | 48V     | 4 pairs    | ________________ |\n# | 802.3bt-4| ____ | ____ W      | 71 W       | 48V     | 4 pairs    | ________________ |\n#\n# TASK 1.3: Why does PD power < PSE power?\n# Example: 802.3at PSE provides 30W, but PD only gets 25.5W\n# What causes this loss? __________\n# How much power is lost? __________\n# (Answer as percentage: __________ % loss)\n#\n# TASK 1.4: Typical device power requirements\n# Match device to minimum PoE standard needed:\n# \n# Basic VoIP phone (7W) → Standard: __________\n# High-end PTZ camera (55W) → Standard: __________\n# Wireless access point 802.11ac (20W) → Standard: __________\n# WiFi 6E access point (35W) → Standard: __________\n# Door access control reader (5W) → Standard: __________\n# IoT sensor (2W) → Standard: __________\n#\n\n# ============================================================================\n# SCENARIO 2: POE COMPONENTS AND DELIVERY METHODS\n# ============================================================================\n# Understanding the PoE infrastructure components\n#\n# TASK 2.1: PSE types - Endspan vs Midspan\n#\n# Endspan (built-in PoE):\n# - Definition: __________\n# - Example: __________\n# - Advantage: __________\n# - Disadvantage: __________\n#\n# Midspan (PoE Injector):\n# - Definition: __________\n# - Example: __________\n# - Advantage: __________\n# - Disadvantage: __________\n#\n# Diagram (which would you use for each scenario?):\n# Scenario A: New switch purchase for building\n#   Use: Endspan / Midspan __________\n#   Why: __________\n#\n# Scenario B: Existing non-PoE switch, need to power 1 IP camera\n#   Use: Endspan / Midspan __________\n#   Why: __________\n#\n# Scenario C: Existing non-PoE switch, need to power 15 devices\n#   Use: Endspan / Midspan __________\n#   Why: __________\n#\n# TASK 2.2: PoE power delivery pins\n# Alternative A (Data Pairs):\n#   - Pins used: __________ (for data on Cat5e 10/100)\n#   - Pairs used: 2 pairs\n#   - Problem with 1000 Ethernet: __________\n#\n# Alternative B (Spare Pairs):\n#   - Pins used: __________ (for 10/100 Ethernet)\n#   - Pairs used: 2 pairs\n#   - Problem with 1000 Ethernet: __________\n#\n# 802.3bt (PoE++):\n#   - Pins used: __________ (all 8 pins)\n#   - Power delivery: All 4 pairs carry power\n#   - Benefit: __________\n#\n# TASK 2.3: Cable considerations\n# Match cable to PoE standard:\n# \n# 802.3af (15W) minimum: Cat____ (but recommend Cat____)\n# 802.3at (30W) minimum: Cat____ (but recommend Cat____)\n# 802.3bt (60-100W) minimum: Cat____ (but recommend Cat____)\n#\n# Why use higher category cables?\n# __________\n#\n# Max cable distance: __________ meters\n# Power loss consideration: Longer cables = __________ power available\n#\n\n# ============================================================================\n# SCENARIO 3: POE DETECTION AND NEGOTIATION\n# ============================================================================\n# How PoE safely powers devices\n#\n# TASK 3.1: Fill in the PoE detection sequence\n# \n# Step 1: Detection Phase\n# - PSE applies low voltage: __________ V DC\n# - Measures resistance: __________ kΩ for PoE device\n# - Non-PoE devices: Different resistance (__))\n# - Result: PSE identifies if device is PoE-capable\n#\n# Step 2: Classification Phase\n# - PSE sends: __________ to determine power class\n# - PD draws: Specific current based on power needs\n# - PSE learns: How much power to provide\n#\n# Step 3: Power On Phase\n# - PSE ramps up voltage: __________ V DC\n# - PD powers on\n# - Data communication begins\n#\n# Step 4: Monitoring Phase\n# - PSE continuously: __________ power draw\n# - If PD disconnects: __________\n# - Purpose: Prevent power waste\n#\n# TASK 3.2: Safety considerations\n# Is PoE safe for non-PoE devices? Yes / No __________\n# Why? __________\n#\n# Worst case scenario:\n# You accidentally connect non-PoE device to PoE switch port\n# Result: __________\n#\n\n# ============================================================================\n# SCENARIO 4: POE POWER BUDGET CALCULATION\n# ============================================================================\n# The most critical skill: calculating if switch has enough power for devices\n#\n# TASK 4.1: Building A power budget calculation\n# \n# Building A devices:\n# - 40× VoIP phones @ 7W each = __________ W\n# - 20× WiFi 6 access points @ 25W each = __________ W\n# - 4× PTZ cameras @ 60W each = __________ W\n# - 2× Door readers @ 5W each = __________ W\n#\n# Total power needed: __________ W\n#\n# Switch specifications:\n# - Model: Cisco 48-port PoE+ switch\n# - PoE budget available: 740W\n# \n# Can switch power all devices? Yes / No __________\n# By how much does budget exceed/fall short? __________ W\n#\n# If insufficient budget, what are solutions?\n# 1. __________\n# 2. __________\n# 3. __________\n#\n# TASK 4.2: Building B power budget calculation\n# \n# Building B devices:\n# - 16× VoIP phones @ 7W each = __________ W\n# - 8× Wireless APs @ 15W each = __________ W\n# - 2× Static cameras (non-PTZ) @ 10W each = __________ W\n#\n# Total power needed: __________ W\n#\n# Switch specifications:\n# - Model: Cisco 24-port PoE+ switch\n# - PoE budget available: 370W\n# \n# Can switch power all devices? Yes / No __________\n# Safety margin (budget - required): __________ W\n#\n# TASK 4.3: Building C complex calculation\n# \n# Building C devices:\n# - 8× VoIP phones @ 7W each = __________ W\n# - 16× Wireless APs @ 25W each (WiFi 6) = __________ W\n# - 12× IoT sensors @ 3W each = __________ W\n# - 4× LED controllers @ 45W each = __________ W\n# - 2× PTZ cameras @ 60W each = __________ W\n#\n# Total power needed: __________ W\n#\n# Switch options:\n# Option A: Cisco 48-port PoE+ switch = 740W budget\n#   Can power all? Yes / No __________\n#   Headroom: __________ W\n#\n# Option B: Cisco 48-port PoE++ switch = 1440W budget\n#   Can power all? Yes / No __________\n#   Headroom: __________ W\n#\n# Recommendation: __________\n# Cost-benefit analysis: __________\n#\n# TASK 4.4: Multi-switch design\n# You need to power 50 devices totaling 1200W, but only have 740W switches\n# Design a solution:\n# \n# Switch 1 (740W):\n# - Devices: __________\n# - Total power: __________ W\n#\n# Switch 2 (740W):\n# - Devices: __________\n# - Total power: __________ W\n#\n# Result: Distribute load across switches, no single switch overloaded\n#\n\n# ============================================================================\n# SCENARIO 5: POWER ALLOCATION AND PRIORITIES\n# ============================================================================\n# When power budget is tight, switches use priority-based allocation\n#\n# TASK 5.1: Priority levels\n# PoE switches support port priorities:\n# - Critical (1): __________\n# - High (2): __________\n# - Low (3): __________\n#\n# Example priority assignment:\n# - VoIP phones (Critical) - business communication\n# - Wireless APs (High) - user connectivity\n# - IoT sensors (Low) - monitoring only\n#\n# TASK 5.2: Insufficient budget scenario\n# Switch has 740W budget\n# All ports requesting 900W total\n#\n# Switch allocates power in priority order:\n# 1. Critical ports until 700W allocated\n# 2. High ports with remaining 40W\n# 3. Low ports get: __________ W (denied)\n#\n# If critical port fails (e.g., reboots), PSE:\n# - Shuts down its power\n# - Allows next port in queue to power on\n# - Process continues until under budget\n#\n# TASK 5.3: First-come, first-served allocation\n# Some switches use FCFS instead of priority:\n# - First devices to connect get power\n# - Once budget exhausted, later devices denied\n#\n# Problem: __________\n# (What if high-priority device connects after low-priority?)\n#\n# Solution: Set explicit port priorities\n#\n\n# ============================================================================\n# SCENARIO 6: CABLE AND DISTANCE CONSIDERATIONS\n# ============================================================================\n#\n# TASK 6.1: Cable selection for PoE\n# Building A has existing Cat5e cabling, wants to deploy PoE++\n# Can existing Cat5e support PoE++? Yes / No __________\n#\n# Technical issue: __________\n# Best practice: Use __________ or better\n# Why: __________\n#\n# TASK 6.2: Distance and power loss\n# Scenario: 100m run from switch to IP camera\n# Cable: Cat5e\n# PoE standard: 802.3at (30W @ PSE, 25.5W @ PD)\n#\n# At 100m, typical power loss: __________ % \n# Power actually reaching device: __________ W\n# Device needs: 20W\n# Result: Enough power? Yes / No __________\n#\n# Scenario B: 200m run (if we ignore 100m limit)\n# Power loss increases significantly\n# At 200m, power available: ~15W\n# Device needs: 20W\n# Result: Device won't power on (not enough power)\n# Solution: Don't exceed 100m limit, or use higher PoE standard\n#\n# TASK 6.3: Practical cable planning\n# Your building has 3 switch locations\n# Device placement requires these distances:\n# - Location A: 40m away → Cable: Cat____ (minimum)\n# - Location B: 80m away → Cable: Cat____ (minimum)\n# - Location C: 100m away → Cable: Cat____ (minimum)\n# - Location D: 150m away → Solution: __________\n#\n\n# ============================================================================\n# SCENARIO 7: POE TROUBLESHOOTING\n# ============================================================================\n#\n# TASK 7.1: Device not powering on\n# Your new VoIP phone connects to switch but won't turn on\n#\n# Troubleshooting sequence:\n# Step 1: Verify PSE port has PoE enabled\n#   Command: __________\n#   Look for: Port enabled, power allocated\n#\n# Step 2: Check power budget\n#   Command: __________\n#   Issue: Available power = 0W (budget exhausted)\n#   Solution: __________\n#\n# Step 3: Verify cable\n#   - All 4 pairs connected: Yes / No\n#   - Length < 100m: Yes / No\n#   - No visible damage: Yes / No\n#   Test: Replace with known-good cable\n#\n# Step 4: Check device requirements\n#   Device needs: 25W (PoE+)\n#   Port provides: 15W (802.3af only)\n#   Solution: Connect to PoE+ port (30W capable)\n#\n# Step 5: Test with PoE injector\n#   Purpose: Isolate whether issue is switch or device\n#   If device works with injector: Switch port problem\n#\n# TASK 7.2: Device intermittently losing power\n# WiFi AP randomly reboots (power cycling)\n#\n# Possible causes:\n# 1. __________ - power budget near limit, device briefly denied\n# 2. __________ - connection loose, interrupting power\n# 3. __________ - device drawing more power than allocated\n# 4. __________ - PSE detecting short circuit, cycling power\n#\n# Investigation:\n# - Check power draw: Is device within budget? __________\n# - Monitor port status: Does port show errors/resets? __________\n# - Check cable: Is connection solid or loose? __________\n#\n# TASK 7.3: Entire building loses power to all PoE devices\n# Scenario: All 40 devices in Building A suddenly lose power\n# Only Building B and Building C still have power\n# Links remain up (lights on)\n#\n# Problem is NOT:\n# - Individual devices (too many affected)\n# - Cables (too many affected)\n# - PoE enabled/disabled (links up)\n#\n# Likely problem:\n# A) Switch power supply failed\n# B) Switch PoE module failed (PSE electronics)\n# C) Network administrator disabled PoE\n# D) Building power circuit breaker tripped\n# Answer: __________\n#\n# How to verify:\n# - Check switch power LED: __________\n# - Check switch logs: __________\n# - Check building breaker: __________\n#\n# TASK 7.4: Mixed PoE standards\n# You have:\n# - Old 802.3af phones (12W) on 802.3bt switch\n# - New 802.3bt devices (70W) on same switch\n#\n# Will old phones work? Yes / No __________ (backward compatible)\n# Will new devices work? Yes / No __________ (forward compatible)\n#\n# Power budget consideration:\n# If switch 802.3bt budget = 1440W\n# Is there enough for all? Yes / No __________\n# Why it matters: Mixing standards requires careful budget planning\n#\n\n# ============================================================================\n# SCENARIO 8: CISCO POE COMMANDS\n# ============================================================================\n#\n# TASK 8.1: Show power status\n# Command to verify PoE on ports:\n# __________\n#\n# Output interpretation:\n# Interface     Oper     Power    Device Class\n# Gi0/1         On       7.0      Cisco IP Phone\n# Gi0/2         On       25.5     Wireless AP\n# Gi0/3         Off      0.0      (not connected)\n# Gi0/4         Failed   N/A      Overcurrent\n#\n# What does \"Failed\" mean? __________\n#\n# TASK 8.2: Show power summary\n# Command: __________\n#\n# Output shows total:\n# - Available power: 740W\n# - Used power: 685W\n# - Remaining: __________ W\n#\n# TASK 8.3: Enable/disable PoE on specific port\n# Command format: __________\n# Example: __________\n#\n# TASK 8.4: Set port priority\n# Command format: __________\n# Example: __________\n#\n# Priorities: critical / high / low\n#\n\n# ============================================================================\n# SCENARIO 9: MIGRATION PLANNING\n# ============================================================================\n#\n# TASK 9.1: Current state (non-PoE)\n# Building A currently has:\n# - Separate power supplies for 40 phones\n# - 20 APs with dedicated circuits\n# - 4 cameras with UPS backup\n# - 2 door readers with battery backup\n#\n# Problems:\n# 1. __________\n# 2. __________\n# 3. __________\n#\n# TASK 9.2: Target state (PoE)\n# After migration:\n# - All devices powered from switch\n# - Centralized power management\n# - UPS backs up switch (single device) vs many devices\n# - Remote power on/off control\n#\n# Benefits:\n# 1. Reduced cost (single power infrastructure)\n# 2. Easier management\n# 3. Centralized power budget visibility\n# 4. __________\n#\n# TASK 9.3: Migration steps\n# Phase 1: __________\n# Phase 2: __________\n# Phase 3: __________\n#\n# Rollback plan: __________\n#\n# TASK 9.4: Cost-benefit analysis\n# Costs:\n# - New PoE switches: $____ each\n# - New Cat6 cabling: $____ per port\n# - Installation: $____ labor\n# - Total: $____\n#\n# Benefits (over 5 years):\n# - Reduced electrical work: $____\n# - Consolidated power management: $____\n# - Improved reliability: $____\n# - Total: $____\n#\n# ROI: __________\n#\n",
  "solution": "# ============================================================================\n# SCENARIO 1: POE STANDARDS FUNDAMENTALS (SOLUTIONS)\n# ============================================================================\n\n# TASK 1.1: PoE standards (IEEE 802.3)\n# Oldest (2003): 802.3af\n# Name: Power over Ethernet (abbrev: PoE)\n# Power: 15.4 W (at PSE)\n#\n# Middle (2009): 802.3at\n# Name: Power over Ethernet Plus (abbrev: PoE+)\n# Power: 30 W (at PSE)\n# Backward compatible: YES\n#\n# Newest (2018): 802.3bt\n# Name: Power over Ethernet ++ (abbrev: PoE++)\n# Power Type 3: 60 W (at PSE)\n# Power Type 4: 100 W (at PSE)\n#\n# TASK 1.2: Standard comparison\n# | Standard | Year | Power (PSE) | Power (PD) | Voltage | Pairs Used | Typical Devices |\n# |----------|------|-------------|------------|---------|------------|                 |\n# | 802.3af  | 2003 | 15.4 W      | 12.95 W    | 48V     | 2 pairs    | Basic phones, low-power APs |\n# | 802.3at  | 2009 | 30 W        | 25.5 W     | 48V     | 2 pairs    | Video phones, PTZ cameras, WiFi 6 APs |\n# | 802.3bt-3| 2018 | 60 W        | 51 W       | 48V     | 4 pairs    | High-end PTZ, video conferencing |\n# | 802.3bt-4| 2018 | 100 W       | 71 W       | 48V     | 4 pairs    | Laptops, digital signage, high-power APs |\n#\n# TASK 1.3: Power loss explanation\n# What causes loss? Resistance in cable (copper wires) dissipates power as heat\n# How much power is lost? 30W - 25.5W = 4.5W\n# Loss percentage: 4.5 / 30 = 15% loss (typical)\n#\n# The longer the cable, the more power lost\n# At 100m (max distance), losses are highest\n# This is why PSE provides more power than PD receives\n#\n# TASK 1.4: Device power requirement matching\n# Basic VoIP phone (7W) → 802.3af (minimum 15.4W, provides 12.95W at device)\n# High-end PTZ camera (55W) → 802.3bt-3 (minimum 60W)\n# WiFi AP 802.11ac (20W) → 802.3at (minimum 30W, provides 25.5W)\n# WiFi 6E AP (35W) → 802.3bt-3 or higher (needs 60W to be safe)\n# Door access reader (5W) → 802.3af (15.4W sufficient)\n# IoT sensor (2W) → 802.3af (15.4W more than enough)\n#\n\n# ============================================================================\n# SCENARIO 2: POE COMPONENTS AND DELIVERY METHODS (SOLUTIONS)\n# ============================================================================\n\n# TASK 2.1: Endspan vs Midspan\n#\n# Endspan (built-in PoE):\n# - Definition: PoE capability built into network switch itself\n# - Example: Cisco Catalyst 2960-X PoE+ switch\n# - Advantage: All ports capable of PoE, centralized management\n# - Disadvantage: Must buy new switch (can't upgrade existing)\n#\n# Midspan (PoE Injector):\n# - Definition: External device that injects power into Ethernet cable\n# - Example: Standalone PoE injector module\n# - Advantage: Works with existing non-PoE switches\n# - Disadvantage: Limited to single port/few ports per injector\n#\n# Scenario usage:\n# Scenario A: New switch purchase → Endspan (built into switch)\n# Scenario B: Single device on existing switch → Midspan (cheaper than new switch)\n# Scenario C: 15 devices on existing switch → Endspan (need full PoE switch, replace old one)\n#\n# TASK 2.2: PoE power delivery pins\n#\n# Alternative A (Data Pairs):\n# - Pins used: 1-2 (TX+) and 3-6 (TX-)\n# - Problem with 1000 Ethernet: All 4 pairs used for data, no spare pairs for power\n#   Must use Alternative B or 4-pair PoE\n#\n# Alternative B (Spare Pairs):\n# - Pins used: 4-5 (blue/white) and 7-8 (brown/white)\n# - Problem with 1000 Ethernet: Same as Alternative A\n#   1000Base-T uses all 4 pairs for data (bidirectional)\n#\n# 802.3bt (PoE++):\n# - Pins used: All 8 pins (all 4 pairs)\n# - Power delivery: All 4 pairs carry power simultaneously\n# - Benefit: Doubles power capacity (60W or 100W possible)\n#\n# TASK 2.3: Cable selection\n# 802.3af (15W) minimum: Cat3 (but recommend Cat5e for reliability)\n# 802.3at (30W) minimum: Cat5 (but recommend Cat5e)\n# 802.3bt (60-100W) minimum: Cat5e (but recommend Cat6 or Cat6A)\n#\n# Why use higher category?\n# - Higher category = thicker copper conductors\n# - Thicker wires = less resistance = less power loss\n# - PoE++ uses all 4 pairs simultaneously = more heat\n# - Cat6/Cat6A handles heat better (better shielding, insulation)\n#\n# Max cable distance: 100 meters (328 feet)\n# Power loss: Longer cables lose more power due to resistance\n#\n\n# ============================================================================\n# SCENARIO 3: POE DETECTION AND NEGOTIATION (SOLUTIONS)\n# ============================================================================\n\n# TASK 3.1: Detection sequence\n#\n# Step 1: Detection Phase\n# - PSE applies low voltage: 2.8-10V DC\n# - Measures resistance: 23.75-26.25 kΩ\n# - Non-PoE devices: Different resistance (device ignored)\n# - Result: PSE knows if PoE device is connected\n#\n# Step 2: Classification Phase\n# - PSE sends: Classification pulse/voltage\n# - PD draws: Specific current based on power class\n# - PSE learns: What power class PD is (how much to allocate)\n#\n# Step 3: Power On Phase\n# - PSE ramps up voltage: 48V DC\n# - PD powers on\n# - Data communication begins (Ethernet)\n#\n# Step 4: Monitoring Phase\n# - PSE continuously: Monitors current draw\n# - If PD disconnects: Detects dropped load\n# - Purpose: Prevents power waste, enables power cycling\n#\n# TASK 3.2: Safety\n# Is PoE safe for non-PoE devices? YES\n# Why? Detection phase (step 1) ensures only PoE devices get full 48V\n# Non-PoE devices are simply ignored (low voltage doesn't harm them)\n#\n# Worst case: You connect non-PoE device to PoE switch\n# Result: Device is ignored, no power supplied, no damage\n# (Detection phase fails because non-PoE resistance doesn't match)\n#\n\n# ============================================================================\n# SCENARIO 4: POE POWER BUDGET CALCULATION (SOLUTIONS)\n# ============================================================================\n\n# TASK 4.1: Building A calculation\n# - 40× VoIP phones @ 7W each = 280 W\n# - 20× WiFi 6 APs @ 25W each = 500 W\n# - 4× PTZ cameras @ 60W each = 240 W\n# - 2× Door readers @ 5W each = 10 W\n# Total: 1030 W\n#\n# Switch has 740W budget\n# Can power all devices? NO (need 1030W, only have 740W)\n# Shortfall: 1030 - 740 = 290W over budget\n#\n# Solutions:\n# 1. Add second 740W switch (split devices: 500W on each)\n# 2. Upgrade to PoE++ switch with 1440W budget\n# 3. Remove lowest-priority devices or use external power for some\n# 4. Replace PTZ cameras (60W each) with static cameras (10W), or use midspan injectors\n#\n# TASK 4.2: Building B calculation\n# - 16× VoIP phones @ 7W each = 112 W\n# - 8× Wireless APs @ 15W each = 120 W\n# - 2× Static cameras @ 10W each = 20 W\n# Total: 252 W\n#\n# Switch has 370W budget\n# Can power all? YES (need 252W, have 370W)\n# Safety margin: 370 - 252 = 118W remaining\n#\n# This is comfortable (30% headroom for future growth)\n#\n# TASK 4.3: Building C calculation\n# - 8× VoIP phones @ 7W each = 56 W\n# - 16× WiFi 6 APs @ 25W each = 400 W\n# - 12× IoT sensors @ 3W each = 36 W\n# - 4× LED controllers @ 45W each = 180 W\n# - 2× PTZ cameras @ 60W each = 120 W\n# Total: 792 W\n#\n# Option A: PoE+ (740W budget)\n# Can power all? NO (need 792W, only have 740W)\n# Shortfall: 52W\n#\n# Option B: PoE++ (1440W budget)\n# Can power all? YES (need 792W, have 1440W)\n# Headroom: 648W (45% unused - good for future expansion)\n#\n# Recommendation: Option B (PoE++ switch with 1440W)\n# Cost-benefit: Higher initial cost but supports future growth\n#\n# TASK 4.4: Multi-switch design (1200W devices, 740W each switch)\n#\n# Switch 1 (740W):\n# - 16 WiFi 6 APs @ 25W = 400W\n# - 4 LED controllers @ 45W = 180W\n# - 12 IoT sensors @ 3W = 36W\n# - 8 VoIP phones @ 7W = 56W\n# Total: 672W (within 740W budget)\n#\n# Switch 2 (740W):\n# - 8 VoIP phones @ 7W = 56W\n# - 4 PTZ cameras @ 60W = 240W\n# - Remaining capacity for future devices = 444W\n# Total: 296W (well within budget)\n#\n# Result: Balanced distribution, no overloaded switches\n#\n\n# ============================================================================\n# SCENARIO 5: POWER ALLOCATION AND PRIORITIES (SOLUTIONS)\n# ============================================================================\n\n# TASK 5.1: Priority levels\n# - Critical (1): Business critical (VoIP phones, security cameras)\n# - High (2): Important but less critical (Wireless APs)\n# - Low (3): Monitoring/non-essential (IoT sensors)\n#\n# TASK 5.2: Insufficient budget allocation\n# Switch has 740W, all ports requesting 900W\n#\n# Allocation sequence:\n# 1. Critical ports get power first (700W used)\n# 2. High ports receive remaining 40W\n# 3. Low priority ports get: 0W (denied)\n#\n# If critical port fails:\n# - Its power is freed up (0W = fails = no current draw)\n# - Next port in queue gets its power\n# - Cascade continues until within budget\n#\n# TASK 5.3: First-come, first-served problem\n# Problem: If high-priority device connects later, it might not get power\n# because low-priority device already consumed budget\n# Result: Priority becomes meaningless\n#\n# Solution: Explicitly configure port priorities\n# PSE respects configured priorities, not connection time\n#\n\n# ============================================================================\n# SCENARIO 6: CABLE AND DISTANCE CONSIDERATIONS (SOLUTIONS)\n# ============================================================================\n\n# TASK 6.1: PoE++ with Cat5e\n# Can Cat5e support PoE++? NO (not recommended)\n#\n# Technical issue:\n# - PoE++ uses all 4 pairs simultaneously for power\n# - PoE++ at 100W = high current flow\n# - Thinner Cat5e conductors = more resistance\n# - More current + more resistance = more heat\n# - Cat5e may overheat, damaging insulation\n#\n# Best practice: Use Cat6 or Cat6A\n# Why: Thicker conductors handle current better, dissipate heat\n#\n# TASK 6.2: Distance and power loss (100m Cat5e, PoE+)\n# At 100m, typical power loss: 15-20%\n# Assume 20% loss for conservative estimate:\n# Power at PSE: 30W\n# Power loss: 30W × 0.20 = 6W\n# Power reaching device: 30W - 6W = 24W\n# Device needs: 20W\n# Result: YES, enough power (24W > 20W)\n#\n# At 200m (exceeding standard):\n# Power loss increases significantly (maybe 40%)\n# Power reaching device: ~18W\n# Device needs: 20W\n# Result: NOT enough power - device won't turn on\n# Solution: Don't exceed 100m limit, use higher PoE standard, or use Cat6\n#\n# TASK 6.3: Practical planning\n# - 40m away: Cat5 minimum (but Cat5e recommended)\n# - 80m away: Cat5e minimum\n# - 100m away: Cat5e minimum (at distance limit)\n# - 150m away: Solution = Use midspan injector closer to device, or extend with another switch\n#\n\n# ============================================================================\n# SCENARIO 7: POE TROUBLESHOOTING (SOLUTIONS)\n# ============================================================================\n\n# TASK 7.1: Device not powering on\n# Troubleshooting sequence:\n#\n# Step 1: Verify PoE enabled\n# Command: show power inline\n# Look for: Port enabled/active, power allocated\n#\n# Step 2: Check power budget\n# Command: show power inline\n# Issue: Available power = 0W (budget exhausted)\n# Solution: Disable PoE on low-priority ports or upgrade switch\n#\n# Step 3: Verify cable\n# - All 4 pairs connected: Must check\n# - Length < 100m: Standard requirement\n# - No visible damage: Physical inspection\n# Test: Replace with known-good cable\n#\n# Step 4: Check device requirements\n# Device needs: 25W (PoE+)\n# Port provides: 15W (802.3af)\n# Solution: Connect to PoE+ port (30W capable)\n#\n# Step 5: Test with PoE injector\n# Purpose: Device works with injector = switch port problem\n#\n# TASK 7.2: Intermittent power loss (device reboots)\n# Possible causes:\n# 1. Power budget near limit - device briefly denied power when others connect\n# 2. Loose cable connection - intermittent contact loss\n# 3. Device drawing more power than allocated - negotiation mismatch\n# 4. PSE detecting brief short circuit - protective cycling\n#\n# Investigation:\n# - Check power draw: Monitor with show power inline (detailed)\n# - Monitor port status: Watch for errors/resets in logs\n# - Check cable: Inspect physical connection, try different port\n#\n# TASK 7.3: Building-wide power loss (only links up)\n# Likely problem: B) Switch PoE module failed (PSE electronics)\n# or D) Building power breaker tripped (no switch power at all)\n#\n# Why not A (PSE failed)? Links still work = switch powered\n# Why not B (cables)? Too many affected = not cable issue\n#\n# Verify:\n# - Check switch power LED: Should be green\n# - Check switch logs: Any error messages about PSE module\n# - Check building breaker: Is PDU/outlet powered\n#\n# TASK 7.4: Mixed PoE standards\n# Will old 802.3af phones work on 802.3bt switch? YES\n# (Backward compatible - switch supports all standards)\n#\n# Will new 802.3bt devices work? YES\n# (Forward compatible - 802.3bt switch handles legacy)\n#\n# Power budget: 1440W PoE++ can easily power all\n# Mixing standards works fine (just use budget planning)\n#\n\n# ============================================================================\n# SCENARIO 8: CISCO POE COMMANDS (SOLUTIONS)\n# ============================================================================\n\n# TASK 8.1: Show power status\n# Command: show power inline\n#\n# \"Failed\" means: Port detected short circuit or over-current\n# PSE shut down power to protect equipment\n# Requires manual intervention to re-enable\n#\n# TASK 8.2: Show power summary\n# Command: show power inline [module-number]\n#\n# Remaining power: 740W - 685W = 55W\n#\n# TASK 8.3: Enable/disable PoE on specific port\n# Command: power inline [on|off]\n# Example: int gi0/1\n#          power inline on\n#\n# TASK 8.4: Set port priority\n# Command: power inline priority [critical|high|low]\n# Example: int gi0/1\n#          power inline priority critical\n#\n\n# ============================================================================\n# SCENARIO 9: MIGRATION PLANNING (SOLUTIONS)\n# ============================================================================\n\n# TASK 9.1: Current problems (non-PoE)\n# 1. Complex electrical infrastructure (multiple circuits, outlets everywhere)\n# 2. Difficult to manage centrally (no unified power control)\n# 3. High installation costs (electrical contractors needed)\n# 4. Inconsistent backup power (separate UPS per device)\n# 5. Takes up physical space (multiple power supplies)\n#\n# TASK 9.2: Migration benefits\n# 1. Reduced cost (single power infrastructure)\n# 2. Easier management (centralized switch power control)\n# 3. Better redundancy (single UPS backs up all devices)\n# 4. Remote management (power on/off without physical access)\n# 5. Scalability (add devices without electrical work)\n# 6. Safety (lower voltage on cables vs 110V lines)\n#\n# TASK 9.3: Migration steps\n# Phase 1: Install new PoE switches (keep old infrastructure)\n# Phase 2: Migrate devices one building/floor at a time (test thoroughly)\n# Phase 3: Retire old power supplies and cabling (after migration complete)\n#\n# Rollback plan: Keep old power supplies for 30-60 days\n# If PoE migration fails, can quickly revert to old system\n#\n# TASK 9.4: Cost-benefit (example)\n# Costs:\n# - New PoE switches: $2,000 each × 3 buildings = $6,000\n# - Cat6 cabling: $0.50/foot × 10,000 feet = $5,000\n# - Installation: $8,000 labor\n# - Total: $19,000\n#\n# Benefits (5 years):\n# - Reduced electrical work: $15,000\n# - Consolidated power management: $8,000\n# - Improved reliability/reduced downtime: $10,000\n# - Scalability (future devices): $5,000\n# - Total: $38,000\n#\n# ROI: ($38,000 - $19,000) / $19,000 = 100% ROI (breaks even in 2.5 years)\n#\n",
  "hints": [
    "PoE standards: 802.3af (15W, 2003), 802.3at (30W, 2009), 802.3bt (60-100W, 2018)",
    "Power at PSE > Power at device due to cable resistance (typical 15-20% loss)",
    "Endspan = PoE built into switch (buy new switch), Midspan = external injector (retrofit existing)",
    "All 4 pairs in use determines cable pin assignment and PoE++ capability",
    "Power budget calculation is CRITICAL - PSE power ÷ switch ports ≠ power per port (total budget limit)",
    "When over budget: use priority-based allocation (critical first, then high, then low)",
    "Maximum cable distance: 100 meters (standardized limit, longer = power loss)",
    "Cat5e minimum for PoE+ (30W), Cat6/Cat6A recommended for PoE++ (60-100W) due to heat",
    "Detection phase uses low voltage (2.8-10V) to test resistance (23.75-26.25 kΩ) for PoE device",
    "Backward compatible: 802.3bt switch powers 802.3af devices, forward compatible: all work together",
    "Common troubleshooting: budget exhausted, device needs higher PoE standard, cable too long/damaged",
    "Port priorities (critical/high/low) determine which devices get power when budget insufficient"
  ],
  "testCases": [
    {
      "id": "tc1",
      "description": "Understands PoE standards: 802.3af (15W), 802.3at (30W), 802.3bt (60-100W)",
      "validation": "assert ('802.3af' in code or '802.3at' in code or '802.3bt' in code) and ('15' in code or '30' in code or '60' in code or '100' in code)",
      "isHidden": false
    },
    {
      "id": "tc2",
      "description": "Knows power delivery concepts: PSE provides power, PD receives less due to cable resistance",
      "validation": "assert ('pse' in code.lower() or 'pd' in code.lower() or 'power' in code.lower()) and ('resistance' in code.lower() or 'loss' in code.lower() or 'cable' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc3",
      "description": "Understands Endspan vs Midspan: endspan is built-in switch, midspan is external injector",
      "validation": "assert ('endspan' in code.lower() or 'midspan' in code.lower()) and ('switch' in code.lower() or 'injector' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc4",
      "description": "Knows power budget calculation: total watts available limits devices that can be powered",
      "validation": "assert ('budget' in code.lower() or 'power' in code.lower()) and ('watt' in code.lower() or 'w' in code)",
      "isHidden": false
    },
    {
      "id": "tc5",
      "description": "Understands cable requirements: Cat5e for 802.3at, Cat6 for 802.3bt",
      "validation": "assert ('cat5' in code.lower() or 'cat6' in code.lower()) and ('cable' in code.lower() or '802.3' in code)",
      "isHidden": false
    },
    {
      "id": "tc6",
      "description": "Knows distance limitations: 100 meters maximum standard, longer distances lose more power",
      "validation": "assert ('100' in code or 'meter' in code.lower()) and ('distance' in code.lower() or 'loss' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc7",
      "description": "Understands PoE troubleshooting: budget exhausted, device needs higher standard, cable issues",
      "validation": "assert ('troubleshoot' in code.lower() or 'device' in code.lower()) and ('budget' in code.lower() or 'power' in code.lower() or 'cable' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc8",
      "description": "Knows PoE priority allocation: critical ports get power first when budget insufficient",
      "validation": "assert ('priority' in code.lower() or 'critical' in code.lower() or 'allocation' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc9",
      "description": "Understands detection and negotiation: detection phase identifies PoE devices safely",
      "validation": "assert ('detection' in code.lower() or 'negotiate' in code.lower()) and ('pse' in code.lower() or 'device' in code.lower())",
      "isHidden": false
    },
    {
      "id": "tc10",
      "description": "Total file size meets 10,000+ character minimum",
      "validation": "assert len(code) >= 10000",
      "isHidden": true
    },
    {
      "id": "tc11",
      "description": "Covers major lesson 021 concepts: standards, components, power budgeting, cable, troubleshooting",
      "validation": "assert code.count('task') >= 8 and ('poe' in code.lower() or '802.3' in code) and code.count(('standard', 'budget', 'troubleshoot', 'cable')) >= 3",
      "isHidden": true
    }
  ]
}
