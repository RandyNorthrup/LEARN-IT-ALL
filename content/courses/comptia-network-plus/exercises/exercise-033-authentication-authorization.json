{
  "id": "exercise-033-authentication-authorization",
  "lessonId": "lesson-033-authentication-authorization",
  "title": "Authentication Methods and Access Control Implementation",
  "description": "Design and implement authentication and authorization systems for a multi-tier enterprise network. Compare authentication methods, design access control strategies, implement role-based access control (RBAC), address authentication failures, and plan for compliance requirements.",
  "difficulty": "intermediate",
  "points": 100,
  "language": "text",
  "starterCode": "# AUTHENTICATION & AUTHORIZATION EXERCISE - Enterprise Access Control\n# Design multi-factor authentication and role-based access control\n\n## SCENARIO: TechCorp has 500 employees across multiple locations\n## - 300 office workers (sales, marketing, HR)\n## - 100 engineers (development, infrastructure, security)\n## - 50 contractors (temporary, project-based)\n## - 30 executives (C-level, finance, legal)\n## - 20 part-time staff (support, facilities)\n\n## Current issues:\n## - Shared credentials (employees sharing passwords)\n## - Weak password policies (too short, no complexity)\n## - No multi-factor authentication (all access via password only)\n## - Overly permissive access (users have access they don't need)\n## - No audit trail for critical access\n## - Compliance violations (HIPAA, PCI DSS, SOX require strong auth)\n\n## PART 1: AUTHENTICATION METHOD COMPARISON\n## Q1: Compare 5 authentication methods:\n##\n##     Method 1: Password only\n##     - Strengths: _______________\n##     - Weaknesses: _______________\n##     - Cost: $_____\n##     - Implementation time: ___\n##     - User friction: Low / Medium / High\n##     - Compliance: Acceptable? Yes/No\n##\n##     Method 2: Password + TOTP (Time-based One-Time Password / Authenticator app)\n##     - Strengths: _______________\n##     - Weaknesses: _______________\n##     - Cost: $_____\n##     - Implementation time: ___\n##     - User friction: Low / Medium / High\n##     - Compliance: Acceptable? Yes/No\n##\n##     Method 3: Password + SMS/Text OTP\n##     - Strengths: _______________\n##     - Weaknesses: _______________\n##     - Cost: $_____\n##     - Implementation time: ___\n##     - User friction: Low / Medium / High\n##     - Compliance: Acceptable? Yes/No\n##\n##     Method 4: Password + Hardware Token\n##     - Strengths: _______________\n##     - Weaknesses: _______________\n##     - Cost: $_____\n##     - Implementation time: ___\n##     - User friction: Low / Medium / High\n##     - Compliance: Acceptable? Yes/No\n##\n##     Method 5: Biometric (Fingerprint + Password)\n##     - Strengths: _______________\n##     - Weaknesses: _______________\n##     - Cost: $_____\n##     - Implementation time: ___\n##     - User friction: Low / Medium / High\n##     - Compliance: Acceptable? Yes/No\n##\n## Q2: Recommendation for TechCorp:\n##     - Recommended method: _______________\n##     - Why this method?\n##     - Implementation phased? Phase 1, Phase 2, Phase 3?\n##     - Total cost: $_____\n##     - Expected timeline: ___\n##     - Compliance violations addressed? Which ones?\n\n## PART 2: PASSWORD POLICIES\n## Q3: Design password policy:\n##     - Minimum length: ___ characters\n##     - Complexity requirements: (Uppercase? Numbers? Symbols?)\n##     - Password expiration: ___ days or Never?\n##     - Password history: Remember last ___ passwords (prevent reuse)\n##     - Account lockout: After ___ failed attempts\n##     - Lockout duration: ___ minutes\n##     - Brute force protection: How implemented?\n##\n##     Justification for each policy:\n##     - Length: _______________\n##     - Complexity: _______________\n##     - Expiration: _______________\n##     - History: _______________\n##     - Lockout: _______________\n\n## Q4: Scenario - Password compromise:\n##     - Employee Jane receives phishing email\n##     - Clicks link, enters credentials at fake login page\n##     - Attacker now has her password\n##     - Attacker logs in with her credentials\n##     - What happens? (Consider: MFA, session monitoring, access logs)\n##     - How to detect: _______________\n##     - How to respond: _______________\n\n## PART 3: MULTI-FACTOR AUTHENTICATION\n## Q5: MFA implementation strategy:\n##     - Users with MFA requirement: All? High-risk roles? Exemptions?\n##     - MFA for all access? Or specific scenarios? (Admin, after-hours, new device)\n##     - Backup authentication (if phone lost): What's acceptable?\n##     - Cost: $_____\n##     - User acceptance challenge: _______________\n##     - Onboarding process: How to help users adopt?\n##\n##     Risk analysis:\n##     - If MFA optional: Adoption rate? __%\n##     - If MFA mandatory: User complaints? Support burden?\n##     - Balance: Security vs usability\n\n## Q6: MFA scenario - Device loss:\n##     - Employee John sets up MFA with authenticator app on iPhone\n##     - iPhone stolen/lost\n##     - John cannot log in (phone required for MFA)\n##     - Procedure: _______________\n##     - Recovery time: _______________\n##     - Verification required: _______________\n##     - How to prevent recurrence: _______________\n\n## PART 4: ROLE-BASED ACCESS CONTROL (RBAC)\n## Q7: Design role structure:\n##     Define roles based on job functions:\n##     - Executives: _______________\n##     - Engineers (developer, SRE, security): _______________\n##     - IT Operations: _______________\n##     - Sales/Marketing: _______________\n##     - HR/Finance: _______________\n##     - Contractors: _______________\n##     - Support staff: _______________\n\n##     Example - Software Engineer role:\n##     - Can access: Dev environment, production logs (read-only)\n##     - Cannot access: Production databases (write), finance systems, HR records\n##     - MFA required: For production access only\n##     - Audit trail: Yes\n\n##     For each role above, specify:\n##     - Systems accessible (list)\n##     - Data accessible (list)\n##     - Actions allowed (read, write, delete, admin)\n##     - MFA required? Yes/No\n##     - Audit logging? Yes/No\n\n## Q8: RBAC violations detected:\n##     - Network engineer accessing HR/payroll system (no business reason)\n##     - Sales representative accessing customer's credit card details (PCI violation)\n##     - Contractor accessing source code repository (IP theft risk)\n##     - Executive with admin access to all systems (principle of least privilege)\n##\n##     For each violation:\n##     a) Why is this a violation?\n##     b) What access should they have instead?\n##     c) How to detect? (monitoring, audits, tools)\n##     d) How to remediate?\n\n## PART 5: IDENTITY AND ACCESS MANAGEMENT (IAM)\n## Q9: IAM system requirements:\n##     - Current state: Every system has separate login/password\n##     - Problem: Weak password reuse, no centralized audit\n##     - Solution: Central authentication (LDAP, Active Directory, or cloud IAM)\n##     - Implementation: _______________\n##\n##     Features needed:\n##     - Single sign-on (SSO): User logs in once → Access multiple systems?\n##     - User provisioning: Automatic creation of accounts? HR → IT system sync?\n##     - User deprovisioning: Automatic account disable on termination?\n##     - Password reset: Self-service or admin-managed?\n##     - MFA integration: MFA token from central system?\n##     - Audit logs: Central repository of all authentication events?\n##\n##     Cost: Setup $_____, Operations $_____/year\n##     Vendors: Microsoft AD, Okta, Auth0, Ping Identity (evaluate 2 options)\n\n## Q10: Deprovisioning scenario:\n##      - Employee Michael leaves company (resignation)\n##      - Monday: Michael's last day\n##      - Current process: _______________\n##      - Risks if not done properly: _______________\n##      - Timeline for account disable: Immediately? 24 hours? 30 days?\n##      - Verification: How to confirm all access removed?\n##      - Data preservation: Emails, documents transferred to manager?\n\n## PART 6: COMPLIANCE AND AUDIT\n## Q11: Audit log requirements:\n##      - What events to log: _______________\n##      - Log retention: ___ months / years\n##      - Log security: Tamper-proof? Encrypted? Off-site backup?\n##      - Access to logs: Who can view? Permission required?\n##      - Log review: Frequency? Automated analysis or manual?\n##      - PCI DSS requirement: Log retention ___\n##      - HIPAA requirement: Log retention ___\n##      - SOX requirement: Log retention ___\n##\n##      Compliance scenario:\n##      - SOX audit upcoming (financial systems compliance)\n##      - Auditor asks: \"Show access logs for financial system for past 6 months\"\n##      - You check: Logs exist? Tamper-proof? Retention meets SOX? Searchable?\n##      - Gaps: _______________\n##      - How to address: _______________\n\n## Q12: Privilege escalation detection:\n##      - Scenario: Database administrator (DBA) normally accesses dev databases\n##      - Unusual activity: DBA accessing production customer database (rare)\n##      - Detection: _______________\n##      - Investigation: _______________\n##      - Response: _______________\n##      - Prevention: _______________\n\n## PART 7: ATTACK SCENARIOS AND RESPONSE\n## Q13: Brute force attack:\n##      - Attacker targets employee login portal\n##      - Automated attempts: 1,000 login attempts in 5 minutes\n##      - Passwords guessed: 10 accounts compromised\n##      - Detection: _______________\n##      - Response: _______________\n##      - Prevention: _______________\n\n## Q14: Credential stuffing:\n##      - Attacker has list of username/password from another company's breach\n##      - Attempts to reuse credentials at TechCorp\n##      - Success: 50 accounts compromised (employees reused passwords)\n##      - Response to compromised accounts: _______________\n##      - Detection method: _______________\n##      - User notification: How and when?\n##\n##     Prevention measures:\n##     - Password reset for all users? Timeline?\n##     - Compromised credential monitoring? (e.g., Have I Been Pwned API)\n##     - Education: Tell users why password reuse is dangerous?\n\n## Q15: Insider threat:\n##      - Disgruntled employee plans to steal customer data\n##      - Escalates privileges (lateral movement within system)\n##      - Accesses customer database with admin privileges\n##      - Downloads 10,000 customer records\n##      - Detection timing: After download (could be days)\n##      - What went wrong: _______________\n##      - Detective controls: _______________\n##      - Preventive controls: _______________\n\n## PART 8: IMPLEMENTATION ROADMAP\n## Q16: Phased implementation plan:\n##      - Phase 1 (Months 1-3): _______________\n##        * Goals: _______________\n##        * Cost: $_____\n##        * Compliance impact: _______________\n##\n##      - Phase 2 (Months 4-6): _______________\n##        * Goals: _______________\n##        * Cost: $_____\n##        * Compliance impact: _______________\n##\n##      - Phase 3 (Months 7-12): _______________\n##        * Goals: _______________\n##        * Cost: $_____\n##        * Compliance impact: _______________\n##\n##      Total cost: $_____\n##      Timeline: ___\n##      Compliance violations resolved: _______________",
  "solution": "# AUTHENTICATION & AUTHORIZATION SOLUTION\n\n## PART 1: AUTHENTICATION METHOD COMPARISON\n\n### Method 1: Password Only\n- **Strengths**: Simple to implement, no additional hardware, low cost\n- **Weaknesses**: \n  - Weak passwords (easy to guess, crack)\n  - Phishing vulnerable (user enters password at fake site)\n  - Credential reuse (same password at multiple sites)\n  - No second factor (compromise = complete access)\n- **Cost**: $0 (if using existing systems)\n- **Implementation time**: Immediate\n- **User friction**: Low\n- **Compliance**: NO - HIPAA, PCI DSS, SOX all require MFA for sensitive systems\n\n### Method 2: Password + TOTP (Authenticator App)\n- **Strengths**:\n  - Two-factor authentication (what you know + what you have)\n  - Codes generated locally (no carrier dependency)\n  - Works offline\n  - Low cost\n  - High adoption (Google Authenticator, Authy widely used)\n- **Weaknesses**:\n  - If phone lost, backup authentication required\n  - Lost phone = difficult recovery\n  - Requires app installation/setup\n  - No recovery codes management\n- **Cost**: $5-10 per user for MFA setup/support\n- **Implementation time**: 4-6 weeks (user education, gradual rollout)\n- **User friction**: Medium (app setup, carrying phone)\n- **Compliance**: YES - Meets most requirements for standard compliance\n\n### Method 3: Password + SMS/Text OTP\n- **Strengths**:\n  - Two-factor authentication\n  - No app installation (uses SMS)\n  - Works on any phone\n  - Easy to use\n- **Weaknesses**:\n  - SMS vulnerable to SIM swapping (attacker takes over phone number)\n  - Carrier dependency (delay in SMS delivery)\n  - Not NIST recommended for high-security\n  - Cost per SMS (carrier charges)\n- **Cost**: $0.05-0.10 per SMS (~$1-2 per user per month)\n- **Implementation time**: 2-3 weeks\n- **User friction**: Low\n- **Compliance**: QUESTIONABLE - NIST deprecated SMS OTP, regulators moving away\n\n### Method 4: Password + Hardware Token\n- **Strengths**:\n  - Very secure (physical device cannot be compromised remotely)\n  - Works offline\n  - No phone dependency\n  - NIST highly recommends for high-security\n- **Weaknesses**:\n  - Token cost ($30-50 per user)\n  - Token management complexity (provisioning, replacement)\n  - Lost token = recovery process\n  - Higher user friction (must carry token)\n- **Cost**: $50 per user + infrastructure ($10K setup)\n- **Implementation time**: 8-10 weeks\n- **User friction**: High (device to carry)\n- **Compliance**: YES - Exceeds all requirements\n\n### Method 5: Biometric (Fingerprint + Password)\n- **Strengths**:\n  - Unique to individual (cannot be shared)\n  - Very secure (biological factor)\n  - Fast (scan is quick)\n  - User-friendly (natural to use)\n- **Weaknesses**:\n  - Requires compatible devices/hardware ($300+ per workstation)\n  - Accuracy varies (false positives, false negatives)\n  - Privacy concerns (fingerprint data collection)\n  - Regulatory constraints (GDPR, privacy laws)\n  - Not suitable for remote workers (requires specific hardware)\n- **Cost**: $300+ per device + infrastructure\n- **Implementation time**: 12+ weeks\n- **User friction**: Low (once enrolled)\n- **Compliance**: MAYBE - Depends on regulatory interpretation of biometric data\n\n### Recommendation for TechCorp: Password + TOTP (Authenticator App)\n\n**Why this method**:\n- Balances security (two-factor) with usability (app-based)\n- Cost-effective ($5-10 per user)\n- Industry standard (widely adopted, user familiar)\n- Fast implementation (4-6 weeks)\n- Meets compliance requirements (HIPAA, PCI DSS prefer TOTP over SMS)\n- Works for diverse workforce (office + remote workers)\n\n**Phased Implementation**:\n- **Phase 1** (Weeks 1-4): High-risk users (executives, engineers, admins)\n  - MFA mandatory for production access\n  - User education and training\n  - Cost: $15K (training, support)\n  \n- **Phase 2** (Weeks 5-8): All engineers and IT staff\n  - MFA mandatory across all systems\n  - Backup authentication procedures established\n  - Cost: $12K\n  \n- **Phase 3** (Weeks 9-12): All other users\n  - MFA optional initially, mandatory after 30 days\n  - Help desk ready for support\n  - Cost: $8K\n\n**Total cost**: $35K + $50K infrastructure = $85K\n**Timeline**: 12 weeks\n**Compliance violations addressed**: \n- HIPAA: Now requires MFA ✓\n- PCI DSS: MFA for sensitive access ✓\n- SOX: Audit logs enabled ✓\n\n## PART 2: PASSWORD POLICIES\n\n### Password Policy Design\n- **Minimum length**: 12 characters\n  - Rationale: 12+ characters provide 62^12 combinations (very resistant to brute force)\n  - NIST recommends 12-16 for security\n  - Industry standard (Microsoft, Google require 12+)\n\n- **Complexity requirements**: \n  - REQUIRED: Uppercase, lowercase, numbers\n  - OPTIONAL: Symbols (increases length requirement reduces need)\n  - Rationale: Increases entropy, prevents dictionary attacks\n  - Example: MyCompany2024 (12 chars, mixed case, numbers) acceptable\n\n- **Password expiration**: Never (or 365 days maximum)\n  - OLD THINKING: Expired every 90 days (caused weak passwords: Password123! → Password124!)\n  - NIST 2017 guidance: No expiration unless compromise detected\n  - TechCorp policy: NO regular expiration, but immediate change on compromise\n  - Rationale: Users with expiration create weaker passwords over time\n\n- **Password history**: Remember last 5 passwords\n  - Prevents: User changing to A, B, C, D, E then back to A\n  - Rationale: Users shouldn't be able to reuse recent passwords\n  - Duration: At least 6 months of history\n\n- **Account lockout**: After 5 failed attempts\n  - Rationale: Stops brute force after small number of guesses\n  - Too sensitive (3 attempts): User frustration (typos, caps lock)\n  - Not sensitive enough (10+ attempts): Easier for attacker\n\n- **Lockout duration**: 15 minutes\n  - Rationale: Delays attacker, allows user to regain access\n  - After 15 min, account unlocks automatically\n  - Alternative: Admin unlock required (higher friction but more secure)\n\n- **Brute force protection**: Rate limiting\n  - Implementation: After 3 failed attempts from same IP, delay responses\n  - First fail: Normal response time\n  - Second fail: 1 second delay\n  - Third fail: 5 second delay  \n  - Fourth fail: 15 second delay\n  - Fifth fail: Account locked\n  - Rationale: Slows attacker to 1 attempt per second (vs 1,000/second normally)\n\n### Password Compromise Scenario - Jane's Phishing\n\n**What happens**:\n1. Jane enters credentials at fake site → Attacker has password\n2. Attacker logs in with her credentials\n3. **MFA saves the day**: Login requires TOTP code from her phone\n4. Attacker has password but NOT phone → Login fails\n5. Jane's phone generates code only she can use\n6. Attacker cannot login despite having password\n\n**Detection** (even without MFA):\n- Failed login attempt from unusual location (IP geolocation)\n- Unusual time (outside working hours)\n- Multiple failed attempts (attacker trying code)\n- Session monitoring: Jane logged in from 2 locations simultaneously\n\n**Detection WITH MFA**:\n- MFA authentication alert to Jane's phone (\"Login attempt from city X\")\n- Jane can immediately see unauthorized attempt\n- Jane revokes other sessions\n- Immediate notification to security team\n\n**Response**:\n- Notify Jane: \"Unauthorized login attempt blocked by MFA\"\n- Ask Jane to change password\n- Monitor account for 30 days for suspicious activity\n- Review security briefing with Jane on phishing\n\n## PART 3: MULTI-FACTOR AUTHENTICATION\n\n### MFA Implementation Strategy\n- **Users with mandatory MFA**: All users with access to sensitive systems\n  - Executives: 30 users (all systems)\n  - Engineers: 100 users (production access)\n  - IT Operations: 20 users (admin access)\n  - Finance: 15 users (financial systems)\n  - HR: 10 users (personnel systems)\n  - **Total mandatory**: 175 users\n  - **Optional for**: Sales, support (50 users)\n\n- **MFA for all access, or specific scenarios**?: Tiered approach\n  - Tier 1 (Production/sensitive): MFA required\n  - Tier 2 (Development/general): MFA optional\n  - Tier 3 (Guest/public): No MFA\n\n- **Backup authentication if phone lost**:\n  - Recovery codes: 10 one-time recovery codes printed/stored securely\n  - Backup email: Secondary email address for account recovery\n  - Security questions: Account recovery verification\n  - Admin override: Help desk can reset with identity verification\n\n- **Cost**: $85K total (includes training, infrastructure, support)\n\n- **User acceptance challenge**: \n  - Resistance: \"This slows me down\"\n  - Mitigation: Demo that TOTP app is faster than password + security questions\n  - Resistance: \"I'll lose my phone\"\n  - Mitigation: Explain recovery procedures, backup codes\n\n- **Adoption strategy**:\n  - Pilot: Start with 30 executives (most motivated)\n  - Communicate benefits: Your account is protected\n  - Provide training: Walk-through setup in security video\n  - Offer support: Help desk available during rollout\n  - Make optional initially: Encourage without mandating\n  - Make mandatory: After 90 days grace period\n\n### MFA Device Loss Scenario - John's iPhone\n\n**Problem**: John's iPhone lost → Cannot generate MFA codes → Cannot login\n\n**Recovery procedure**:\n1. John contacts help desk\n2. Help desk verifies identity (security questions, employee info)\n3. Help desk temporarily disables MFA requirement\n4. John logs in with password only (temporary)\n5. John immediately re-enrolls MFA with new device\n6. Backup recovery codes provided\n\n**Recovery timeline**: 1-2 hours (within business day)\n\n**Verification required**:\n- Identity verification questions (security questions)\n- Confirm employment status with HR system\n- Confirm phone number change in system\n- Log all recovery actions for audit\n\n**Prevention**:\n- Educate users: Register backup authenticator app (on 2 devices or tablet)\n- Backup recovery codes: Printed, stored in safe place\n- Account recovery email: Enables password reset if phone lost\n- Encourage backup authentication method\n\n## PART 4: ROLE-BASED ACCESS CONTROL (RBAC)\n\n### Role Structure\n\n**1. Executive Role**\n- Systems accessible: Email, document management, reporting dashboards, financial systems, HR records\n- Data accessible: All company-level data, executive summaries\n- Actions: Read-heavy (reports), some approvals\n- MFA required: YES\n- Audit logging: YES (all actions logged)\n\n**2. Software Engineer Role**\n- Systems accessible: Git repositories, development servers, staging environments, monitoring dashboards\n- Data accessible: Source code, deployment logs, error tracking\n- Actions: Read+write (development), deploy to staging\n- MFA required: YES (for production access)\n- Audit logging: YES (especially production)\n\n**3. SRE/Infrastructure Role**\n- Systems accessible: Servers, databases, network devices, monitoring, deployment systems\n- Data accessible: System logs, configurations, performance metrics\n- Actions: Read+write+admin (infrastructure management)\n- MFA required: YES\n- Audit logging: YES (comprehensive)\n\n**4. Security Role**\n- Systems accessible: ALL systems (to monitor and audit)\n- Data accessible: Security logs, audit trails, threat intelligence\n- Actions: Read (usually), investigation capabilities\n- MFA required: YES\n- Audit logging: YES (logged who accessed what security data)\n\n**5. IT Operations Role**\n- Systems accessible: Help desk systems, user management, email infrastructure\n- Data accessible: User accounts, support tickets\n- Actions: User creation/deletion, password resets, support\n- MFA required: YES\n- Audit logging: YES (user changes logged)\n\n**6. Sales/Marketing Role**\n- Systems accessible: CRM system, marketing automation, email\n- Data accessible: Customer contacts, campaign data\n- Actions: Read+write (their own customer data)\n- MFA required: NO (no sensitive systems)\n- Audit logging: NO (not sensitive)\n\n**7. HR/Finance Role**\n- Systems accessible: HR system, payroll, financial records\n- Data accessible: Salary, employment records, financial reports\n- Actions: Read+write (HR duties)\n- MFA required: YES (sensitive data)\n- Audit logging: YES (compliance required)\n\n**8. Contractor Role**\n- Systems accessible: LIMITED - Only required project systems\n- Data accessible: Minimal - Only what needed for project\n- Actions: Read+write only for project deliverables\n- MFA required: YES (external user)\n- Audit logging: YES (external access)\n\n**9. Support Staff Role**\n- Systems accessible: Help desk system, limited admin for password resets\n- Data accessible: Support tickets, user information for resets\n- Actions: Read-mostly (tickets), limited write (notes)\n- MFA required: NO (low risk)\n- Audit logging: NO (not sensitive)\n\n### RBAC Violations Analysis\n\n**Violation 1: Network Engineer accessing HR/Payroll System**\n- a) **Why violation**: No business reason for network engineer to access HR data\n   - Violates principle of least privilege\n   - Could enable salary theft, fraud\n   - Separation of duties violated (IT should not access payroll)\n\n- b) **What access should they have**: Access to network devices only\n   - Routers, switches, firewalls\n   - Network monitoring systems\n   - Should NOT have HR system login\n\n- c) **How to detect**: \n   - Access control review: HR system audit shows unexpected engineer login\n   - Anomaly detection: Engineer's role shouldn't access HR\n   - User interviews: \"Why did you need HR system?\"\n\n- d) **How to remediate**:\n   - Immediately remove HR system access\n   - Investigate: What data was accessed? Downloads? Modifications?\n   - Audit log review: How long did this access exist?\n   - Disciplinary action: If intentional (fraud), termination; if mistake, retraining\n   - System improvement: Implement access control that PREVENTS this\n\n**Violation 2: Sales Rep accessing Customer Credit Card Details**\n- a) **Why violation**: \n   - PCI DSS violation (only payment processing staff should access CC data)\n   - Privacy violation (customer data misuse)\n   - Fraud risk (identity theft using CC numbers)\n   - Regulatory fines: $5K-10K per card exposed\n\n- b) **What access should they have**: \n   - CRM system with customer names, contact info\n   - NOT stored credit card numbers\n   - System should MASK CC data (only show last 4 digits)\n\n- c) **How to detect**:\n   - Credit card data access logs show unusual pattern\n   - Sales role shouldn't access CC database directly\n   - Anomaly: Large number of records accessed at once\n   - External alert: Credit card processor sees suspicious pattern\n\n- d) **How to remediate**:\n   - IMMEDIATE: Remove CRM access\n   - Forensics: What CC data was exposed? Was it downloaded? Shared?\n   - Breach notification: May need to notify affected customers\n   - PCI DSS impact: Report to compliance/auditors\n   - Disciplinary: Severe (fraud implications) → termination likely\n   - System fix: Implement field-level access control (mask CC from certain roles)\n\n**Violation 3: Contractor accessing Source Code Repository**\n- a) **Why violation**:\n   - IP theft risk (source code is proprietary)\n   - Security risk (contractor might expose vulnerabilities)\n   - NDA/contract violation\n   - Compliance: If contractor not properly vetted\n\n- b) **What access should they have**:\n   - Only project-specific code/files needed\n   - Access limited by expiration date (project end)\n   - Code review, NOT full repository download\n\n- c) **How to detect**:\n   - Repository access logs show contractor account\n   - Download history: Large code downloads = suspicious\n   - Code repository activity: Clones vs views (clones are riskier)\n   - Audit: Contractor should not normally access repo\n\n- d) **How to remediate**:\n   - Immediate: Disable contractor access\n   - Investigation: What code was accessed? Downloaded? Shared?\n   - Legal: Review contract, NDA, possible breach\n   - Communication: Notify contractor, management, legal\n   - System fix: \n     - Contractor repository (separate from main source code)\n     - Code review process (contractors get vetted code, not full repo)\n     - Expiration: Contractor access auto-expires at project end\n\n**Violation 4: Executive with Admin Access to All Systems**\n- a) **Why violation**:\n   - Principle of least privilege: Should only have access needed for role\n   - Disaster if account compromised (attacker gets all systems)\n   - Compliance: Audit would flag this\n   - Separation of duties: Executive shouldn't admin technical systems\n\n- b) **What access should they have**:\n   - Executive dashboards and reports\n   - Email and collaboration tools\n   - NOT system admin access\n   - NOT network device access\n   - NOT database credentials\n\n- c) **How to detect**:\n   - Access review: Executive role has too many permissions\n   - Unusual activity: Executive logging into servers directly (not normal)\n   - Comparison: Other executives don't have admin rights\n\n- d) **How to remediate**:\n   - Remove admin access immediately\n   - Question: Why was admin access granted? (Mistake? Old setup?)\n   - Audit: What did executive access with admin rights?\n   - Implement role: Executive role template (predefined limited access)\n   - If admin access needed: Create separate admin account for specific tasks\n   - Training: Explain principle of least privilege\n\n## PART 5: IDENTITY AND ACCESS MANAGEMENT (IAM)\n\n### IAM System Requirements\n\n**Current problem**: Every system separate login → Weak password reuse, no central audit\n\n**Solution**: Deploy central IAM system\n\n**Single Sign-On (SSO)**:\n- YES - User logs in once → Access multiple systems\n- Process: User authenticates to IAM → Receives token → Token used for all systems\n- Benefits: Better password security (users type password less), faster access\n- Downside: If IAM compromised, all systems at risk (why IAM security is critical)\n\n**User Provisioning** (Automatic creation):\n- YES - HR system notifies IAM → Account automatically created\n- Process: New hire entered in HR system → IAM receives notification → Email, network, phone provisioned automatically\n- Benefits: Faster onboarding, no manual errors, consistent initial setup\n- Implementation: HR system + IAM integration\n\n**User Deprovisioning** (Automatic disable on termination):\n- YES - HR system marks termination → IAM automatically disables accounts\n- Process: Employee marked terminated in HR → IAM receives notification → All accounts disabled within 1 hour\n- Benefits: No lingering access for former employees, compliance\n- Manual verification: Manager confirms all access removed\n\n**Password Reset** (Self-service):\n- YES - Users reset own passwords via IAM portal\n- Process: Forgot password → Verify identity (security questions) → Reset password\n- Benefits: Reduces help desk tickets, faster for users, any time 24/7\n- Admin-managed: For special cases (locked accounts) or help desk escalation\n\n**MFA Integration**:\n- YES - MFA token from central IAM\n- Single authenticator app for ALL systems\n- Provisioning: IAM generates TOTP secret → User enrolls in authenticator app\n- Verification: All systems accept token from same IAM\n\n**Audit Logs** (Central repository):\n- YES - All authentication events logged to central SIEM\n- Events logged: Login success/fail, password change, MFA enrollment, permission changes\n- Retention: 7 years (compliance requirement)\n- Searchable: Query by user, system, time range, event type\n\n**Recommended Vendors**: Okta vs Azure AD\n- **Okta**: Best for diverse environment, multi-cloud, excellent UX\n  - Cost: $100 per user per year\n  - Setup: 8-12 weeks\n  - Support: Excellent\n  \n- **Azure AD**: Best if already using Microsoft ecosystem\n  - Cost: $2-4 per user per month (with Microsoft 365 license)\n  - Setup: 6-8 weeks\n  - Support: Included with Microsoft support\n\n**TechCorp recommendation**: Okta (multi-cloud environment, SaaS vendors)\n- **Cost**: \n  - Setup: $50K (implementation, integration)\n  - Operations: 500 users × $100 = $50K per year\n  - Support: $10K per year\n  - Total Year 1: $110K, Year 2+: $60K/year\n\n### Deprovisioning Scenario - Michael's Departure\n\n**Michael's last day: Monday**\n\n**Current process** (without IAM):\n- HR notifies IT Manager (email)\n- IT Manager manually:\n  - Disables accounts in 5 systems (email, network, HR system, CRM, support system)\n  - Collects badge (physical)\n  - Transfers emails to manager\n  - Transfer documents/projects\n  - Takes laptop\n- **Problem**: Takes 3-5 days, inconsistent, some access missed\n\n**Improved process** (with IAM + procedures):\n- **Day 1 (Before Michael leaves)**:\n  - HR enters termination in system\n  - Manager notified to backup Michael's documents\n  - IAM automatically disables all system access (within 1 hour)\n  - Email forwarding to manager activated\n  - VPN/remote access disabled\n  - Badge reader updated (badge no longer works)\n\n- **Timeline for disable**: Immediately (within 1 hour of HR entry)\n  - Cannot delay (access breach risk)\n  - No grace period for departing employee\n  - Except: Email access (may be needed for transition, 7 days)\n\n- **Verification**: \n  - IT Manager tests: Try to login with Michael's credentials → Fails ✓\n  - IAM audit report: All access disabled\n  - Badge reader: Swiping card shows \"Access Denied\"\n  - Manager verification: Email forwarding working\n  - Document transfer: Completed\n\n- **Risks if not done properly**:\n  - Michael maintains access → Data theft risk\n  - Account used by others (password shared)\n  - Compliance violation: Uncontrolled access\n  - Regulatory fine: Failed access control\n  - Data breach: Former employee with grudge accesses systems\n\n- **Data preservation**:\n  - Email: Forwarded to manager (7-30 days)\n  - Documents: Manager copies to shared drive\n  - Projects: Reassigned to team members\n  - Audit access: Manager, IT can access for compliance\n  - Retention: 7 years for compliance\n\n## PART 6: COMPLIANCE AND AUDIT\n\n### Audit Log Requirements\n\n**What events to log**:\n- Successful authentication (user login)\n- Failed authentication attempts (failed logins)\n- Permission changes (role assignments, access grants/revocations)\n- Privileged actions (admin functions, password resets)\n- Password changes\n- MFA enrollment/changes\n- System access (which systems, when)\n- Sensitive data access (customer records, financial data)\n- Configuration changes (policy updates)\n\n**Log retention**:\n- PCI DSS: 1 year (minimum), recommend 3 months online\n- HIPAA: 6 years minimum\n- SOX: 7 years (financial/audit logs)\n- GDPR: 3 years minimum (user activity)\n- TechCorp should use: 7 years (SOX requirement)\n\n**Log security** (Tamper-proof):\n- Write-once storage: Once written, cannot be modified/deleted\n- Encrypted: AES-256 encryption\n- Off-site backup: Replicated to secondary location\n- Immutable format: Cryptographic signing prevents tampering\n- Separate storage: Logs not on same system as applications (attacker cannot delete after intrusion)\n\n**Access to logs** (Who can view):\n- Security team: View all logs (monitoring, investigation)\n- Compliance team: View logs for regulatory reporting\n- IT management: Limited view (their own systems)\n- Auditors: Limited view (only required for audit)\n- Restrictions: Users cannot view their own logs (prevents cover-up)\n\n**Log review frequency**:\n- Automated analysis: Real-time alerting for suspicious patterns\n  - Multiple failed logins\n  - Access outside business hours\n  - Permission escalation attempts\n  - Sensitive data access\n- Manual review: Weekly by security team\n  - Correlation analysis (connecting related events)\n  - Anomaly investigation\n  - Trending\n\n**Compliance requirements**:\n- **PCI DSS**: Log retention 1 year, 3 months online\n- **HIPAA**: Log retention 6 years, audit trail required\n- **SOX**: Log retention 7 years, immutable audit trail\n\n### SOX Audit Scenario\n\n**Auditor request**: \"Show access logs for financial system for past 6 months\"\n\n**Gaps to check**:\n- Are logs retained for 6 months? YES ✓\n- Logs in tamper-proof format? YES (immutable) ✓\n- Complete audit trail? Check for:\n  - All logins recorded? YES\n  - All sensitive access recorded? YES\n  - Permission changes recorded? YES\n  - All fields captured (user, time, system, action)? YES\n- Searchable/accessible? YES (can query by system/timeframe)\n- No gaps in logging? Verify:\n  - No periods where logging was disabled\n  - No deleted/purged log entries\n  - Consistent logging across 6 months\n\n**Gaps to address** (if any):\n- If logging disabled: Document why and when\n- If gaps found: Implement fix (why logging failed)\n- If not immutable: Migrate to immutable storage\n- If not retained long enough: Extend retention policy\n\n**How to address**:\n- Implement centralized SIEM with immutable storage\n- Automate log collection from all systems\n- Policy: Logging cannot be disabled (force at infrastructure level)\n- Regular retention verification (quarterly audit)\n- Training: Systems team on log importance\n\n### Privilege Escalation Detection\n\n**Scenario**: DBA normally accesses dev databases, but access production customer database (unusual)\n\n**Detection methods**:\n1. **Anomaly detection**: Machine learning flags unusual patterns\n   - DBA accessing production (first time)\n   - DBA accessing customer data (role doesn't normally need)\n   - Time: 3am (outside normal 9-5 hours)\n   - Volume: 10,000 rows accessed (much larger than normal)\n\n2. **Rule-based alerts**:\n   - Production database access by dev-focused role = alert\n   - After-hours access by non-security role = alert\n   - Large data export (>1,000 rows) = alert\n\n3. **Access review audit**:\n   - Monthly: Compare actual access vs expected access\n   - DBA should only access:\n     - Dev databases (maintenance)\n     - Staging databases (testing)\n     - Should NOT access: Customer data, production\n\n**Investigation**:\n- Interview DBA: \"Why did you access production database?\"\n- Check request/ticket: Was access requested? Approved?\n- Review logs: What exactly was accessed? Copied? Downloaded?\n- Check MFA logs: Was MFA used? (If not, account may be compromised)\n- Timeline: First access or pattern over time?\n\n**Response**:\n- If legitimate: Document reason, approve retrospectively\n- If unauthorized: Revoke access, investigate further\n  - Check if account compromised\n  - Review other recent activity\n  - Password reset required\n  - MFA check (make sure MFA device wasn't stolen)\n- If malicious: Disciplinary action, possible termination\n\n**Prevention**:\n- Access control: DBA role cannot access customer data database (system enforces)\n- Separation of duties: Different teams for dev vs production\n- Monitoring: Continuous detection of anomalies\n- Alerting: Real-time notification of unusual access\n- Approval process: Access requests require multi-level approval\n\n## PART 7: ATTACK SCENARIOS AND RESPONSE\n\n### Brute Force Attack\n\n**Attack**: 1,000 login attempts in 5 minutes, 10 accounts compromised\n\n**Detection**:\n- Rate limiting threshold: 5 attempts per minute from single IP\n- Alert triggered: IP 203.45.67.89 made 1,000 attempts in 5 minutes\n- Failed attempts logged: All 1,000 attempts recorded with timestamp, username\n- Security team alerted: SIEM sends SMS alert to security on-call\n\n**Response**:\n- **Immediate (within 30 minutes)**:\n  - Block source IP 203.45.67.89 at firewall (prevent further attempts)\n  - Reset passwords for 10 compromised accounts\n  - Enable MFA on those accounts\n  - Notify affected users via phone (SMS unreliable due to potential compromise)\n\n- **Investigation (within 2 hours)**:\n  - Review 10 compromised accounts for unauthorized activity\n  - Check: What systems did compromised accounts access?\n  - Timeline: When were accounts accessed? What actions taken?\n  - Log preservation: Retain all logs for forensics\n\n- **Communication (within 4 hours)**:\n  - Notify users: Password reset required, re-enroll MFA\n  - Status update to management\n  - Update incident ticket\n\n**Prevention**:\n- Rate limiting: Already implemented (detected attack)\n- Brute force protection: Account lockout after 5 failed attempts\n- MFA: Even with compromised password, MFA blocks access\n- Monitoring: Continuous detection of suspicious patterns\n- Education: Train users on password strength\n\n### Credential Stuffing\n\n**Attack**: Attacker has credentials from another company, tries at TechCorp, 50 accounts compromised\n\n**Root cause**: Users reused passwords (MyPassword123 used at Facebook, LinkedIn, AND TechCorp)\n\n**Detection**:\n- Rapid login from multiple IPs with different accounts\n- Credentials match another company's leaked database (can purchase leaked credential lists)\n- Detection: Check against Have I Been Pwned API automatically\n- Or: Monitor for multiple failed + successful logins in short time\n\n**Response to compromised accounts**:\n- **Immediate**:\n  - Force password reset for all 50 users\n  - Block accounts until password reset completed\n  - Send urgent notification (email + SMS) to affected users\n  - Timeline: User must reset password within 1 hour or account locked\n\n- **Investigation**:\n  - Review 50 accounts: What systems accessed? What actions taken?\n  - Check for credential stuffing pattern: Same password at multiple companies?\n  - Timeline: How long were accounts compromised?\n  - Data: Was sensitive data accessed or exported?\n\n- **Communication**:\n  - Email: Explain breach, how detected, what action taken\n  - Ask users: \"Did you use this password at other websites?\"\n  - Advise: Use password manager (unique password per site)\n  - Include: How to check if your password was in a breach (haveibeenpwned.com)\n\n**Detection method**:\n- Subscribe to breach notification service (Have I Been Pwned API)\n- Automatically check: When new breach published, does it contain TechCorp emails?\n- Alert: If matches found, proactively reset those accounts\n- Cost: $200/month for API access\n\n**User notification**:\n- Email: From security team (not impersonated account)\n- Contents:\n  - What happened: Your password was leaked at other company\n  - When detected: Within 1 day of breach publication\n  - Action taken: Your account password reset, MFA required\n  - What to do: Change passwords everywhere, enable 2FA at other sites\n  - Contact: Security team if questions\n- Timing: Immediately upon detection\n\n**Prevention measures**:\n- **Password reset for all users**: 1 week timeline\n  - Mandatory change for high-risk users (financial, admin)\n  - Recommended for others\n  - Rationale: Prevent compromised passwords from being used\n  - Cost: Help desk support burden during reset\n\n- **Compromised credential monitoring**:\n  - Implement: Have I Been Pwned API integration\n  - Frequency: Daily check for new breaches\n  - Alert: Immediate notification if TechCorp users found\n  - Timeline: Password reset within 24 hours\n\n- **Education**:\n  - Train users: Why password reuse is dangerous\n  - Recommend: Password manager (LastPass, Bitwarden, 1Password)\n  - Demo: Show how breaches expose millions of passwords\n  - Messaging: \"Use unique password at every site. Use password manager to remember them.\"\n\n### Insider Threat\n\n**Threat**: Disgruntled employee plans to steal customer data, escalates privileges, downloads 10,000 records\n\n**Detection**: DELAYED (could be days after download)\n\n**What went wrong** (Preventive failures):\n- No MFA: Employee used only password (easier to steal/crack)\n- No access restrictions: Employee could access customer database (should be limited)\n- No monitoring: Large export not flagged as suspicious\n- No privilege restrictions: Employee escalated own privileges (should require approval)\n- No segmentation: All customer data in one database (should be split by access need)\n\n**Detective controls** (catch after fact):\n- Access logs: Show employee logged in at unusual time (3am) from unusual location\n- Data export logs: Show 10,000 rows exported to CSV (suspicious volume)\n- Network monitoring: Show large file transfer to external USB or email\n- File integrity: Downloaded files have different hash (copied data)\n- User behavior analysis: Departure signals (updating LinkedIn, job searching)\n\n**Preventive controls** (prevent in first place):\n- Access control: Restrict customer database access to specific roles\n- Principle of least privilege: Employee only sees data needed for job\n- Privilege escalation policy: Cannot elevate own access (manager approval required)\n- DLP (Data Loss Prevention): Block large downloads to USB, email\n- Monitoring: Alert on:\n  - Large data exports (>1,000 rows)\n  - Access outside business hours\n  - Access from unusual locations\n  - Account privilege changes\n- Segmentation: Customer data split by region/type\n  - Employee accessing all data = anomaly\n  - Gradual increases in access = approved and monitored\n\n**Response**:\n- **Immediate**:\n  - Disable employee's account\n  - Retrieve company laptop/badge\n  - Preserve all evidence (logs, devices)\n  - Legal involvement (potential criminal case)\n\n- **Forensics**:\n  - Where was data sent? (USB? Email? Cloud storage?)\n  - Who has data? (Competitor? Criminal organization?)\n  - When did download occur? (Hours ago or days?)\n  - Other employees involved?\n  - Customer notification: Must inform customers of data breach\n\n- **Regulatory response**:\n  - Breach notification law requires notification within 30-60 days\n  - Regulatory reporting: Must report to data protection authority\n  - Fines: Up to 4% of global revenue (GDPR) or $100+ per record (state law)\n  - Civil liability: Customers sue for damages\n\n## PART 8: IMPLEMENTATION ROADMAP\n\n### Phase 1: Foundation (Months 1-3) - Cost: $40K\n**Goals**:\n- Emergency password policy\n- Multi-factor authentication pilot (high-risk users)\n- Audit logging enabled\n\n**Activities**:\n- Week 1-2: Update password policy\n  - Minimum 12 characters\n  - Complexity requirements\n  - Account lockout (5 attempts → 15 min lock)\n- Week 3-4: Deploy MFA for executives + engineers (100 users)\n  - TOTP-based authenticator app\n  - Training and support\n  - Recovery procedures\n- Week 5-6: Enable centralized audit logging\n  - SIEM deployment\n  - Log collection from key systems\n  - Alert rules for suspicious activity\n- Week 7-8: Compliance mapping\n  - Document what compliance requires\n  - Assess gaps\n  - Plan remediation\n- Week 9-12: Monitoring and tuning\n  - Security team learns SIEM\n  - Alert tuning (reduce false positives)\n  - Regular log review\n\n**Cost**:\n- SIEM license: $15K\n- MFA infrastructure: $10K\n- Training and support: $8K\n- Implementation: $7K\n- **Total Phase 1**: $40K\n\n**Compliance impact**:\n- Password policy addresses basic PCI DSS requirement ✓\n- MFA adds second factor (HIPAA requirement) ✓\n- Audit logging enables SOX compliance ✓\n- Remaining gaps: Access control, IAM integration\n\n### Phase 2: Access Control (Months 4-6) - Cost: $45K\n**Goals**:\n- Role-based access control design and implementation\n- User access review and remediation\n- MFA rollout to all users\n\n**Activities**:\n- Week 1-4: RBAC design\n  - Define 9 roles (executive, engineer, operations, etc)\n  - Map roles to systems and permissions\n  - Create role policies in IAM\n- Week 5-8: Access review and remediation\n  - Audit current access: Who has access to what?\n  - Identify violations\n  - Remove over-permissioned access\n  - Estimated: 50-100 access removals\n- Week 9-12: MFA completion\n  - All remaining 400 users enrolled\n  - MFA mandatory for all access\n  - Recovery procedures tested\n\n**Cost**:\n- Access review tools: $8K\n- RBAC implementation: $15K\n- MFA expansion: $12K\n- Consulting/implementation: $10K\n- **Total Phase 2**: $45K\n\n**Compliance impact**:\n- RBAC enforces separation of duties (SOX requirement) ✓\n- MFA for all access (HIPAA requirement) ✓\n- Access review addresses PCI DSS audit requirement ✓\n- Remaining gap: Centralized IAM system\n\n### Phase 3: IAM Integration (Months 7-12) - Cost: $110K\n**Goals**:\n- Deploy centralized IAM system (Okta)\n- Single sign-on for all systems\n- Automated user provisioning and deprovisioning\n- Advanced threat detection\n\n**Activities**:\n- Week 1-6: IAM platform selection and setup\n  - Evaluate vendors (Okta, Azure AD, Ping)\n  - Choose: Okta (best for multi-cloud)\n  - Infrastructure setup\n  - Integration planning\n- Week 7-14: System integration\n  - Connect email system\n  - Connect cloud applications\n  - Connect on-premises systems\n  - Test single sign-on\n- Week 15-20: User migration\n  - Batch user import from HR system\n  - MFA re-enrollment (transfer to IAM)\n  - Application testing\n  - Pilot group (50 users)\n- Week 21-26: Full rollout\n  - Migrate all 500 users\n  - Decommission old auth systems\n  - Monitor for issues\n  - Fine-tune policies\n\n**Cost**:\n- Okta setup: $50K\n- Implementation and integration: $35K\n- Training and support: $15K\n- First year licenses (500 users): $50K (but first year prorated)\n- **Total Phase 3 setup**: $110K\n- **Ongoing annual**: $60K (licenses + support)\n\n**Compliance impact**:\n- Centralized audit trail (PCI DSS ✓, SOX ✓, HIPAA ✓)\n- User provisioning/deprovisioning automation (SOX ✓)\n- MFA at central point (all regulations ✓)\n- Advanced analytics and threat detection ✓\n- **All compliance requirements addressed** ✓\n\n### Full Roadmap Summary\n**Total investment**:\n- Phase 1: $40K\n- Phase 2: $45K\n- Phase 3: $110K\n- **Total 12 months**: $195K\n- **Year 2+**: $60K/year (IAM operations + licenses)\n\n**Compliance violations resolved**:\n- PCI DSS: All password and access control requirements ✓\n- HIPAA: MFA and audit trail requirements ✓\n- SOX: Access control, separation of duties, audit trail ✓\n- Overall compliance: From FAILING to COMPLIANT in 12 months\n\n**Timeline**: 12 months (phased, no disruption to business)\n\n**ROI**: \n- Avoided breach cost: $5-10M+\n- Avoided regulatory fines: $1-2M+\n- Investment: $195K\n- **ROI: 2500%+ (first incident prevented pays for entire program)**",
  "hints": [
    "Multi-factor authentication requires 'something you know' (password) + 'something you have' (phone/token) or 'something you are' (biometric)",
    "Password policies should minimize friction while maximizing security - password expiration actually weakens security",
    "Role-based access control is most efficient for large organizations - define roles once, assign users to roles",
    "Single point of failure in IAM is critical - if compromised, all systems at risk - extra security on IAM itself",
    "Principle of least privilege: Each user should only access what they need for their job, nothing more",
    "Audit logs are legally required for most compliance standards - must be immutable and retained for years",
    "MFA is most effective when mandatory - optional adoption is too low to be effective",
    "Credential stuffing succeeds when users reuse passwords - password managers solve this problem",
    "Access review (quarterly) catches violations quickly - catch and remediate before damage done",
    "Compliance requirements are interrelated - fix one often helps with multiple regulations"
  ],
  "testCases": [
    {
      "id": "tc1-mfa",
      "description": "Multi-factor authentication design",
      "input": "Authentication methods",
      "expected": "Multiple authentication factors described (something you know, have, are)",
      "assert": "assert ('factor' in solution.lower() or 'mfa' in solution.lower() or 'password' in solution.lower()) and ('totp' in solution.lower() or 'token' in solution.lower() or 'biometric' in solution.lower() or 'sms' in solution.lower())"
    },
    {
      "id": "tc2-rbac",
      "description": "Role-based access control",
      "input": "Access control design",
      "expected": "Roles defined with specific permissions for each role",
      "assert": "assert 'role' in solution.lower() and ('executive' in solution.lower() or 'engineer' in solution.lower() or 'access' in solution.lower())"
    },
    {
      "id": "tc3-compliance",
      "description": "Compliance requirements mapping",
      "input": "Regulatory requirements",
      "expected": "Compliance standards addressed (PCI DSS, HIPAA, SOX, GDPR)",
      "assert": "assert ('pci' in solution.lower() or 'hipaa' in solution.lower() or 'sox' in solution.lower() or 'gdpr' in solution.lower())"
    },
    {
      "id": "tc4-audit-logs",
      "description": "Audit logging implementation",
      "input": "Logging and monitoring",
      "expected": "Audit trail requirements and retention policy defined",
      "assert": "assert ('audit' in solution.lower() or 'log' in solution.lower()) and ('retention' in solution.lower() or 'years' in solution.lower())"
    },
    {
      "id": "tc5-password",
      "description": "Password policy design",
      "input": "Password requirements",
      "expected": "Length, complexity, and account lockout policies defined",
      "assert": "assert 'password' in solution.lower() and ('length' in solution.lower() or 'complexity' in solution.lower() or 'lockout' in solution.lower())"
    },
    {
      "id": "tc6-principle-least-privilege",
      "description": "Principle of least privilege applied",
      "input": "Access control principle",
      "expected": "Each user has only necessary access, violations identified and remediated",
      "assert": "assert ('least' in solution.lower() or 'principle' in solution.lower() or 'privilege' in solution.lower()) and ('access' in solution.lower() or 'permission' in solution.lower())"
    },
    {
      "id": "tc7-sso",
      "description": "Single sign-on implementation",
      "input": "Centralized authentication",
      "expected": "SSO, user provisioning, and centralized identity management",
      "assert": "assert ('sso' in solution.lower() or 'sign-on' in solution.lower() or 'single' in solution.lower()) or ('iam' in solution.lower() or 'okta' in solution.lower() or 'active directory' in solution.lower())"
    },
    {
      "id": "tc8-threat-response",
      "description": "Attack detection and response",
      "input": "Security incident handling",
      "expected": "Detection methods and response procedures for attacks",
      "assert": "assert ('detect' in solution.lower() or 'response' in solution.lower() or 'attack' in solution.lower()) and ('brute' in solution.lower() or 'phishing' in solution.lower() or 'compromise' in solution.lower())"
    },
    {
      "id": "tc9-deprovisioning",
      "description": "User account deprovisioning",
      "input": "Access removal process",
      "expected": "Procedure for disabling access when employee departs",
      "assert": "assert ('deprovisioning' in solution.lower() or 'termination' in solution.lower() or 'disable' in solution.lower()) and ('access' in solution.lower() or 'account' in solution.lower())"
    },
    {
      "id": "tc10-iam",
      "description": "Identity and Access Management",
      "input": "Centralized identity system",
      "expected": "IAM system selection, features, and implementation plan",
      "assert": "assert ('iam' in solution.lower() or 'directory' in solution.lower()) and ('provision' in solution.lower() or 'centralized' in solution.lower() or 'sso' in solution.lower())"
    }
  ]
}
