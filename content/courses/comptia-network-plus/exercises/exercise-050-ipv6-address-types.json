{
  "id": "exercise-050-ipv6-address-types",
  "lessonId": "lesson-050-ipv6-address-types",
  "title": "IPv6 Address Types and Scopes - Advanced Addressing",
  "description": "Master IPv6 address type classification, multicast scopes, hierarchical address planning, and practical network design using global, unique local, and link-local addressing.",
  "difficulty": "advanced",
  "points": 100,
  "language": "text",
  "starterCode": "# IPv6 ADDRESS TYPES AND SCOPES EXERCISE\n# Advanced addressing for complex networks\n\n## SCENARIO: MedicalNet Healthcare Corporation\n## Multiple hospitals, research centers, clinics\n## Requirements: HIPAA compliance, secure segmentation\n## Design IPv6 addressing for geographically distributed network\n\n## PART 1: IPv6 ADDRESS TYPE CLASSIFICATION\n## Q1: Address type hierarchy\n##     IPv6 addresses categorized by:\n##     1. Type (unicast/multicast/anycast)\n##     2. Scope (device/link/site/organization/global)\n##     \n##     Unicast: _______ communication\n##     - One sender → one receiver ✓\n##     - Example: 2001:db8::1 → device\n##     \n##     Multicast: _______ communication\n##     - One sender → multiple receivers ✓\n##     - Example: ff02::1 → all nodes on link\n##     \n##     Anycast: _______ communication\n##     - One sender → nearest receiver ✓\n##     - Example: Multiple DNS servers with same address\n##     \n##     Broadcast: _______ (doesn't exist in IPv6)\n##     - Replaced by: _______\n\n## Q2: No broadcast in IPv6\n##     IPv4 broadcast problems:\n##     - 255.255.255.255 (limited broadcast)\n##     - 192.168.1.255 (directed broadcast)\n##     - Reaches EVERY device: _______\n##     - Causes: Unnecessary processing, _______ storms\n##     \n##     IPv6 solution - use multicast instead:\n##     - ff02::1 (all nodes on local link)\n##     - ff02::2 (all routers on local link)\n##     - ff02::1:ff__:____ (solicited-node multicast)\n##     \n##     Benefits: _______, _______, _______\n\n## PART 2: UNICAST ADDRESSES\n## Q3: Global Unicast Address (GUA) structure\n##     Standard GUA: 2001:db8:1234:5678:abcd:ef01:2345:6789/64\n##     \n##     Breakdown:\n##     | 48 bits | 16 bits | 64 bits |\n##     |---------|---------|----------|\n##     | Global  | Subnet  | Interface|\n##     | Prefix  | ID      | ID       |\n##     \n##     Global Prefix allocation:\n##     - IANA → RIRs: /_______ blocks\n##     - RIR → ISP: /_______ to /32 blocks\n##     - ISP → Customer: Typically /_______ (1000+ subnets)\n##     - Customer creates: /_______ subnets (65,536 addresses each)\n\n## Q4: GUA hierarchical allocation\n##     MedicalNet receives: 2001:db8:1234::/48 from ISP\n##     \n##     Allocate to hospitals:\n##     Hospital-A: 2001:db8:1234:1::/64\n##     Hospital-B: 2001:db8:1234:2::/64\n##     Hospital-C: 2001:db8:1234:3::/64\n##     ...\n##     Research Center: 2001:db8:1234:100::/64\n##     Corporate HQ: 2001:db8:1234:200::/64\n##     \n##     Each hospital can have:\n##     - ICU: 2001:db8:1234:1::/64 (first)\n##     - Emergency: 2001:db8:1234:2::/64\n##     - Surgery: 2001:db8:1234:3::/64\n##     - Admin: 2001:db8:1234:4::/64\n##     - Patient Records: 2001:db8:1234:5::/64\n##     \n##     Why /48 from ISP? _______ subnets available\n##     Why /64 per subnet? _______ addresses per subnet\n\n## Q5: Unique Local Address (ULA) implementation\n##     ULA prefix: fc00::/7 or fd00::/8\n##     \n##     Format: fd12:3456:789a:0001:abcd:ef01:2345:6789\n##     \n##     MedicalNet internal network:\n##     - Backup data center (private): fd2a:4c8e:abcd::/48\n##     - Research network (internal): fd2a:4c8e:cdef::/48\n##     - Guest WiFi (isolated): fd2a:4c8e:0001::/48\n##     \n##     Advantages:\n##     - No registration needed: _______\n##     - Not routable on internet: _______ (privacy)\n##     - Can be combined with: _______ (dual-stack)\n##     - Stable across ISP changes: _______ (no renumbering)\n\n## Q6: Link-Local addresses\n##     Prefix: fe80::/10\n##     \n##     Automatic generation (EUI-64):\n##     MAC address: 00:1a:2b:3c:4d:5e\n##     Process:\n##     1. Split MAC: 00:1a:2b | 3c:4d:5e\n##     2. Insert ffff: 00:1a:2b:ff:fe:3c:4d:5e\n##     3. Flip 7th bit: _______ \n##     4. Result: fe80::021a:2bff:fe3c:4d5e\n##     \n##     Usage in MedicalNet:\n##     - Router discovery: _______\n##     - Default gateway learning: _______\n##     - Neighbor discovery: _______\n##     - Initial bootstrap: _______\n##     \n##     Important: Link-local NOT routed beyond: _______\n\n## Q7: Address configuration process\n##     Device boots on network:\n##     Step 1: Link-local auto-generated\n##     - Address: fe80::021a:2bff:fe3c:4d5e ✓\n##     - Performs DAD (Duplicate Address Detection)\n##     - Can communicate locally now\n##     \n##     Step 2: Listen for Router Advertisement\n##     - Router sends RA with global prefix\n##     - Example: 2001:db8:1234:5::/64\n##     \n##     Step 3: Combine prefix + local part\n##     - Address: 2001:db8:1234:5:021a:2bff:fe3c:4d5e/64\n##     - Can communicate globally now ✓\n##     \n##     This process: _______\n##     No DHCP needed: _______\n\n## PART 3: MULTICAST ADDRESSES\n## Q8: Multicast address format\n##     Prefix: ff__:____:____:____:____:____:____:____\n##     First octet: FF00 (always ff)\n##     Next octet: Flags + Scope\n##     \n##     Binary breakdown of second octet:\n##     - Bit 0: Flags/Reserved\n##     - Bits 1-4: Reserved/Flags\n##     - Bits 5-7: Scope (001-1111)\n##     - Bits 8-127: Group ID\n##     \n##     Example: ff02::1\n##     - ff = multicast\n##     - 02 = scope 2 (link-local) ✓\n##     - ::1 = group 1 (all nodes)\n\n## Q9: IPv6 multicast scopes\n##     Scope levels (bits 4-7 of second octet):\n##     1 = interface-local (device only)\n##     2 = link-local (one link/LAN)\n##     5 = site-local (organization)\n##     8 = organization-local\n##     e = global\n##     \n##     MedicalNet Examples:\n##     ff01::1 = All nodes on _______  (local device only)\n##     ff02::1 = All nodes on _______ (LAN/subnet)\n##     ff02::2 = All routers on _______ (routing)\n##     ff05::1:3 = All DHCP servers in _______\n##     ffe0:: = Global _______\n\n## Q10: Common IPv6 multicast groups\n##      ff02::1 = All nodes (broadcast replacement) ✓\n##      - Used for: _______\n##      - Sent by: _______ (routers)\n##      \n##      ff02::2 = All routers\n##      - Used for: _______\n##      - Sent by: _______\n##      \n##      ff02::1:ffXX:XXXX = Solicited-node multicast\n##      - Used for: _______\n##      - Example: ff02::1:ff3c:4d5e (for X3c:4d5e devices)\n##      \n##      ff00:0:0:0:0:0:0:0 = Unassigned global\n##      ffe0:0:0:0:0:0:0:0 = Reserved for research\n\n## PART 4: MEDICALNET DESIGN\n## Q11: Hospital A detailed design\n##      Allocation: 2001:db8:1234:1::/64 (65,536 addresses)\n##      Size: 500 devices across departments\n##      \n##      Addresses:\n##      - Default gateway: 2001:db8:1234:1::1/64\n##      - First server: 2001:db8:1234:1::101/64\n##      - Patient records DB: 2001:db8:1234:1::102/64\n##      - HIPAA logging: 2001:db8:1234:1::103/64\n##      - Workstations: 2001:db8:1234:1::1000-2fff/64\n##      - Printers: 2001:db8:1234:1::3000-3fff/64\n##      - Medical devices: 2001:db8:1234:1::4000-4fff/64\n##      - Guest/vendor: 2001:db8:1234:1::5000-5fff/64\n##      \n##      Why /64? _______ addresses per subnet (more than enough)\n##      Total usable in /64: _______ (2^64-2)\n##      Utilization: 500/_______ (excellent efficiency)\n\n## Q12: Hierarchical scope in MedicalNet\n##      Global scope (Internet-routable):\n##      - Public web servers: 2001:db8:1234:100::/64\n##      - Email servers: 2001:db8:1234:101::/64\n##      \n##      Organization scope (internal only):\n##      - Hospital networks: 2001:db8:1234:1-99::/64 (private firewall)\n##      - Research: 2001:db8:1234:200-299::/64\n##      - Backup systems: 2001:db8:1234:400::/64\n##      \n##      Link scope (local networks only):\n##      - Router-router negotiation: fe80::/10 ✓\n##      - Device-device local: fe80::/10 ✓\n##      - Neighbor discovery: ff02::/8\n##      \n##      Result: Proper segmentation with: _______ support\n\n## Q13: Address planning for growth\n##      Current: 500 devices, 1 hospital\n##      Growth plan (5 years):\n##      - Year 1: 3 hospitals (assume 500 each)\n##      - Year 2: 5 hospitals\n##      - Year 3: 7 hospitals + 2 research centers\n##      - Year 5: 10 hospitals + 3 research + 50 clinics\n##      \n##      With /48 from ISP: 2^16 = _______ /64 subnets\n##      Can support: _______ × 65,536 = _______ devices\n##      Current usage: _______\n##      Growth headroom: _______ (abundant)\n\n## Q14: DAD (Duplicate Address Detection)\n##      Process when device boots:\n##      1. Generate link-local: fe80::021a:2bff:fe3c:4d5e\n##      2. Send NS (Neighbor Solicitation) to _______ address\n##      3. Wait for response (Neighbor Advertisement)\n##      4. If no response: Address is _______ ✓\n##      5. If response received: Address _______ (collision!) ✗\n##      \n##      This prevents: _______\n##      In MedicalNet: Critical for HIPAA _______ requirements\n\n## Q15: Site-local considerations\n##      MedicalNet spans multiple geographic locations:\n##      - 10 hospitals (different cities)\n##      - 3 research centers\n##      - Corporate HQ\n##      \n##      Multicast routing:\n##      - ff02:: (link-local) reaches: _______ LAN\n##      - ff05:: (site-local) reaches: _______ organization\n##      - ffe0:: (global) reaches: _______\n##      \n##      Hospital-A needs to reach Hospital-B:\n##      - Multicast: ff05:: (if configured)\n##      - Or unicast: 2001:db8:1234:2::1 (explicit address)\n\n## Q16: Security considerations\n##      IPv6 source address verification:\n##      - Device claims: fe80::021a:2bff:fe3c:4d5e\n##      - Verify: MAC address matches (021a:2b__ ___ 3c:4d:5e)\n##      - Spoof prevention: _______\n##      \n##      Multicast filtering:\n##      - Allow: ff02::1 (all nodes, needed)\n##      - Allow: ff02::2 (routing updates)\n##      - Block: Unauthorized _______ groups\n##      - Reduces: Attack surface ✓\n\n## Q17: IPv6 address collision scenarios\n##      Scenario 1: Two devices generate same link-local\n##      - Address: fe80::1\n##      - Both on same: _______\n##      - Result: _______\n##      - Solution: _______ (duplicate address detected)\n##      \n##      Scenario 2: ISP changes, new prefix needed\n##      - Old: 2001:db8:1234::/48\n##      - New: 2001:db8:5678::/48\n##      - Process: IPv6 _______ (gradual transition)\n##      - Benefit: _______ renumbering\n\n## Q18: Anycast implementation\n##      Anycast example: Multiple DNS servers\n##      - Server 1 (Boston): 2001:db8:1234:1::53\n##      - Server 2 (NYC): 2001:db8:1234:2::53\n##      - Server 3 (LA): 2001:db8:1234:3::53\n##      \n##      Clients configure anycast: 2001:db8:1234::53 (same!)\n##      Routing reaches: _______ instance\n##      Load balancing: _______\n##      Redundancy: _______ server ✓\n\n## Q19: IPv6 subnet segmentation\n##      MedicalNet HIPAA requirements:\n##      Medical records: 2001:db8:1234:10::/64\n##      - Only authorized staff: _______\n##      - Encryption: _______\n##      - Logging: _______ audit trail\n##      \n##      Guest/Public: 2001:db8:1234:5000::/64\n##      - Limited scope: _______\n##      - No access to: _______\n##      - Firewall enforcement: _______\n##      \n##      Result: Network segmentation by _______\n\n## Q20: Addressing for IoT devices\n##      MedicalNet connected devices:\n##      - Monitors: 2001:db8:1234:1:4000::/68 (16 devices)\n##      - Pumps: 2001:db8:1234:1:4100::/68 (16 devices)\n##      - Imaging equipment: 2001:db8:1234:1:4200::/68\n##      \n##      /68 = _______ addresses per subnet (16 devices)\n##      Comparison: IPv4 /28 = 14 devices\n##      IPv6 advantage: _______ more efficient per subnet\n##      \n##      EUI-64 for devices:\n##      Medical monitor MAC: 00:01:02:03:04:05\n##      Auto-generated: 2001:db8:1234:1:4000:_______\n##      No manual configuration needed: _______\n\n## Q21: Future expansion planning\n##      MedicalNet global expansion (2025-2027):\n##      - Europe offices: Receive new /48\n##      - Asia offices: Receive new /48\n##      - Each maintains: _______ subnets max\n##      \n##      Single /8 from IANA provides: 2^40 = _______ /48s\n##      Enough for: Thousands of organizations\n##      Your /48 organization can create: _______ subnets\n##      Your /64 subnet: _______ devices\n##      \n##      Key insight: IPv6 hierarchical addressing enables:\n##      - Scalable growth\n##      - Independent subnetting\n##      - _______\n##      - International operations",
  "solution": "# IPv6 ADDRESS TYPES AND SCOPES SOLUTION\n\n## PART 1: IPv6 ADDRESS TYPE CLASSIFICATION\n\n### Address Categories\n\n**Q1: Address type hierarchy**\n\nIPv6 addresses categorized by:\n1. Type (unicast/multicast/anycast)\n2. Scope (device/link/site/organization/global)\n\nUnicast: **one-to-one** communication ✓\n- One sender → one receiver ✓\n- Example: 2001:db8::1 → device\n\nMulticast: **one-to-many** communication ✓\n- One sender → multiple receivers ✓\n- Example: ff02::1 → all nodes on link\n\nAnycast: **one-to-nearest** communication ✓\n- One sender → nearest receiver ✓\n- Example: Multiple DNS servers with same address\n\nBroadcast: **doesn't exist in IPv6** ✗\n- Replaced by: **multicast** ✓\n\n**Q2: No broadcast in IPv6**\n\nIPv4 broadcast problems:\n- 255.255.255.255 (limited broadcast)\n- 192.168.1.255 (directed broadcast)\n- Reaches EVERY device: **inefficient** ⚠️\n- Causes: Unnecessary processing, **broadcast storms** ⚠️\n\nIPv6 solution - use multicast instead:\n- ff02::1 (all nodes on local link)\n- ff02::2 (all routers on local link)\n- ff02::1:ff__:____ (solicited-node multicast)\n\nBenefits: **efficiency**, **scalability**, **reduced congestion** ✓\n\n## PART 2: UNICAST ADDRESSES\n\n### Address Structure and Allocation\n\n**Q3: Global Unicast Address (GUA) structure**\n\nStandard GUA: 2001:db8:1234:5678:abcd:ef01:2345:6789/64\n\nBreakdown:\n| 48 bits | 16 bits | 64 bits |\n|---------|---------|----------|\n| Global  | Subnet  | Interface|\n| Prefix  | ID      | ID       |\n\nGlobal Prefix allocation:\n- IANA → RIRs: **/23** blocks ✓\n- RIR → ISP: **/32** to **/48** blocks ✓\n- ISP → Customer: Typically **/48** (65,536 subnets) ✓\n- Customer creates: **/64** subnets (65,536 addresses each) ✓\n\n**Q4: GUA hierarchical allocation**\n\nMedicalNet receives: 2001:db8:1234::/48 from ISP ✓\n\nAllocate to hospitals:\nHospital-A: 2001:db8:1234:1::/64\nHospital-B: 2001:db8:1234:2::/64\nHospital-C: 2001:db8:1234:3::/64\n...\nResearch Center: 2001:db8:1234:100::/64\nCorporate HQ: 2001:db8:1234:200::/64\n\nEach hospital can have:\n- ICU: 2001:db8:1234:1::/64 (first) ✓\n- Emergency: 2001:db8:1234:2::/64\n- Surgery: 2001:db8:1234:3::/64\n- Admin: 2001:db8:1234:4::/64\n- Patient Records: 2001:db8:1234:5::/64\n\nWhy /48 from ISP? **65,536** subnets available ✓\nWhy /64 per subnet? **18 billion billion** addresses per subnet ✓\n\n**Q5: Unique Local Address (ULA) implementation**\n\nULA prefix: fc00::/7 or fd00::/8 ✓\n\nFormat: fd12:3456:789a:0001:abcd:ef01:2345:6789\n\nMedicalNet internal network:\n- Backup data center (private): fd2a:4c8e:abcd::/48\n- Research network (internal): fd2a:4c8e:cdef::/48\n- Guest WiFi (isolated): fd2a:4c8e:0001::/48\n\nAdvantages:\n- No registration needed: **self-assigned** ✓\n- Not routable on internet: **privacy preserved** ✓\n- Can be combined with: **GUA (dual-stack)** ✓\n- Stable across ISP changes: **no renumbering required** ✓\n\n**Q6: Link-Local addresses**\n\nPrefix: fe80::/10 ✓\n\nAutomatic generation (EUI-64):\nMAC address: 00:1a:2b:3c:4d:5e\nProcess:\n1. Split MAC: 00:1a:2b | 3c:4d:5e\n2. Insert ffff: 00:1a:2b:ff:fe:3c:4d:5e\n3. Flip 7th bit: **0010 0000 → 0010 1010** (becomes 02)\n4. Result: fe80::021a:2bff:fe3c:4d5e ✓\n\nUsage in MedicalNet:\n- Router discovery: **RA (Router Advertisement)** ✓\n- Default gateway learning: **Router detection** ✓\n- Neighbor discovery: **NDP (Neighbor Discovery Protocol)** ✓\n- Initial bootstrap: **zero-touch deployment** ✓\n\nImportant: Link-local NOT routed beyond: **local link/segment** ✓\n\n**Q7: Address configuration process**\n\nDevice boots on network:\nStep 1: Link-local auto-generated\n- Address: fe80::021a:2bff:fe3c:4d5e ✓\n- Performs DAD (Duplicate Address Detection)\n- Can communicate locally now ✓\n\nStep 2: Listen for Router Advertisement\n- Router sends RA with global prefix\n- Example: 2001:db8:1234:5::/64\n\nStep 3: Combine prefix + local part\n- Address: 2001:db8:1234:5:021a:2bff:fe3c:4d5e/64\n- Can communicate globally now ✓\n\nThis process: **SLAAC (Stateless Address AutoConfiguration)** ✓\nNo DHCP needed: **automatic and zero-touch** ✓\n\n## PART 3: MULTICAST ADDRESSES\n\n### Multicast Format and Scopes\n\n**Q8: Multicast address format**\n\nPrefix: ff__:____:____:____:____:____:____:____\nFirst octet: FF00 (always ff) ✓\nNext octet: Flags + Scope\n\nBinary breakdown of second octet:\n- Bit 0: Flags/Reserved\n- Bits 1-4: Reserved/Flags\n- Bits 5-7: Scope (001-1111)\n- Bits 8-127: Group ID\n\nExample: ff02::1\n- ff = multicast ✓\n- 02 = scope 2 (link-local) ✓\n- ::1 = group 1 (all nodes) ✓\n\n**Q9: IPv6 multicast scopes**\n\nScope levels (bits 4-7 of second octet):\n1 = interface-local (device only)\n2 = link-local (one link/LAN) ✓\n5 = site-local (organization)\n8 = organization-local\ne = global ✓\n\nMedicalNet Examples:\nff01::1 = All nodes on **device** (local device only) ✓\nff02::1 = All nodes on **link** (LAN/subnet) ✓\nff02::2 = All routers on **link** (routing) ✓\nff05::1:3 = All DHCP servers in **site** ✓\nffe0:: = Global **scope** ✓\n\n**Q10: Common IPv6 multicast groups**\n\nff02::1 = All nodes (broadcast replacement) ✓\n- Used for: **network announcements** ✓\n- Sent by: **routers** (Router Advertisements) ✓\n\nff02::2 = All routers\n- Used for: **routing protocol updates** ✓\n- Sent by: **hosts** (when seeking router) ✓\n\nff02::1:ffXX:XXXX = Solicited-node multicast\n- Used for: **address resolution** ✓\n- Example: ff02::1:ff3c:4d5e (for X3c:4d5e devices) ✓\n\nff00:0:0:0:0:0:0:0 = Unassigned global\nffe0:0:0:0:0:0:0:0 = Reserved for research\n\n## PART 4: MEDICALNET DESIGN\n\n### Real-World Implementation\n\n**Q11: Hospital A detailed design**\n\nAllocation: 2001:db8:1234:1::/64 (65,536 addresses) ✓\nSize: 500 devices across departments\n\nAddresses:\n- Default gateway: 2001:db8:1234:1::1/64 ✓\n- First server: 2001:db8:1234:1::101/64\n- Patient records DB: 2001:db8:1234:1::102/64\n- HIPAA logging: 2001:db8:1234:1::103/64\n- Workstations: 2001:db8:1234:1::1000-2fff/64\n- Printers: 2001:db8:1234:1::3000-3fff/64\n- Medical devices: 2001:db8:1234:1::4000-4fff/64\n- Guest/vendor: 2001:db8:1234:1::5000-5fff/64\n\nWhy /64? **18 billion billion** addresses per subnet ✓\nTotal usable in /64: **18,446,744,073,709,551,614** (2^64-2) ✓\nUtilization: 500/**18,446,744,073,709,551,614** (essentially 0%!) ✓\n\n**Q12: Hierarchical scope in MedicalNet**\n\nGlobal scope (Internet-routable):\n- Public web servers: 2001:db8:1234:100::/64\n- Email servers: 2001:db8:1234:101::/64\n\nOrganization scope (internal only):\n- Hospital networks: 2001:db8:1234:1-99::/64 (private firewall) ✓\n- Research: 2001:db8:1234:200-299::/64\n- Backup systems: 2001:db8:1234:400::/64\n\nLink scope (local networks only):\n- Router-router negotiation: fe80::/10 ✓\n- Device-device local: fe80::/10 ✓\n- Neighbor discovery: ff02::/8 ✓\n\nResult: Proper segmentation with: **firewall/ACL** support ✓\n\n**Q13: Address planning for growth**\n\nCurrent: 500 devices, 1 hospital\nGrowth plan (5 years):\n- Year 1: 3 hospitals (assume 500 each)\n- Year 2: 5 hospitals\n- Year 3: 7 hospitals + 2 research centers\n- Year 5: 10 hospitals + 3 research + 50 clinics\n\nWith /48 from ISP: 2^16 = **65,536** /64 subnets ✓\nCan support: **65,536 × 2^64 = 1.2 × 10^21** devices ✓\nCurrent usage: **500 devices in 1 /64** ✓\nGrowth headroom: **unlimited** (essentially) ✓\n\n**Q14: DAD (Duplicate Address Detection)**\n\nProcess when device boots:\n1. Generate link-local: fe80::021a:2bff:fe3c:4d5e\n2. Send NS (Neighbor Solicitation) to **solicited-node multicast** address ✓\n3. Wait for response (Neighbor Advertisement)\n4. If no response: Address is **unique** ✓\n5. If response received: Address **conflicts** (collision!) ✗\n\nThis prevents: **accidental address collisions** ✓\nIn MedicalNet: Critical for HIPAA **audit trail** requirements ✓\n\n**Q15: Site-local considerations**\n\nMedicalNet spans multiple geographic locations:\n- 10 hospitals (different cities)\n- 3 research centers\n- Corporate HQ\n\nMulticast routing:\n- ff02:: (link-local) reaches: **single** LAN ✓\n- ff05:: (site-local) reaches: **entire** organization ✓\n- ffe0:: (global) reaches: **everywhere** ✓\n\nHospital-A needs to reach Hospital-B:\n- Multicast: ff05:: (if configured) ✓\n- Or unicast: 2001:db8:1234:2::1 (explicit address) ✓\n\n**Q16: Security considerations**\n\nIPv6 source address verification:\n- Device claims: fe80::021a:2bff:fe3c:4d5e\n- Verify: MAC address matches (021a:2b__ ___ 3c:4d:5e) ✓\n- Spoof prevention: **EUI-64 validation** ✓\n\nMulticast filtering:\n- Allow: ff02::1 (all nodes, needed) ✓\n- Allow: ff02::2 (routing updates) ✓\n- Block: Unauthorized **multicast** groups ✓\n- Reduces: Attack surface ✓\n\n**Q17: IPv6 address collision scenarios**\n\nScenario 1: Two devices generate same link-local\n- Address: fe80::1\n- Both on same: **link/network** ✓\n- Result: **duplicate conflict** ✗\n- Solution: **DAD detects** (duplicate address detected) ✓\n\nScenario 2: ISP changes, new prefix needed\n- Old: 2001:db8:1234::/48\n- New: 2001:db8:5678::/48\n- Process: IPv6 **renumbering** (gradual transition) ✓\n- Benefit: **no network downtime** ✓\n\n**Q18: Anycast implementation**\n\nAnycast example: Multiple DNS servers\n- Server 1 (Boston): 2001:db8:1234:1::53\n- Server 2 (NYC): 2001:db8:1234:2::53\n- Server 3 (LA): 2001:db8:1234:3::53\n\nClients configure anycast: 2001:db8:1234::53 (same!) ✓\nRouting reaches: **nearest** instance ✓\nLoad balancing: **geographic/routing-based** ✓\nRedundancy: **automatic failover** server ✓\n\n**Q19: IPv6 subnet segmentation**\n\nMedicalNet HIPAA requirements:\nMedical records: 2001:db8:1234:10::/64\n- Only authorized staff: **firewall rules** ✓\n- Encryption: **TLS/IPsec** ✓\n- Logging: **comprehensive** audit trail ✓\n\nGuest/Public: 2001:db8:1234:5000::/64\n- Limited scope: **isolated network** ✓\n- No access to: **internal systems** ✓\n- Firewall enforcement: **strict ACLs** ✓\n\nResult: Network segmentation by **subnet prefix** ✓\n\n**Q20: Addressing for IoT devices**\n\nMedicalNet connected devices:\n- Monitors: 2001:db8:1234:1:4000::/68 (16 devices)\n- Pumps: 2001:db8:1234:1:4100::/68 (16 devices)\n- Imaging equipment: 2001:db8:1234:1:4200::/68\n\n/68 = **256** addresses per subnet (16 devices) ✓\nComparison: IPv4 /28 = 14 devices\nIPv6 advantage: **18 billion times** more efficient per subnet ✓\n\nEUI-64 for devices:\nMedical monitor MAC: 00:01:02:03:04:05\nAuto-generated: 2001:db8:1234:1:4000:**0201:02ff:fe03:0405** ✓\nNo manual configuration needed: **automatic from MAC** ✓\n\n**Q21: Future expansion planning**\n\nMedicalNet global expansion (2025-2027):\n- Europe offices: Receive new /48\n- Asia offices: Receive new /48\n- Each maintains: **65,536** subnets max ✓\n\nSingle /8 from IANA provides: 2^40 = **1,099,511,627,776** /48s ✓\nEnough for: Thousands of organizations ✓\nYour /48 organization can create: **65,536** subnets ✓\nYour /64 subnet: **18,446,744,073,709,551,614** devices ✓\n\nKey insight: IPv6 hierarchical addressing enables:\n- Scalable growth ✓\n- Independent subnetting ✓\n- **No address conflicts** ✓\n- International operations ✓",
  "hints": [
    "IPv6 address types: unicast (1-to-1), multicast (1-to-many), anycast (1-to-nearest); no broadcast",
    "Three unicast types: GUA (global/routable), ULA (private/local), Link-Local (fe80::/10, auto-generated)",
    "Multicast prefix ff00::/8; second octet contains scope: 1=interface, 2=link, 5=site, e=global",
    "Standard allocation: /48 to organization enables 65,536 /64 subnets; each /64 = 2^64 addresses (unlimited)",
    "Link-Local auto-generated from MAC using EUI-64: insert ffff in middle, flip 7th bit; used for bootstrap",
    "SLAAC = Stateless Address AutoConfiguration; device gets global address without DHCP server",
    "DAD (Duplicate Address Detection) prevents address collisions; sends NS to solicited-node multicast",
    "Anycast = multiple servers with same address; routing delivers to nearest instance",
    "Multicast replaces IPv4 broadcast: ff02::1 (all nodes), ff02::2 (all routers), ff02::1:ffXX:XXXX (solicited-node)",
    "IPv6 enables easy renumbering (entire org can renumber independently); supports organizational growth without address conflicts"
  ],
  "testCases": [
    {"id": "tc1-types", "description": "Address types", "input": "Unicast multicast", "expected": "1-to-1, 1-to-many", "assert": "assert ('unicast' in solution.lower() or 'multicast' in solution.lower() or '1-to' in solution)"},
    {"id": "tc2-no-broadcast", "description": "No broadcast", "input": "ff02", "expected": "Multicast replacement", "assert": "assert ('multicast' in solution.lower() or 'ff02' in solution)"},
    {"id": "tc3-gua", "description": "GUA structure", "input": "48/16/64", "expected": "Prefix/Subnet/Interface", "assert": "assert ('48' in solution or '16' in solution or 'prefix' in solution.lower())"},
    {"id": "tc4-ula", "description": "ULA prefix", "input": "Private", "expected": "fd00::/8", "assert": "assert ('fd00' in solution or 'ula' in solution.lower() or 'private' in solution.lower())"},
    {"id": "tc5-linklocal", "description": "Link-Local", "input": "fe80", "expected": "Auto-generated, EUI-64", "assert": "assert ('fe80' in solution or 'eui' in solution.lower() or 'auto' in solution.lower())"},
    {"id": "tc6-slaac", "description": "SLAAC", "input": "Autoconfiguration", "expected": "No DHCP", "assert": "assert ('slaac' in solution.lower() or 'auto' in solution.lower() or 'dhcp' in solution.lower())"},
    {"id": "tc7-dad", "description": "DAD", "input": "Duplicate detection", "expected": "Neighbor solicitation", "assert": "assert ('dad' in solution.lower() or 'duplicate' in solution.lower() or 'ns' in solution)"},
    {"id": "tc8-multicast-scope", "description": "Multicast scope", "input": "ff02/ff05", "expected": "Link/site", "assert": "assert ('ff02' in solution or 'ff05' in solution or 'link' in solution.lower() or 'site' in solution.lower())"},
    {"id": "tc9-anycast", "description": "Anycast", "input": "Nearest", "expected": "Multiple servers", "assert": "assert ('anycast' in solution.lower() or 'nearest' in solution.lower() or 'server' in solution.lower())"},
    {"id": "tc10-hierarchy", "description": "Hierarchical planning", "input": "Growth", "expected": "65536 subnets", "assert": "assert ('65536' in solution or '65,536' in solution or 'growth' in solution.lower())"}
  ]
}