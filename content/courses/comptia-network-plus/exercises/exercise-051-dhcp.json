{
  "id": "exercise-051-dhcp",
  "lessonId": "lesson-051-dhcp",
  "title": "DHCP - Dynamic Host Configuration Protocol",
  "description": "Master DHCP server configuration, scope management, lease management, and troubleshooting. Deploy DHCP across networks with proper subnetting, reservations, and relay agents.",
  "difficulty": "intermediate",
  "points": 100,
  "language": "text",
  "starterCode": "# DHCP EXERCISE\n# Configure dynamic IP address allocation\n\n## SCENARIO: TechCorp Network Expansion\n## - Organization: 500 employees, 3 office locations\n## - Challenge: Automatic IP assignment, centralized management\n## - Current: Manual IP assignment (administrative nightmare)\n## - Goal: Implement DHCP for all locations\n\n## PART 1: DHCP FUNDAMENTALS\n## Q1: What is DHCP?\n##     Definition: _______ (Dynamic Host Configuration Protocol)\n##     Purpose: _______ (automatically assign IP addresses)\n##     Benefits: _______ (no manual configuration, centralized)\n##     \n##     Components:\n##     - Server: Maintains pool of addresses\n##     - Client: Requests IP on startup\n##     - Process: Allocation, lease, renewal\n\n## Q2: DHCP vs Static IP:\n##     Static IP (manual):\n##     - Assignment: _______ (administrator configures)\n##     - Flexibility: Low (change = reconfigure)\n##     - Reliability: High (won't change)\n##     - Use: Servers, printers (need consistent address)\n##     - Admin burden: _______ (high, every device)\n##     \n##     Dynamic IP (DHCP):\n##     - Assignment: _______ (server automatically assigns)\n##     - Flexibility: High (roaming, temporary devices)\n##     - Reliability: Depends on DHCP server\n##     - Use: Desktops, laptops, temporary devices\n##     - Admin burden: _______ (low, centralized)\n\n## Q3: DHCP process (DORA):\n##     Step 1: Discover _______ (client broadcasts request)\n##     - Packet: \"Any DHCP servers out there?\"\n##     - Scope: Broadcast to entire subnet\n##     - Message type: DHCPDISCOVER\n##     \n##     Step 2: Offer _______ (server offers address)\n##     - Packet: \"You can use 192.168.1.100 for 8 hours\"\n##     - Sent: Unicast to client\n##     - Message type: DHCPOFFER\n##     \n##     Step 3: Request _______ (client accepts offer)\n##     - Packet: \"I accept 192.168.1.100\"\n##     - Scope: Broadcast (other servers cancel offers)\n##     - Message type: DHCPREQUEST\n##     \n##     Step 4: Acknowledge _______ (server confirms)\n##     - Packet: \"Confirmed, lease until 10 AM\"\n##     - Sent: Unicast to client\n##     - Message type: DHCPACK\n\n## Q4: DHCP lease process:\n##     Lease duration: _______ (typically 8 hours to 7 days)\n##     \n##     Timeline:\n##     - T=0: IP assigned, lease begins\n##     - T=50% (4 hours): Renewal attempt (T1)\n##     - T=87.5% (7 hours): Rebinding attempt (T2)\n##     - T=100% (8 hours): Lease expires\n##     \n##     Renewal process:\n##     - Attempt: Contact original DHCP server\n##     - If available: Renew lease (extends 8 more hours)\n##     - If unavailable: Try other servers (rebinding)\n##     - If no response: Keep using IP (grace period)\n##     - Expiration: Release IP after lease ends\n\n## Q5: DHCP scope configuration:\n##     Network: 192.168.1.0/24 (256 total addresses)\n##     \n##     Scope configuration:\n##     - Start address: _______ (192.168.1.100)\n##     - End address: _______ (192.168.1.200)\n##     - Range: 101 addresses available\n##     - Reserved: Gateway (192.168.1.1), etc.\n##     - Lease duration: _______ (8 hours)\n##     \n##     Exclusion list:\n##     - 192.168.1.1: Gateway\n##     - 192.168.1.5: DNS server\n##     - 192.168.1.10: Print server\n##     - Reason: These need fixed IPs\n\n## PART 2: DHCP SERVER CONFIGURATION\n## Q6: DHCP server roles:\n##     Primary server:\n##     - Role: _______ (main server, owns scopes)\n##     - Availability: Must be up\n##     - Failure: Network cannot get IPs\n##     - Backup: Secondary server needed\n##     \n##     Secondary server:\n##     - Role: _______ (backup, shares scopes)\n##     - Availability: Activated if primary fails\n##     - Configuration: Mirrors primary scopes\n##     - Split: Typically 70/30 or 80/20\n##     \n##     Failover:\n##     - 80/20 split: Primary has 80%, secondary 20%\n##     - Reason: _______ (faster primary response)\n##     - Redundancy: If primary fails, 20% still available\n\n## Q7: DHCP scope for multiple subnets:\n##     TechCorp offices:\n##     - HQ (192.168.1.0/24): 200 employees\n##     - Branch A (192.168.2.0/24): 100 employees\n##     - Branch B (192.168.3.0/24): 50 employees\n##     \n##     Scope 1 (HQ):\n##     - Range: 192.168.1.100 - 192.168.1.250\n##     - Hosts: _______ (151 available)\n##     - Lease: 8 hours\n##     \n##     Scope 2 (Branch A):\n##     - Range: 192.168.2.100 - 192.168.2.200\n##     - Hosts: _______ (101 available)\n##     - Lease: 8 hours\n##     \n##     Scope 3 (Branch B):\n##     - Range: 192.168.3.100 - 192.168.3.150\n##     - Hosts: _______ (51 available)\n##     - Lease: 8 hours\n\n## Q8: DHCP options:\n##     Common options:\n##     - Option 3: _______ (default gateway, e.g., 192.168.1.1)\n##     - Option 6: _______ (DNS servers, e.g., 8.8.8.8, 8.8.4.4)\n##     - Option 15: _______ (domain name, e.g., techcorp.com)\n##     - Option 42: _______ (NTP server for time sync)\n##     - Option 44: _______ (WINS servers for NetBIOS)\n##     \n##     Configuration:\n##     - Set in scope options\n##     - Applied to all clients in scope\n##     - Can be overridden per client\n\n## PART 3: DHCP RESERVATIONS & EXCLUSIONS\n## Q9: DHCP reservations:\n##     What: _______ (permanent IP allocation by MAC address)\n##     \n##     Use cases:\n##     - Print server: Always 192.168.1.10\n##     - Wireless AP: Always 192.168.1.20\n##     - File server: Always 192.168.1.30\n##     - Reason: _______ (external systems need fixed IPs)\n##     \n##     Configuration:\n##     - MAC address: 00:11:22:33:44:55 (printer)\n##     - Reserved IP: 192.168.1.10\n##     - Always assigned: Even after reboot\n##     - Benefit: _______ (centralized IP management)\n\n## Q10: DHCP exclusions:\n##      What: _______ (addresses NOT assigned by DHCP)\n##      \n##      Types:\n##      - Range exclusion: 192.168.1.1 - 192.168.1.50\n##      - Single exclusion: 192.168.1.5 (DNS)\n##      \n##      Example:\n##      - Scope: 192.168.1.0/24 (256 addresses)\n##      - Exclude: 192.168.1.1 - 192.168.1.99 (99 addresses)\n##      - Available: 192.168.1.100 - 192.168.1.254 (155 addresses)\n##      - Reason: _______ (reserve for static IPs)\n\n## PART 4: DHCP RELAY & REMOTE SUBNETS\n## Q11: DHCP relay agent:\n##      Problem: _______ (DHCP broadcast doesn't cross routers)\n##      - Broadcast domain: Limited to local subnet\n##      - Remote subnets: Cannot reach DHCP server\n##      - Solution: DHCP relay agent\n##      \n##      Relay process:\n##      1. Client broadcasts DHCPDISCOVER\n##      2. Relay intercepts (local router or server)\n##      3. Relay converts to unicast\n##      4. Relay sends to DHCP server (remote)\n##      5. Server responds with offer\n##      6. Relay converts back to broadcast\n##      7. Client receives offer on local subnet\n\n## Q12: DHCP relay configuration:\n##      Scenario: HQ has DHCP server, branches need DHCP\n##      \n##      Branch A setup:\n##      - Router at 192.168.2.1 (gateway)\n##      - Enable DHCP relay on router\n##      - Point to: HQ DHCP server (10.0.0.5)\n##      - Result: _______ (clients get IPs from HQ)\n##      \n##      Benefit:\n##      - Single server: Centralized management\n##      - Lower cost: One DHCP license\n##      - Consistency: All sites use same settings\n\n## PART 5: DHCP TROUBLESHOOTING\n## Q13: Common DHCP issues:\n##      Issue: Client cannot get IP address\n##      - Cause 1: _______ (DHCP scope exhausted)\n##      - Cause 2: _______ (DHCP server down)\n##      - Cause 3: _______ (relay not configured)\n##      - Cause 4: _______ (network connectivity issue)\n##      \n##      Troubleshooting:\n##      - Check 1: Is DHCP server running?\n##      - Check 2: Are there available IPs in scope?\n##      - Check 3: Can client reach DHCP server?\n##      - Check 4: Is DHCP relay configured on routers?\n\n## Q14: DHCP scope exhaustion:\n##      Problem: All IPs assigned, new clients get error\n##      \n##      Scenario:\n##      - Scope: 192.168.1.100 - 192.168.1.200 (101 addresses)\n##      - Leased: 101/101 (100%)\n##      - New client: Cannot get IP\n##      - Error: \"No addresses available\"\n##      \n##      Solutions:\n##      - Reduce lease time: _______ (smaller scope timeout)\n##      - Add more scope: _______ (extend range)\n##      - Remove reservations: _______ (free up IPs)\n##      - Increase servers: _______ (secondary server)\n\n## Q15: DHCP client issues:\n##      Issue: Device has APIPA address (169.254.x.x)\n##      - Meaning: _______ (no DHCP server reachable)\n##      - Cause: Network connectivity, DHCP down\n##      - Solution: Renew lease (ipconfig /renew)\n##      \n##      Issue: Device using wrong subnet\n##      - Symptom: _______ (address from different scope)\n##      - Cause: Relay misconfiguration\n##      - Solution: Check relay settings\n\n## Q16: Monitoring DHCP:\n##      Metrics:\n##      - Scope utilization: _______ (% IPs in use)\n##      - Lease count: How many active leases?\n##      - Fail rate: Failed lease requests?\n##      - Renewal rate: How often renewed?\n##      \n##      Alerts:\n##      - Utilization >80%: _______ (scope nearly full)\n##      - Server down: _______ (no DHCP available)\n##      - Unusual activity: DoS or attack?\n\n## PART 6: DHCP BEST PRACTICES\n## Q17: DHCP server placement:\n##      Single-site deployment:\n##      - One server: Sufficient for < 100 devices\n##      - Primary/secondary: Recommended (redundancy)\n##      - Colocation: _______ (same room as equipment)\n##      \n##      Multi-site deployment:\n##      - Option 1: Central server + relay agents\n##      - Option 2: _______ (distributed servers per site)\n##      - Recommended: Central (easier management)\n\n## Q18: Scope sizing:\n##      Question: \"How big should DHCP scope be?\"\n##      \n##      Formula:\n##      - Current devices: 100\n##      - Growth rate: 20% per year\n##      - Planning period: 3 years\n##      - Future: 100 × 1.2^3 = _______ (173 devices)\n##      - Scope size: _______ (200 addresses, 15% buffer)\n\n## Q19: Security best practices:\n##      DHCP snooping:\n##      - Purpose: _______ (prevent rogue DHCP servers)\n##      - Configuration: Whitelist trusted ports\n##      - Untrusted ports: Reject DHCP responses\n##      - Benefit: _______ (prevent IP hijacking)\n##      \n##      IP source guard:\n##      - Purpose: _______ (ensure IP matches reserved MAC)\n##      - Configuration: Combine with DHCP snooping\n##      - Effect: Block IP spoofing attacks\n\n## Q20: DHCP documentation:\n##      Must document:\n##      - Scope ranges: _______ (all subnets, ranges)\n##      - Reservations: _______ (MAC/IP pairs)\n##      - Relay configuration: _______ (which routers)\n##      - Options: _______ (DNS, gateway, NTP)\n##      - Failover: _______ (primary/secondary setup)\n##      - Contacts: _______ (administrator names, phones)",
  "solution": "# DHCP SOLUTION\n\n## PART 1: DHCP FUNDAMENTALS\n\n### What is DHCP?\n\n**Definition**: **DYNAMIC HOST CONFIGURATION PROTOCOL** ✓\n**Purpose**: **AUTOMATICALLY ASSIGN IP ADDRESSES** ✓\n**Benefits**: **NO MANUAL CONFIGURATION, CENTRALIZED** ✓\n\n**Components**:\n- Server: Maintains pool of addresses\n- Client: Requests IP on startup\n- Process: Allocation, lease, renewal\n\n### DHCP vs Static IP\n\n**Static IP** (manual):\n- Assignment: **ADMINISTRATOR CONFIGURES**\n- Flexibility: Low (change = reconfigure)\n- Reliability: High (won't change)\n- Use: Servers, printers (need consistent address)\n- Admin burden: **HIGH, EVERY DEVICE**\n\n**Dynamic IP** (DHCP):\n- Assignment: **SERVER AUTOMATICALLY ASSIGNS** ✓\n- Flexibility: High (roaming, temporary devices)\n- Reliability: Depends on DHCP server\n- Use: Desktops, laptops, temporary devices\n- Admin burden: **LOW, CENTRALIZED** ✓\n\n### DHCP Process (DORA)\n\n**Step 1 - Discover**: **CLIENT BROADCASTS REQUEST** ✓\n- Packet: \"Any DHCP servers out there?\"\n- Scope: Broadcast to entire subnet\n- Message type: DHCPDISCOVER\n\n**Step 2 - Offer**: **SERVER OFFERS ADDRESS** ✓\n- Packet: \"You can use 192.168.1.100 for 8 hours\"\n- Sent: Unicast to client\n- Message type: DHCPOFFER\n\n**Step 3 - Request**: **CLIENT ACCEPTS OFFER** ✓\n- Packet: \"I accept 192.168.1.100\"\n- Scope: Broadcast (other servers cancel offers)\n- Message type: DHCPREQUEST\n\n**Step 4 - Acknowledge**: **SERVER CONFIRMS** ✓\n- Packet: \"Confirmed, lease until 10 AM\"\n- Sent: Unicast to client\n- Message type: DHCPACK\n\n### DHCP Lease Process\n\n**Lease duration**: **TYPICALLY 8 HOURS TO 7 DAYS** ✓\n\n**Timeline**:\n- T=0: IP assigned, lease begins\n- T=50% (4 hours): Renewal attempt (T1)\n- T=87.5% (7 hours): Rebinding attempt (T2)\n- T=100% (8 hours): Lease expires\n\n**Renewal process**:\n- Attempt: Contact original DHCP server\n- If available: Renew lease (extends 8 more hours) ✓\n- If unavailable: Try other servers (rebinding)\n- If no response: Keep using IP (grace period)\n- Expiration: Release IP after lease ends\n\n### DHCP Scope Configuration\n\n**Network**: 192.168.1.0/24 (256 total addresses)\n\n**Scope configuration**:\n- Start address: **192.168.1.100** ✓\n- End address: **192.168.1.200** ✓\n- Range: 101 addresses available\n- Reserved: Gateway (192.168.1.1), etc.\n- Lease duration: **8 HOURS** ✓\n\n**Exclusion list**:\n- 192.168.1.1: Gateway\n- 192.168.1.5: DNS server\n- 192.168.1.10: Print server\n- Reason: These need fixed IPs\n\n## PART 2: DHCP SERVER CONFIGURATION\n\n### DHCP Server Roles\n\n**Primary server**:\n- Role: **MAIN SERVER, OWNS SCOPES** ✓\n- Availability: Must be up\n- Failure: Network cannot get IPs\n- Backup: Secondary server needed\n\n**Secondary server**:\n- Role: **BACKUP, SHARES SCOPES** ✓\n- Availability: Activated if primary fails\n- Configuration: Mirrors primary scopes\n- Split: Typically 70/30 or 80/20\n\n**Failover**:\n- 80/20 split: Primary has 80%, secondary 20%\n- Reason: **FASTER PRIMARY RESPONSE** ✓\n- Redundancy: If primary fails, 20% still available\n\n### DHCP Scope for Multiple Subnets\n\n**TechCorp offices**:\n- HQ (192.168.1.0/24): 200 employees\n- Branch A (192.168.2.0/24): 100 employees\n- Branch B (192.168.3.0/24): 50 employees\n\n**Scope 1** (HQ):\n- Range: 192.168.1.100 - 192.168.1.250\n- Hosts: **151 AVAILABLE** ✓\n- Lease: 8 hours\n\n**Scope 2** (Branch A):\n- Range: 192.168.2.100 - 192.168.2.200\n- Hosts: **101 AVAILABLE** ✓\n- Lease: 8 hours\n\n**Scope 3** (Branch B):\n- Range: 192.168.3.100 - 192.168.3.150\n- Hosts: **51 AVAILABLE** ✓\n- Lease: 8 hours\n\n### DHCP Options\n\n**Common options**:\n- Option 3: **DEFAULT GATEWAY** (e.g., 192.168.1.1) ✓\n- Option 6: **DNS SERVERS** (e.g., 8.8.8.8, 8.8.4.4) ✓\n- Option 15: **DOMAIN NAME** (e.g., techcorp.com) ✓\n- Option 42: **NTP SERVER FOR TIME SYNC** ✓\n- Option 44: **WINS SERVERS FOR NetBIOS** ✓\n\n**Configuration**:\n- Set in scope options\n- Applied to all clients in scope\n- Can be overridden per client\n\n## PART 3: DHCP RESERVATIONS & EXCLUSIONS\n\n### DHCP Reservations\n\n**What**: **PERMANENT IP ALLOCATION BY MAC ADDRESS** ✓\n\n**Use cases**:\n- Print server: Always 192.168.1.10\n- Wireless AP: Always 192.168.1.20\n- File server: Always 192.168.1.30\n- Reason: **EXTERNAL SYSTEMS NEED FIXED IPS** ✓\n\n**Configuration**:\n- MAC address: 00:11:22:33:44:55 (printer)\n- Reserved IP: 192.168.1.10\n- Always assigned: Even after reboot ✓\n- Benefit: **CENTRALIZED IP MANAGEMENT** ✓\n\n### DHCP Exclusions\n\n**What**: **ADDRESSES NOT ASSIGNED BY DHCP** ✓\n\n**Types**:\n- Range exclusion: 192.168.1.1 - 192.168.1.50\n- Single exclusion: 192.168.1.5 (DNS)\n\n**Example**:\n- Scope: 192.168.1.0/24 (256 addresses)\n- Exclude: 192.168.1.1 - 192.168.1.99 (99 addresses)\n- Available: 192.168.1.100 - 192.168.1.254 (155 addresses)\n- Reason: **RESERVE FOR STATIC IPS** ✓\n\n## PART 4: DHCP RELAY & REMOTE SUBNETS\n\n### DHCP Relay Agent\n\n**Problem**: **DHCP BROADCAST DOESN'T CROSS ROUTERS** ⚠️\n- Broadcast domain: Limited to local subnet\n- Remote subnets: Cannot reach DHCP server\n- Solution: DHCP relay agent\n\n**Relay process**:\n1. Client broadcasts DHCPDISCOVER\n2. Relay intercepts (local router or server)\n3. Relay converts to unicast ✓\n4. Relay sends to DHCP server (remote)\n5. Server responds with offer\n6. Relay converts back to broadcast\n7. Client receives offer on local subnet\n\n### DHCP Relay Configuration\n\n**Scenario**: HQ has DHCP server, branches need DHCP\n\n**Branch A setup**:\n- Router at 192.168.2.1 (gateway)\n- Enable DHCP relay on router\n- Point to: HQ DHCP server (10.0.0.5)\n- Result: **CLIENTS GET IPS FROM HQ** ✓\n\n**Benefit**:\n- Single server: Centralized management\n- Lower cost: One DHCP license\n- Consistency: All sites use same settings\n\n## PART 5: DHCP TROUBLESHOOTING\n\n### Common DHCP Issues\n\n**Issue**: Client cannot get IP address\n- Cause 1: **DHCP SCOPE EXHAUSTED** ⚠️\n- Cause 2: **DHCP SERVER DOWN** ⚠️\n- Cause 3: **RELAY NOT CONFIGURED** ⚠️\n- Cause 4: **NETWORK CONNECTIVITY ISSUE** ⚠️\n\n**Troubleshooting**:\n- Check 1: Is DHCP server running?\n- Check 2: Are there available IPs in scope?\n- Check 3: Can client reach DHCP server?\n- Check 4: Is DHCP relay configured on routers?\n\n### DHCP Scope Exhaustion\n\n**Problem**: All IPs assigned, new clients get error\n\n**Scenario**:\n- Scope: 192.168.1.100 - 192.168.1.200 (101 addresses)\n- Leased: 101/101 (100%)\n- New client: Cannot get IP\n- Error: \"No addresses available\"\n\n**Solutions**:\n- Reduce lease time: **SMALLER SCOPE TIMEOUT** ✓\n- Add more scope: **EXTEND RANGE** ✓\n- Remove reservations: **FREE UP IPS** ✓\n- Increase servers: **SECONDARY SERVER** ✓\n\n### DHCP Client Issues\n\n**Issue**: Device has APIPA address (169.254.x.x)\n- Meaning: **NO DHCP SERVER REACHABLE** ⚠️\n- Cause: Network connectivity, DHCP down\n- Solution: Renew lease (ipconfig /renew)\n\n**Issue**: Device using wrong subnet\n- Symptom: **ADDRESS FROM DIFFERENT SCOPE** ⚠️\n- Cause: Relay misconfiguration\n- Solution: Check relay settings\n\n### Monitoring DHCP\n\n**Metrics**:\n- Scope utilization: **% IPS IN USE** ✓\n- Lease count: How many active leases?\n- Fail rate: Failed lease requests?\n- Renewal rate: How often renewed?\n\n**Alerts**:\n- Utilization >80%: **SCOPE NEARLY FULL** ⚠️\n- Server down: **NO DHCP AVAILABLE** ⚠️\n- Unusual activity: DoS or attack?\n\n## PART 6: DHCP BEST PRACTICES\n\n### DHCP Server Placement\n\n**Single-site deployment**:\n- One server: Sufficient for < 100 devices\n- Primary/secondary: Recommended (redundancy) ✓\n- Colocation: **SAME ROOM AS EQUIPMENT** ✓\n\n**Multi-site deployment**:\n- Option 1: Central server + relay agents\n- Option 2: **DISTRIBUTED SERVERS PER SITE** ✓\n- Recommended: Central (easier management)\n\n### Scope Sizing\n\n**Question**: \"How big should DHCP scope be?\"\n\n**Formula**:\n- Current devices: 100\n- Growth rate: 20% per year\n- Planning period: 3 years\n- Future: 100 × 1.2^3 = **173 DEVICES** ✓\n- Scope size: **200 ADDRESSES, 15% BUFFER** ✓\n\n### Security Best Practices\n\n**DHCP snooping**:\n- Purpose: **PREVENT ROGUE DHCP SERVERS** ✓\n- Configuration: Whitelist trusted ports\n- Untrusted ports: Reject DHCP responses\n- Benefit: **PREVENT IP HIJACKING** ✓\n\n**IP source guard**:\n- Purpose: **ENSURE IP MATCHES RESERVED MAC** ✓\n- Configuration: Combine with DHCP snooping\n- Effect: Block IP spoofing attacks\n\n### DHCP Documentation\n\n**Must document**:\n- Scope ranges: **ALL SUBNETS, RANGES** ✓\n- Reservations: **MAC/IP PAIRS** ✓\n- Relay configuration: **WHICH ROUTERS** ✓\n- Options: **DNS, GATEWAY, NTP** ✓\n- Failover: **PRIMARY/SECONDARY SETUP** ✓\n- Contacts: **ADMINISTRATOR NAMES, PHONES** ✓",
  "hints": [
    "DHCP = Dynamic Host Configuration Protocol; automates IP assignment via DORA (Discover, Offer, Request, Acknowledge)",
    "DHCP process: Client broadcasts → Server offers → Client requests → Server acknowledges",
    "Lease renewal at 50% (T1) and 87.5% (T2); if primary unavailable, try secondary (rebinding)",
    "Scope = range of IPs available; excludes network, broadcast, gateway, and reserved addresses",
    "DHCP options: Option 3 (gateway), Option 6 (DNS), Option 15 (domain), Option 42 (NTP)",
    "Reservations = permanent IP allocation by MAC address (for servers, printers, APs)",
    "DHCP relay agent converts broadcast to unicast to reach DHCP server on remote subnet",
    "Scope exhaustion (no IPs available): Reduce lease, extend scope, remove reservations, add secondary server",
    "APIPA address (169.254.x.x) = no DHCP server reachable; troubleshoot connectivity or server",
    "DHCP snooping prevents rogue servers; IP source guard prevents IP spoofing attacks"
  ],
  "testCases": [
    {"id": "tc1-dhcp", "description": "DHCP definition", "input": "Dynamic configuration", "expected": "Automatic IP assignment", "assert": "assert ('dhcp' in solution.lower() or 'dynamic' in solution.lower() or 'ip' in solution.lower())"},
    {"id": "tc2-dora", "description": "DHCP process", "input": "DORA steps", "expected": "Discover, Offer, Request, Acknowledge", "assert": "assert ('discover' in solution.lower() or 'offer' in solution.lower() or 'request' in solution.lower() or 'acknowledge' in solution.lower())"},
    {"id": "tc3-lease", "description": "Lease management", "input": "Renewal, expiration", "expected": "T1 at 50%, T2 at 87.5%", "assert": "assert ('lease' in solution.lower() or 'renewal' in solution.lower() or 'expire' in solution.lower())"},
    {"id": "tc4-scope", "description": "DHCP scope", "input": "Range, exclusion", "expected": "Available addresses, reserved", "assert": "assert ('scope' in solution.lower() or 'range' in solution.lower() or 'address' in solution.lower())"},
    {"id": "tc5-reservation", "description": "DHCP reservation", "input": "MAC address", "expected": "Permanent IP allocation", "assert": "assert ('reserv' in solution.lower() or 'mac' in solution.lower() or 'permanent' in solution.lower())"},
    {"id": "tc6-relay", "description": "DHCP relay", "input": "Remote subnets", "expected": "Broadcast to unicast conversion", "assert": "assert ('relay' in solution.lower() or 'broadcast' in solution.lower() or 'unicast' in solution.lower())"},
    {"id": "tc7-options", "description": "DHCP options", "input": "Gateway, DNS, NTP", "expected": "Option 3, 6, 42", "assert": "assert ('option' in solution.lower() or 'gateway' in solution.lower() or 'dns' in solution.lower())"},
    {"id": "tc8-troubleshoot", "description": "Troubleshooting", "input": "No IP address", "expected": "Scope exhausted, server down, relay", "assert": "assert ('troubleshoot' in solution.lower() or 'scope' in solution.lower() or 'server' in solution.lower())"},
    {"id": "tc9-security", "description": "DHCP security", "input": "Snooping, spoofing", "expected": "Rogue server prevention", "assert": "assert ('secur' in solution.lower() or 'snoop' in solution.lower() or 'rogue' in solution.lower())"},
    {"id": "tc10-failover", "description": "Redundancy", "input": "Primary/secondary", "expected": "80/20 split", "assert": "assert ('failover' in solution.lower() or 'primary' in solution.lower() or 'secondary' in solution.lower())"}
  ]
}
